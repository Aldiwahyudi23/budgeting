import{i as D,d as c,j as I,C as H,k as Q,c as P,o as l,w as m,a as t,e as n,f as u,b as d,t as i,g as p,l as _,F as f,h as g,u as o,v as S,m as q,p as K,W as X}from"./app-Ba0vgL21.js";import{A as Z}from"./AppLayout-BImQPAyd.js";import{_ as B}from"./PrimaryButton-BJxzWIO0.js";import{_ as N}from"./SecondaryButton-CWi4dPa1.js";import{_ as b}from"./InputLabel-DIrWlzhE.js";import{_ as F}from"./TextInput-1mJjLicG.js";import{_ as y}from"./InputError-Dc92iKig.js";import{_ as ee}from"./CustomModal-Cavc9KVP.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"p-4"},ae={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},oe={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},le={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ne={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},re={class:"flex items-center space-x-4 w-full md:w-auto"},de={class:"flex-1 md:flex-none"},ie=["value"],ue={class:"flex-1 md:flex-none"},pe=["value"],ce={class:"relative w-full md:w-64"},me={class:"mt-4 overflow-x-auto"},_e={class:"min-w-full border bg-white rounded-lg shadow-md"},fe={class:"px-4 py-2"},ge={class:"px-4 py-2"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ke={class:"px-4 py-2"},xe={class:"px-4 py-2"},he={class:"px-4 py-2 text-center"},we={class:"mb-4"},Se={class:"mb-4"},Ve={class:"mb-4"},Ce=["value","disabled"],$e={key:0},Ae={class:"mb-4"},Te=["disabled"],Me=["value","disabled"],Ue={key:0},De={class:"mb-4"},Pe={class:"flex space-x-4 mt-2"},Be={class:"flex items-center"},Fe={class:"flex items-center"},Le={key:0,class:"mb-4"},Ee={disabled:"",value:""},Ie={key:0},Ke={label:"Rekening"},Ne=["value","disabled"],Re={key:0},Je={key:0,label:"Sub Kategori (Saving)"},je=["value","disabled"],Ye={key:0},Oe={class:"flex justify-end mt-4"},We={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array},setup(A){const V=A;D();const k=c(""),T=c(!1),x=c(!1),h=c(D().props.settings),L=c(D().props.savingSubCategories),R=Array.from({length:6},(r,e)=>2025+e),J=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],M=c(new Date().getFullYear()),U=c(new Date().getMonth()+1),j=I(()=>V.expenses.filter(r=>{var w;const e=new Date(r.date),s=e.getFullYear()===M.value,v=e.getMonth()+1===U.value,$=r.category.name.toLowerCase().includes(k.value.toLowerCase())||((w=r.sub_category)==null?void 0:w.name.toLowerCase().includes(k.value.toLowerCase()))||r.payment.toLowerCase().includes(k.value.toLowerCase());return s&&v&&$})),Y=I(()=>V.subCategories.filter(r=>r.category_id===a.category_id)),O=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r),a=H({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),E=(r,e=null)=>{x.value=r==="edit",x.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),T.value=!0},C=()=>{a.reset(),T.value=!1},W=()=>{x.value?a.put(route("expense.update",a.id),{onSuccess:()=>C()}):a.post(route("expense.store"),{onSuccess:()=>C()})},z=r=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&X.delete(route("expense.destroy",r),{onSuccess:()=>{const e=V.expenses.findIndex(s=>s.id===r);e!==-1&&V.expenses.splice(e,1)},onError:e=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return Q(()=>{h.value.saving_expense&&console.log(L.value)}),(r,e)=>(l(),P(Z,{title:"Expenses"},{default:m(()=>[t("div",te,[r.$page.props.flash.success?(l(),n("div",ae,i(r.$page.props.flash.success),1)):u("",!0),r.$page.props.flash.error?(l(),n("div",oe,i(r.$page.props.flash.error),1)):u("",!0),t("div",le,[d(B,{onClick:e[0]||(e[0]=s=>E("create"))},{default:m(()=>e[14]||(e[14]=[p("Tambah Pengeluaran")])),_:1}),t("div",ne,[t("div",re,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",de,[_(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>M.value=s),class:"block w-full border rounded-md p-2"},[(l(!0),n(f,null,g(o(R),s=>(l(),n("option",{key:s,value:s},i(s),9,ie))),128))],512),[[S,M.value]])]),t("div",ue,[_(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"block w-full border rounded-md p-2"},[(l(),n(f,null,g(J,(s,v)=>t("option",{key:v,value:v+1},i(s),9,pe)),64))],512),[[S,U.value]])])]),t("div",ce,[d(F,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),placeholder:"Cari Pemasukan...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",me,[t("table",_e,[e[19]||(e[19]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"No"),t("th",{class:"px-4 py-2 text-left"},"Tanggal"),t("th",{class:"px-4 py-2 text-left"},"Jumlah"),t("th",{class:"px-4 py-2 text-left"},"Kategori"),t("th",{class:"px-4 py-2 text-left"},"Sub Kategori"),t("th",{class:"px-4 py-2 text-left"},"Pembayaran"),t("th",{class:"px-4 py-2 text-left"},"Rekening"),t("th",{class:"px-4 py-2 text-center"},"Aksi")])],-1)),t("tbody",null,[(l(!0),n(f,null,g(j.value,(s,v)=>{var $,w;return l(),n("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",fe,i(v+1),1),t("td",ge,i(s.date),1),t("td",ve,i(O(s.amount)),1),t("td",be,i(s.category.name),1),t("td",ye,i((($=s.sub_category)==null?void 0:$.name)||"-"),1),t("td",ke,i(s.payment),1),t("td",xe,i(((w=s.account_bank)==null?void 0:w.name)||"-"),1),t("td",he,[h.value.btn_edit?(l(),P(N,{key:0,onClick:G=>E("edit",s)},{default:m(()=>e[17]||(e[17]=[p("Edit")])),_:2},1032,["onClick"])):u("",!0),h.value.btn_delete?(l(),P(B,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:G=>z(s.id)},{default:m(()=>e[18]||(e[18]=[p("Hapus")])),_:2},1032,["onClick"])):u("",!0)])])}),128))])])]),d(ee,{show:T.value,title:x.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:C},{content:m(()=>[t("form",{onSubmit:q(W,["prevent"])},[t("div",we,[d(b,{for:"date",value:"Tanggal"}),d(F,{id:"date",type:"date",modelValue:o(a).date,"onUpdate:modelValue":e[4]||(e[4]=s=>o(a).date=s),class:"block w-full"},null,8,["modelValue"]),d(y,{message:o(a).errors.date},null,8,["message"])]),t("div",Se,[d(b,{for:"amount",value:"Jumlah"}),d(F,{id:"amount",type:"number",modelValue:o(a).amount,"onUpdate:modelValue":e[5]||(e[5]=s=>o(a).amount=s),class:"block w-full"},null,8,["modelValue"]),d(y,{message:o(a).errors.amount},null,8,["message"])]),t("div",Ve,[d(b,{for:"category_id",value:"Kategori"}),_(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>o(a).category_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>o(a).sub_kategori_id=null)},[e[20]||(e[20]=t("option",{disabled:"",value:""},"Pilih Kategori",-1)),(l(!0),n(f,null,g(A.categories,s=>(l(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",$e,"(Tidak Aktif)"))],8,Ce))),128))],544),[[S,o(a).category_id]]),d(y,{message:o(a).errors.category_id},null,8,["message"])]),t("div",Ae,[d(b,{for:"sub_kategori_id",value:"Sub Kategori"}),_(t("select",{id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=s=>o(a).sub_kategori_id=s),class:"block w-full border rounded-md p-2",disabled:!o(a).category_id},[e[21]||(e[21]=t("option",{disabled:"",value:""},"Pilih Sub Kategori",-1)),(l(!0),n(f,null,g(Y.value,s=>(l(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Ue,"(Tidak Aktif)"))],8,Me))),128))],8,Te),[[S,o(a).sub_kategori_id]]),d(y,{message:o(a).errors.sub_kategori_id},null,8,["message"])]),t("div",De,[d(b,{for:"payment",value:"Pembayaran"}),t("div",Pe,[t("label",Be,[_(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>o(a).payment=s),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=s=>o(a).account_id="")},null,544),[[K,o(a).payment]]),e[22]||(e[22]=t("span",null,"Transfer",-1))]),t("label",Fe,[_(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>o(a).payment=s),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=s=>o(a).account_id=null)},null,544),[[K,o(a).payment]]),e[23]||(e[23]=t("span",null,"Tunai",-1))])]),d(y,{message:o(a).errors.payment},null,8,["message"])]),o(a).payment==="Transfer"?(l(),n("div",Le,[d(b,{for:"account_id",value:"Sumber Rekening "}),_(t("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=s=>o(a).account_id=s),class:"block w-full border rounded-md p-2"},[t("option",Ee,[e[24]||(e[24]=p(" Pilih Rekening ")),h.value.saving_expense?(l(),n("span",Ie," / Dari Saving (Tabungan)")):u("",!0)]),t("optgroup",Ke,[(l(!0),n(f,null,g(A.accountBanks,s=>(l(),n("option",{key:s.id,value:`account_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Re,"(Tidak Aktif)"))],8,Ne))),128))]),h.value.saving_expense?(l(),n("optgroup",Je,[(l(!0),n(f,null,g(L.value,s=>(l(),n("option",{key:s.id,value:`subcategory_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Ye,"(Tidak Aktif)"))],8,je))),128))])):u("",!0)],512),[[S,o(a).account_id]]),d(y,{message:o(a).errors.account_id},null,8,["message"])])):u("",!0),t("div",Oe,[d(N,{type:"button",onClick:C},{default:m(()=>e[25]||(e[25]=[p("Batal")])),_:1}),d(B,{class:"ml-3",type:"submit"},{default:m(()=>[p(i(x.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},ts=se(We,[["__scopeId","data-v-89b58617"]]);export{ts as default};

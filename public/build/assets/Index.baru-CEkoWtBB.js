import{i as L,d as c,j as W,k as b,C as ue,l as pe,m as me,c as j,o as n,w as p,a as t,e as l,f as m,b as i,t as d,g as u,p as _,F as y,h as x,v as h,q as ce,u as r,s as z,W as G}from"./app-Dc4t1LEb.js";import{A as ge}from"./AppLayout-BpJ8EMNG.js";import{_ as K}from"./PrimaryButton-CKo7Q5ny.js";import{_ as Q}from"./SecondaryButton-HQ6C-wiq.js";import{_ as C}from"./InputLabel-hu-_glHo.js";import{_ as R}from"./TextInput-CUKLywm6.js";import{_ as S}from"./InputError-Dmp8YO-4.js";import{_ as ve}from"./CustomModal-vYZV8SHM.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const be={class:"p-4"},_e={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},ye={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},xe={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ke={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},we={class:"flex items-center space-x-4 w-full md:w-auto"},he={class:"flex-1 md:flex-none"},Ce=["value"],Se={class:"flex-1 md:flex-none"},Ae=["value"],Ve={class:"relative w-full md:w-64"},Te={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},$e={class:"min-w-full"},Me={class:"bg-gray-200"},De={key:0,class:"px-4 py-2 text-center"},Pe={class:"px-4 py-2"},Be={class:"px-4 py-2"},Ue={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Fe={class:"px-4 py-2"},Ne={class:"px-4 py-2"},Le={key:0,class:"px-4 py-2 text-center"},je={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},Ke={class:"flex items-center space-x-4"},Re={class:"text-sm text-gray-700"},Ye={class:"flex items-center space-x-4"},He=["disabled"],Je={class:"text-sm text-gray-700"},qe=["disabled"],Oe={class:"mb-4"},We={class:"mb-4"},ze=["value","disabled"],Ge={key:0},Qe={class:"mb-4"},Xe=["disabled"],Ze=["value","disabled"],et={key:0},tt={class:"mb-4"},st={class:"mb-4"},at={class:"flex space-x-4 mt-2"},ot={class:"flex items-center"},nt={key:0,class:"flex items-center"},lt={key:0,class:"mb-4"},rt={label:"Rekening"},dt=["value","disabled"],it={key:0},ut={key:0,label:"Saving (Tabungan)"},pt=["value","disabled"],mt={key:0},ct={class:"flex justify-end mt-4"},gt={__name:"Index.baru",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array,bills:Array,debts:Array},setup(B){const g=B;L();const k=c(""),U=c(!1),A=c(!1),v=c(L().props.settings),Y=c(L().props.savingSubCategories),X=c(Array.from({length:10},(a,e)=>new Date().getFullYear()-e)),Z=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],V=c(new Date().getFullYear()),T=c(new Date().getMonth()+1),f=c(1),$=c(10),ee=()=>{const a={year:V.value,month:T.value};G.get(route("expense.index"),a,{preserveState:!0,replace:!0})};W([V,T],()=>{ee()});const I=b(()=>g.expenses.filter(a=>{var M;const e=new Date(a.date),s=e.getFullYear()===V.value,w=e.getMonth()+1===T.value,P=k.value?a.category.name.toLowerCase().includes(k.value.toLowerCase())||((M=a.sub_category)==null?void 0:M.name.toLowerCase().includes(k.value.toLowerCase()))||a.payment.toLowerCase().includes(k.value.toLowerCase()):!0;return s&&w&&P})),H=b(()=>{const a=(f.value-1)*$.value,e=a+$.value;return I.value.slice(a,e)}),E=b(()=>Math.ceil(I.value.length/$.value)),te=()=>{f.value<E.value&&f.value++},se=()=>{f.value>1&&f.value--},o=ue({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),ae=b(()=>g.subCategories.filter(a=>a.category_id===o.category_id)),F=a=>a?new Intl.NumberFormat("id-ID").format(a):"",oe=a=>a?a.replace(/\./g,""):"",N=b({get:()=>F(o.amount),set:a=>{o.amount=oe(a)}});pe(()=>{N.value=F(o.amount)});const J=b(()=>{const a=g.categories.find(e=>e.id===o.category_id);return a&&a.name==="Saving (Tabungan)"}),ne=b(()=>{const a=g.categories.find(e=>e.id===o.category_id);return a&&a.name==="Bills (Tagihan)"}),le=b(()=>{const a=g.categories.find(e=>e.id===o.category_id);return a&&a.name==="Debt (Hutang)"}),q=()=>{if(ne.value&&o.sub_kategori_id){const a=g.bills.find(e=>e.sub_category_id===o.sub_kategori_id);console.log("Selected Bill:",a),o.amount=a?a.amount:""}if(le.value&&o.sub_kategori_id){const a=g.debts.find(e=>e.sub_category_id===o.sub_kategori_id);console.log("Selected Debt:",a),o.amount=a?a.amount:""}};W(()=>o.sub_kategori_id,a=>{a&&q()});const O=(a,e=null)=>{A.value=a==="edit",A.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.category_id=e.category_id,o.sub_kategori_id=e.sub_kategori_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),U.value=!0},D=()=>{o.reset(),U.value=!1},re=()=>{A.value?o.put(route("expense.update",o.id),{onSuccess:()=>D()}):o.post(route("expense.store"),{onSuccess:()=>D()})},de=a=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&G.delete(route("expense.destroy",a),{onSuccess:()=>{const e=g.expenses.findIndex(s=>s.id===a);e!==-1&&g.expenses.splice(e,1)},onError:()=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return me(()=>{v.value.saving_expense&&console.log(Y.value)}),(a,e)=>(n(),j(ge,{title:"Expenses"},{default:p(()=>[t("div",be,[a.$page.props.flash.success?(n(),l("div",_e,d(a.$page.props.flash.success),1)):m("",!0),a.$page.props.flash.error?(n(),l("div",ye,d(a.$page.props.flash.error),1)):m("",!0),e[40]||(e[40]=t("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[t("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pengeluaran, termasuk kategori pengeluaran seperti tagihan, hutang, dan tabungan. ")],-1)),t("div",xe,[i(K,{onClick:e[0]||(e[0]=s=>O("create"))},{default:p(()=>e[15]||(e[15]=[u("Tambah Pengeluaran")])),_:1}),t("div",ke,[t("div",we,[e[16]||(e[16]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",he,[_(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s),class:"block w-full border rounded-md p-2"},[(n(!0),l(y,null,x(X.value,s=>(n(),l("option",{key:s,value:s},d(s),9,Ce))),128))],512),[[h,V.value]])]),t("div",Se,[_(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>T.value=s),class:"block w-full border rounded-md p-2"},[(n(),l(y,null,x(Z,(s,w)=>t("option",{key:w,value:w+1},d(s),9,Ae)),64))],512),[[h,T.value]])])]),t("div",Ve,[i(R,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[17]||(e[17]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",Te,[t("table",$e,[t("thead",Me,[t("tr",null,[e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[24]||(e[24]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),v.value.btn_edit||v.value.btn_delete?(n(),l("th",De,"Aksi")):m("",!0)])]),t("tbody",null,[(n(!0),l(y,null,x(H.value,(s,w)=>{var P,M;return n(),l("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",Pe,d(w+1),1),t("td",Be,d(s.date),1),t("td",Ue,d(F(s.amount)),1),t("td",Ie,d(s.category.name),1),t("td",Ee,d(((P=s.sub_category)==null?void 0:P.name)||"-"),1),t("td",Fe,d(s.payment),1),t("td",Ne,d(((M=s.account_bank)==null?void 0:M.name)||"-"),1),v.value.btn_edit||v.value.btn_delete?(n(),l("td",Le,[v.value.btn_edit?(n(),j(Q,{key:0,onClick:ie=>O("edit",s)},{default:p(()=>e[25]||(e[25]=[u("Edit")])),_:2},1032,["onClick"])):m("",!0),v.value.btn_delete?(n(),j(K,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:ie=>de(s.id)},{default:p(()=>e[26]||(e[26]=[u("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),t("div",je,[t("div",Ke,[t("span",Re,"Menampilkan "+d(H.value.length)+" dari "+d(I.value.length)+" data",1),_(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>$.value=s),class:"border rounded-md p-2 text-sm"},e[27]||(e[27]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),512),[[h,$.value]])]),t("div",Ye,[t("button",{onClick:se,disabled:f.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,He),t("span",Je,"Halaman "+d(f.value)+" dari "+d(E.value),1),t("button",{onClick:te,disabled:f.value===E.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,qe)])]),i(ve,{show:U.value,title:A.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:D},{content:p(()=>[t("form",{onSubmit:ce(re,["prevent"])},[t("div",Oe,[i(C,{for:"date"},{default:p(()=>e[28]||(e[28]=[u(" Tanggal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(R,{id:"date",type:"date",modelValue:r(o).date,"onUpdate:modelValue":e[5]||(e[5]=s=>r(o).date=s),class:"block w-full"},null,8,["modelValue"]),i(S,{message:r(o).errors.date},null,8,["message"])]),t("div",We,[i(C,{for:"category_id"},{default:p(()=>e[29]||(e[29]=[u(" Kategori "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),_(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>r(o).category_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=(...s)=>a.onCategoryChange&&a.onCategoryChange(...s))},[e[30]||(e[30]=t("option",{disabled:"",value:""},"Pilih Kategori",-1)),(n(!0),l(y,null,x(B.categories,s=>(n(),l("option",{key:s.id,value:s.id,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",Ge,"(Tidak Aktif)"))],8,ze))),128))],544),[[h,r(o).category_id]]),i(S,{message:r(o).errors.category_id},null,8,["message"])]),t("div",Qe,[i(C,{for:"sub_kategori_id"},{default:p(()=>e[31]||(e[31]=[u(" Keterangan "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),_(t("select",{id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=s=>r(o).sub_kategori_id=s),class:"block w-full border rounded-md p-2",disabled:!r(o).category_id,onChange:q},[e[32]||(e[32]=t("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),l(y,null,x(ae.value,s=>(n(),l("option",{key:s.id,value:s.id,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",et,"(Tidak Aktif)"))],8,Ze))),128))],40,Xe),[[h,r(o).sub_kategori_id]]),i(S,{message:r(o).errors.sub_kategori_id},null,8,["message"])]),t("div",tt,[i(C,{for:"amount"},{default:p(()=>e[33]||(e[33]=[u(" Nominal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(R,{id:"amount",type:"text",modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=s=>N.value=s),onInput:a.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),i(S,{message:r(o).errors.amount},null,8,["message"])]),t("div",st,[i(C,{for:"payment"},{default:p(()=>e[34]||(e[34]=[u(" Pembayaran "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),t("div",at,[t("label",ot,[_(t("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=s=>r(o).payment=s),value:"Transfer",class:"mr-2",onChange:e[11]||(e[11]=s=>r(o).account_id="")},null,544),[[z,r(o).payment]]),e[35]||(e[35]=t("span",null,"Transfer",-1))]),J.value?m("",!0):(n(),l("label",nt,[_(t("input",{type:"radio","onUpdate:modelValue":e[12]||(e[12]=s=>r(o).payment=s),value:"Tunai",class:"mr-2",onChange:e[13]||(e[13]=s=>r(o).account_id=null)},null,544),[[z,r(o).payment]]),e[36]||(e[36]=t("span",null,"Tunai",-1))]))]),i(S,{message:r(o).errors.payment},null,8,["message"])]),r(o).payment==="Transfer"?(n(),l("div",lt,[i(C,{for:"account_id"},{default:p(()=>e[37]||(e[37]=[u(" Sumber Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),_(t("select",{id:"account_id","onUpdate:modelValue":e[14]||(e[14]=s=>r(o).account_id=s),class:"block w-full border rounded-md p-2",required:""},[e[38]||(e[38]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),t("optgroup",rt,[(n(!0),l(y,null,x(B.accountBanks,s=>(n(),l("option",{key:s.id,value:`account_${s.id}`,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",it,"(Tidak Aktif)"))],8,dt))),128))]),!J.value&&v.value.saving_expense?(n(),l("optgroup",ut,[(n(!0),l(y,null,x(Y.value,s=>(n(),l("option",{key:s.id,value:`subcategory_${s.id}`,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",mt,"(Tidak Aktif)"))],8,pt))),128))])):m("",!0)],512),[[h,r(o).account_id]]),i(S,{message:r(o).errors.account_id},null,8,["message"])])):m("",!0),t("div",ct,[i(Q,{type:"button",onClick:D},{default:p(()=>e[39]||(e[39]=[u("Batal")])),_:1}),i(K,{class:"ml-3",type:"submit"},{default:p(()=>[u(d(A.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},Ct=fe(gt,[["__scopeId","data-v-e9e4fc72"]]);export{Ct as default};

import{i as R,d as g,j as z,k as f,C as me,l as ce,m as ge,c as B,o as l,w as p,a as s,e as d,f as m,b as r,t as i,g as u,p as b,F as y,h as x,v as V,q as ve,u as n,s as G,W as Q}from"./app-BAijexpd.js";import{A as fe}from"./AppLayout-DlFxLZi-.js";import{_ as Y}from"./PrimaryButton-DOrKTp0i.js";import{_ as X}from"./SecondaryButton-DkTZSIKd.js";import{_ as k}from"./InputLabel-Bgs03EzX.js";import{_ as M}from"./TextInput-CaApGyw9.js";import{_ as w}from"./InputError-m3pCSlzm.js";import{_ as _e}from"./CustomModal-BjGm5vFm.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"p-4"},xe={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},ke={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},we={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},he={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},Ce={class:"flex items-center space-x-4 w-full md:w-auto"},Ve={class:"flex-1 md:flex-none"},Se=["value"],Ae={class:"flex-1 md:flex-none"},Pe=["value"],Te={class:"relative w-full md:w-64"},$e={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Me={class:"min-w-full"},De={class:"bg-gray-200"},Ue={key:0,class:"px-4 py-2 text-center"},Be={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Le={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Fe={class:"px-4 py-2"},Ne={class:"px-4 py-2"},je={class:"px-4 py-2"},Ke={class:"px-4 py-2"},Re={key:0,class:"px-4 py-2 text-center"},Ye={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},qe={class:"flex items-center space-x-4"},He={class:"text-sm text-gray-700"},Je={class:"flex items-center space-x-4"},Oe=["disabled"],We={class:"text-sm text-gray-700"},ze=["disabled"],Ge={key:0,class:"mb-4"},Qe={class:"mb-4"},Xe=["value","disabled"],Ze={key:0},et={class:"mb-4"},tt=["disabled"],st=["value","disabled"],at={key:0},ot={class:"mb-4"},lt={class:"mb-4"},nt={class:"mb-4"},dt={class:"flex space-x-4 mt-2"},rt={class:"flex items-center"},it={key:0,class:"flex items-center"},ut={key:1,class:"mb-4"},pt={label:"Rekening"},mt=["value","disabled"],ct={key:0},gt={key:0,label:"Saving (Tabungan)"},vt=["value","disabled"],ft={key:0},_t={class:"flex justify-end mt-4"},bt={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array,bills:Array,debts:Array},setup(I){const c=I;R();const h=g(""),L=g(!1),S=g(!1),v=g(R().props.settings),q=g(R().props.savingSubCategories),Z=g(Array.from({length:10},(o,e)=>new Date().getFullYear()-e)),ee=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],A=g(new Date().getFullYear()),P=g(new Date().getMonth()+1),_=g(1),T=g(10),te=()=>{const o={year:A.value,month:P.value};Q.get(route("expense.index"),o,{preserveState:!0,replace:!0})};z([A,P],()=>{te()});const E=f(()=>c.expenses.filter(o=>{var $;const e=new Date(o.date),t=e.getFullYear()===A.value,C=e.getMonth()+1===P.value,U=h.value?o.category.name.toLowerCase().includes(h.value.toLowerCase())||(($=o.sub_category)==null?void 0:$.name.toLowerCase().includes(h.value.toLowerCase()))||o.payment.toLowerCase().includes(h.value.toLowerCase()):!0;return t&&C&&U})),H=f(()=>{const o=(_.value-1)*T.value,e=o+T.value;return E.value.slice(o,e)}),F=f(()=>Math.ceil(E.value.length/T.value)),se=()=>{_.value<F.value&&_.value++},ae=()=>{_.value>1&&_.value--},a=me({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,description:null,payment:"",account_id:null}),oe=f(()=>c.subCategories.filter(o=>o.category_id===a.category_id)),N=o=>o?new Intl.NumberFormat("id-ID").format(o):"",le=o=>o?o.replace(/\./g,""):"",j=f({get:()=>N(a.amount),set:o=>{a.amount=le(o)}});ce(()=>{j.value=N(a.amount)});const J=f(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Saving (Tabungan)"}),ne=f(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Bills (Tagihan)"}),de=f(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Debt (Hutang)"}),K=f(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Loan (Pinjaman)"}),O=()=>{if(ne.value&&a.sub_kategori_id){const o=c.bills.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Bill:",o),a.amount=o?o.amount:""}if(de.value&&a.sub_kategori_id){const o=c.debts.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Debt:",o),a.amount=o?o.amount:""}},re=()=>{K.value&&(a.sub_kategori_id=null)};z(()=>a.sub_kategori_id,o=>{o&&O()});const W=(o,e=null)=>{S.value=o==="edit",S.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.description=e.description,a.payment=e.payment,a.account_id=e.account_id):a.reset(),L.value=!0},D=()=>{a.reset(),L.value=!1},ie=()=>{K.value&&(a.sub_kategori_id=a.sub_kategori_name),S.value?a.put(route("expense.update",a.id),{onSuccess:()=>D()}):a.post(route("expense.store"),{onSuccess:()=>D()})},ue=o=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&Q.delete(route("expense.destroy",o),{onSuccess:()=>{const e=c.expenses.findIndex(t=>t.id===o);e!==-1&&c.expenses.splice(e,1)},onError:()=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return ge(()=>{v.value.saving_expense&&console.log(q.value)}),(o,e)=>(l(),B(fe,{title:"Expenses"},{default:p(()=>[s("div",ye,[o.$page.props.flash.success?(l(),d("div",xe,i(o.$page.props.flash.success),1)):m("",!0),o.$page.props.flash.error?(l(),d("div",ke,i(o.$page.props.flash.error),1)):m("",!0),e[43]||(e[43]=s("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[s("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pengeluaran, termasuk kategori pengeluaran seperti tagihan, hutang, dan tabungan. ")],-1)),s("div",we,[r(Y,{onClick:e[0]||(e[0]=t=>W("create"))},{default:p(()=>e[16]||(e[16]=[u("Tambah Pengeluaran")])),_:1}),s("div",he,[s("div",Ce,[e[17]||(e[17]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",Ve,[b(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>A.value=t),class:"block w-full border rounded-md p-2"},[(l(!0),d(y,null,x(Z.value,t=>(l(),d("option",{key:t,value:t},i(t),9,Se))),128))],512),[[V,A.value]])]),s("div",Ae,[b(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>P.value=t),class:"block w-full border rounded-md p-2"},[(l(),d(y,null,x(ee,(t,C)=>s("option",{key:C,value:C+1},i(t),9,Pe)),64))],512),[[V,P.value]])])]),s("div",Te,[r(M,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=t=>h.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[18]||(e[18]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",$e,[s("table",Me,[s("thead",De,[s("tr",null,[e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Poin",-1)),e[24]||(e[24]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[25]||(e[25]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[26]||(e[26]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),v.value.btn_edit||v.value.btn_delete?(l(),d("th",Ue,"Aksi")):m("",!0)])]),s("tbody",null,[(l(!0),d(y,null,x(H.value,(t,C)=>{var U,$;return l(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Be,i(C+1),1),s("td",Ie,i(t.date),1),s("td",Le,i(N(t.amount)),1),s("td",Ee,i(t.category.name),1),s("td",Fe,i(((U=t.sub_category)==null?void 0:U.name)||"-"),1),s("td",Ne,i(t.description||"-"),1),s("td",je,i(t.payment),1),s("td",Ke,i((($=t.account_bank)==null?void 0:$.name)||"-"),1),v.value.btn_edit||v.value.btn_delete?(l(),d("td",Re,[v.value.btn_edit?(l(),B(X,{key:0,onClick:pe=>W("edit",t)},{default:p(()=>e[27]||(e[27]=[u("Edit")])),_:2},1032,["onClick"])):m("",!0),v.value.btn_delete?(l(),B(Y,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:pe=>ue(t.id)},{default:p(()=>e[28]||(e[28]=[u("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),s("div",Ye,[s("div",qe,[s("span",He,"Menampilkan "+i(H.value.length)+" dari "+i(E.value.length)+" data",1),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>T.value=t),class:"border rounded-md p-2 text-sm"},e[29]||(e[29]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[V,T.value]])]),s("div",Je,[s("button",{onClick:ae,disabled:_.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,Oe),s("span",We,"Halaman "+i(_.value)+" dari "+i(F.value),1),s("button",{onClick:se,disabled:_.value===F.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,ze)])]),r(_e,{show:L.value,title:S.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:D},{content:p(()=>[s("form",{onSubmit:ve(ie,["prevent"])},[v.value.date_ex?(l(),d("div",Ge,[r(k,{for:"date"},{default:p(()=>e[30]||(e[30]=[u(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(M,{id:"date",type:"date",modelValue:n(a).date,"onUpdate:modelValue":e[5]||(e[5]=t=>n(a).date=t),class:"block w-full",required:""},null,8,["modelValue"]),r(w,{message:n(a).errors.date},null,8,["message"])])):m("",!0),s("div",Qe,[r(k,{for:"category_id"},{default:p(()=>e[31]||(e[31]=[u(" Kategori "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=t=>n(a).category_id=t),class:"block w-full border rounded-md p-2",onChange:re},[e[32]||(e[32]=s("option",{disabled:"",value:""},"Pilih Kategori",-1)),(l(!0),d(y,null,x(I.categories,t=>(l(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(i(t.name)+" ",1),t.is_active?m("",!0):(l(),d("span",Ze,"(Tidak Aktif)"))],8,Xe))),128))],544),[[V,n(a).category_id]]),r(w,{message:n(a).errors.category_id},null,8,["message"])]),s("div",et,[r(k,{for:"sub_kategori_id"},{default:p(()=>e[33]||(e[33]=[u(" Point "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),K.value?(l(),B(M,{key:0,id:"sub_kategori_id",type:"text",modelValue:n(a).sub_kategori_name,"onUpdate:modelValue":e[7]||(e[7]=t=>n(a).sub_kategori_name=t),class:"block w-full"},null,8,["modelValue"])):b((l(),d("select",{key:1,id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=t=>n(a).sub_kategori_id=t),class:"block w-full border rounded-md p-2",disabled:!n(a).category_id,onChange:O},[e[34]||(e[34]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(l(!0),d(y,null,x(oe.value,t=>(l(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(i(t.name)+" ",1),t.is_active?m("",!0):(l(),d("span",at,"(Tidak Aktif)"))],8,st))),128))],40,tt)),[[V,n(a).sub_kategori_id]]),r(w,{message:n(a).errors.sub_kategori_id},null,8,["message"])]),s("div",ot,[r(k,{for:"description"},{default:p(()=>e[35]||(e[35]=[u(" Keterangan ")])),_:1}),r(M,{id:"description",type:"text",modelValue:n(a).description,"onUpdate:modelValue":e[9]||(e[9]=t=>n(a).description=t),class:"block w-full"},null,8,["modelValue"]),r(w,{message:n(a).errors.description},null,8,["message"])]),s("div",lt,[r(k,{for:"amount"},{default:p(()=>e[36]||(e[36]=[u(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(M,{id:"amount",type:"text",modelValue:j.value,"onUpdate:modelValue":e[10]||(e[10]=t=>j.value=t),onInput:o.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),r(w,{message:n(a).errors.amount},null,8,["message"])]),s("div",nt,[r(k,{for:"payment"},{default:p(()=>e[37]||(e[37]=[u(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",dt,[s("label",rt,[b(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>n(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[12]||(e[12]=t=>n(a).account_id="")},null,544),[[G,n(a).payment]]),e[38]||(e[38]=s("span",null,"Transfer",-1))]),J.value?m("",!0):(l(),d("label",it,[b(s("input",{type:"radio","onUpdate:modelValue":e[13]||(e[13]=t=>n(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[14]||(e[14]=t=>n(a).account_id=null)},null,544),[[G,n(a).payment]]),e[39]||(e[39]=s("span",null,"Tunai",-1))]))]),r(w,{message:n(a).errors.payment},null,8,["message"])]),n(a).payment==="Transfer"?(l(),d("div",ut,[r(k,{for:"account_id"},{default:p(()=>e[40]||(e[40]=[u(" Sumber Rekening "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"account_id","onUpdate:modelValue":e[15]||(e[15]=t=>n(a).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[41]||(e[41]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),s("optgroup",pt,[(l(!0),d(y,null,x(I.accountBanks,t=>(l(),d("option",{key:t.id,value:`account_${t.id}`,disabled:!t.is_active},[u(i(t.name)+" ",1),t.is_active?m("",!0):(l(),d("span",ct,"(Tidak Aktif)"))],8,mt))),128))]),!J.value&&v.value.saving_expense?(l(),d("optgroup",gt,[(l(!0),d(y,null,x(q.value,t=>(l(),d("option",{key:t.id,value:`subcategory_${t.id}`,disabled:!t.is_active},[u(i(t.name)+" ",1),t.is_active?m("",!0):(l(),d("span",ft,"(Tidak Aktif)"))],8,vt))),128))])):m("",!0)],512),[[V,n(a).account_id]]),r(w,{message:n(a).errors.account_id},null,8,["message"])])):m("",!0),s("div",_t,[r(X,{type:"button",onClick:D},{default:p(()=>e[42]||(e[42]=[u("Batal")])),_:1}),r(Y,{class:"ml-3",type:"submit"},{default:p(()=>[u(i(S.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},Pt=be(bt,[["__scopeId","data-v-9f40836d"]]);export{Pt as default};

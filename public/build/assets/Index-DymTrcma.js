import{i as F,d as g,j as V,C as te,k as se,l as ae,m as oe,c as I,o as n,w as _,a as s,e as l,f as u,b as d,t as i,g as p,p as f,F as v,h as y,u as r,v as A,q as ne,s as Y,W as le}from"./app-DBiucBkR.js";import{A as re}from"./AppLayout-BI2M7VZQ.js";import{_ as L}from"./PrimaryButton-BDBZEjPd.js";import{_ as O}from"./SecondaryButton-CMQqJvuj.js";import{_ as k}from"./InputLabel-BkdM2JL6.js";import{_ as P}from"./TextInput-BZo7SZEP.js";import{_ as x}from"./InputError-D4HwAbFQ.js";import{_ as de}from"./CustomModal-CTDXuHqr.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"p-4"},pe={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},me={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},ce={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ge={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},_e={class:"flex items-center space-x-4 w-full md:w-auto"},fe={class:"flex-1 md:flex-none"},ve=["value"],ye={class:"flex-1 md:flex-none"},be=["value"],ke={class:"relative w-full md:w-64"},xe={class:"mt-4 overflow-x-auto"},we={class:"min-w-full border bg-white rounded-lg shadow-md"},he={class:"bg-gray-200"},Ce={key:0,class:"px-4 py-2 text-center"},Ve={class:"px-4 py-2"},Ae={class:"px-4 py-2"},Se={class:"px-4 py-2"},Te={class:"px-4 py-2"},$e={class:"px-4 py-2"},Me={class:"px-4 py-2"},Be={class:"px-4 py-2"},Ue={key:0,class:"px-4 py-2 text-center"},De={class:"mb-4"},Ee={class:"mb-4"},Fe=["value","disabled"],Ie={key:0},Le={class:"mb-4"},Pe=["disabled"],Ne=["value","disabled"],Ke={key:0},Je={class:"mb-4"},Re={class:"mb-4"},je={class:"flex space-x-4 mt-2"},Ye={class:"flex items-center"},Oe={key:0,class:"flex items-center"},We={key:0,class:"mb-4"},qe={label:"Rekening"},ze=["value","disabled"],Ge={key:0},He={key:0,label:"Saving (Tabungan)"},Qe=["value","disabled"],Xe={key:0},Ze={class:"flex justify-end mt-4"},et={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array,bills:Array},setup($){const c=$;F();const w=g(""),M=g(!1),h=g(!1),m=g(F().props.settings),N=g(F().props.savingSubCategories),W=Array.from({length:6},(o,e)=>2025+e),q=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],B=g(new Date().getFullYear()),U=g(new Date().getMonth()+1),z=V(()=>c.expenses.filter(o=>{var C;const e=new Date(o.date),t=e.getFullYear()===B.value,b=e.getMonth()+1===U.value,T=o.category.name.toLowerCase().includes(w.value.toLowerCase())||((C=o.sub_category)==null?void 0:C.name.toLowerCase().includes(w.value.toLowerCase()))||o.payment.toLowerCase().includes(w.value.toLowerCase());return t&&b&&T})),a=te({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),G=V(()=>c.subCategories.filter(o=>o.category_id===a.category_id)),D=o=>o?new Intl.NumberFormat("id-ID").format(o):"",H=o=>o?o.replace(/\./g,""):"",E=V({get:()=>D(a.amount),set:o=>{a.amount=H(o)}}),Q=o=>{const e=o.target.value.replace(/\./g,"");a.amount=e};se(()=>{E.value=D(a.amount)});const K=V(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Saving (Tabungan)"}),J=V(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Bills (Tagihan)"}),R=()=>{if(J.value&&a.sub_kategori_id){const o=c.bills.find(e=>e.sub_category_id===a.sub_kategori_id);o?a.amount=o.amount:a.amount=""}};ae(()=>a.sub_kategori_id,o=>{o&&J.value&&R()});const j=(o,e=null)=>{h.value=o==="edit",h.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),M.value=!0},S=()=>{a.reset(),M.value=!1},X=()=>{h.value?a.put(route("expense.update",a.id),{onSuccess:()=>S()}):a.post(route("expense.store"),{onSuccess:()=>S()})},Z=o=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&le.delete(route("expense.destroy",o),{onSuccess:()=>{const e=c.expenses.findIndex(t=>t.id===o);e!==-1&&c.expenses.splice(e,1)},onError:e=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return oe(()=>{m.value.saving_expense&&console.log(N.value)}),(o,e)=>(n(),I(re,{title:"Expenses"},{default:_(()=>[s("div",ue,[o.$page.props.flash.success?(n(),l("div",pe,i(o.$page.props.flash.success),1)):u("",!0),o.$page.props.flash.error?(n(),l("div",me,i(o.$page.props.flash.error),1)):u("",!0),s("div",ce,[d(L,{onClick:e[0]||(e[0]=t=>j("create"))},{default:_(()=>e[14]||(e[14]=[p("Tambah Pengeluaran")])),_:1}),s("div",ge,[s("div",_e,[e[15]||(e[15]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",fe,[f(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>B.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),l(v,null,y(r(W),t=>(n(),l("option",{key:t,value:t},i(t),9,ve))),128))],512),[[A,B.value]])]),s("div",ye,[f(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),class:"block w-full border rounded-md p-2"},[(n(),l(v,null,y(q,(t,b)=>s("option",{key:b,value:b+1},i(t),9,be)),64))],512),[[A,U.value]])])]),s("div",ke,[d(P,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",xe,[s("table",we,[s("thead",he,[s("tr",null,[e[17]||(e[17]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),m.value.btn_edit||m.value.btn_delete?(n(),l("th",Ce,"Aksi")):u("",!0)])]),s("tbody",null,[(n(!0),l(v,null,y(z.value,(t,b)=>{var T,C;return n(),l("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Ve,i(b+1),1),s("td",Ae,i(t.date),1),s("td",Se,i(D(t.amount)),1),s("td",Te,i(t.category.name),1),s("td",$e,i(((T=t.sub_category)==null?void 0:T.name)||"-"),1),s("td",Me,i(t.payment),1),s("td",Be,i(((C=t.account_bank)==null?void 0:C.name)||"-"),1),m.value.btn_edit||m.value.btn_delete?(n(),l("td",Ue,[m.value.btn_edit?(n(),I(O,{key:0,onClick:ee=>j("edit",t)},{default:_(()=>e[24]||(e[24]=[p("Edit")])),_:2},1032,["onClick"])):u("",!0),m.value.btn_delete?(n(),I(L,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:ee=>Z(t.id)},{default:_(()=>e[25]||(e[25]=[p("Hapus")])),_:2},1032,["onClick"])):u("",!0)])):u("",!0)])}),128))])])]),d(de,{show:M.value,title:h.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:S},{content:_(()=>[s("form",{onSubmit:ne(X,["prevent"])},[s("div",De,[d(k,{for:"date",value:"Tanggal"}),d(P,{id:"date",type:"date",modelValue:r(a).date,"onUpdate:modelValue":e[4]||(e[4]=t=>r(a).date=t),class:"block w-full"},null,8,["modelValue"]),d(x,{message:r(a).errors.date},null,8,["message"])]),s("div",Ee,[d(k,{for:"category_id",value:"Kategori"}),f(s("select",{id:"category_id","onUpdate:modelValue":e[5]||(e[5]=t=>r(a).category_id=t),class:"block w-full border rounded-md p-2",onChange:e[6]||(e[6]=(...t)=>o.onCategoryChange&&o.onCategoryChange(...t))},[e[26]||(e[26]=s("option",{disabled:"",value:""},"Pilih Kategori",-1)),(n(!0),l(v,null,y($.categories,t=>(n(),l("option",{key:t.id,value:t.id,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(n(),l("span",Ie,"(Tidak Aktif)"))],8,Fe))),128))],544),[[A,r(a).category_id]]),d(x,{message:r(a).errors.category_id},null,8,["message"])]),s("div",Le,[d(k,{for:"sub_kategori_id",value:"Keterangan"}),f(s("select",{id:"sub_kategori_id","onUpdate:modelValue":e[7]||(e[7]=t=>r(a).sub_kategori_id=t),class:"block w-full border rounded-md p-2",disabled:!r(a).category_id,onChange:R},[e[27]||(e[27]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),l(v,null,y(G.value,t=>(n(),l("option",{key:t.id,value:t.id,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(n(),l("span",Ke,"(Tidak Aktif)"))],8,Ne))),128))],40,Pe),[[A,r(a).sub_kategori_id]]),d(x,{message:r(a).errors.sub_kategori_id},null,8,["message"])]),s("div",Je,[d(k,{for:"amount",value:"Jumlah"}),d(P,{id:"amount",type:"text",modelValue:E.value,"onUpdate:modelValue":e[8]||(e[8]=t=>E.value=t),onInput:Q,class:"block w-full"},null,8,["modelValue"]),d(x,{message:r(a).errors.amount},null,8,["message"])]),s("div",Re,[d(k,{for:"payment",value:"Pembayaran"}),s("div",je,[s("label",Ye,[f(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>r(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=t=>r(a).account_id="")},null,544),[[Y,r(a).payment]]),e[28]||(e[28]=s("span",null,"Transfer",-1))]),K.value?u("",!0):(n(),l("label",Oe,[f(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>r(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=t=>r(a).account_id=null)},null,544),[[Y,r(a).payment]]),e[29]||(e[29]=s("span",null,"Tunai",-1))]))]),d(x,{message:r(a).errors.payment},null,8,["message"])]),r(a).payment==="Transfer"?(n(),l("div",We,[d(k,{for:"account_id",value:"Sumber Rekening "}),f(s("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=t=>r(a).account_id=t),class:"block w-full border rounded-md p-2"},[e[30]||(e[30]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),s("optgroup",qe,[(n(!0),l(v,null,y($.accountBanks,t=>(n(),l("option",{key:t.id,value:`account_${t.id}`,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(n(),l("span",Ge,"(Tidak Aktif)"))],8,ze))),128))]),!K.value&&m.value.saving_expense?(n(),l("optgroup",He,[(n(!0),l(v,null,y(N.value,t=>(n(),l("option",{key:t.id,value:`subcategory_${t.id}`,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(n(),l("span",Xe,"(Tidak Aktif)"))],8,Qe))),128))])):u("",!0)],512),[[A,r(a).account_id]]),d(x,{message:r(a).errors.account_id},null,8,["message"])])):u("",!0),s("div",Ze,[d(O,{type:"button",onClick:S},{default:_(()=>e[31]||(e[31]=[p("Batal")])),_:1}),d(L,{class:"ml-3",type:"submit"},{default:_(()=>[p(i(h.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},ut=ie(et,[["__scopeId","data-v-0905e5bf"]]);export{ut as default};

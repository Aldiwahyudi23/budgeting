import{i as K,d as c,j as oe,k as $,C as le,l as ne,m as de,c as L,o as n,w as m,a as s,e as d,f as p,b as r,t as u,g as i,p as f,F as g,h as x,v as k,q as re,u as l,s as q,W as H}from"./app-vuRWwY5w.js";import{A as ue}from"./AppLayout-DUe8Ce2M.js";import{_ as E}from"./PrimaryButton-dymgl6nc.js";import{_ as O}from"./SecondaryButton-1tg3i5VR.js";import{_ as w}from"./InputLabel-DyQWX4TA.js";import{_ as Y}from"./TextInput-D_o0FTQ3.js";import{_ as h}from"./InputError-BHlYV7Y1.js";import{_ as ie}from"./CustomModal-CiNfRiBA.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pe={class:"p-4"},ce={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},ve={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},fe={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},be={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},_e={class:"flex items-center space-x-4 w-full md:w-auto"},ye={class:"flex-1 md:flex-none"},ge=["value"],xe={class:"flex-1 md:flex-none"},ke=["value"],we={class:"relative w-full md:w-64"},he={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Ce={class:"min-w-full"},Ve={class:"bg-gray-200"},Ae={key:0,class:"px-4 py-2 text-center"},Se={class:"px-4 py-2"},Me={class:"px-4 py-2"},$e={class:"px-4 py-2"},Pe={class:"px-4 py-2"},Te={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Ue={class:"px-4 py-2"},De={key:0,class:"px-4 py-2 text-center"},Fe={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},Ne={class:"flex items-center space-x-4"},je={class:"text-sm text-gray-700"},Be={class:"flex items-center space-x-4"},Le=["disabled"],Ee={class:"text-sm text-gray-700"},Ye=["disabled"],Re={class:"mb-4"},Je={class:"mb-4"},Ke={class:"mb-4"},qe=["value","disabled"],He={key:0},Oe={class:"mb-4"},We=["disabled"],ze=["value","disabled"],Ge={key:0},Qe={class:"mb-4"},Xe={class:"flex space-x-4 mt-2"},Ze={class:"flex items-center"},es={class:"flex items-center"},ss={key:0,class:"mb-4"},ts=["value","disabled"],as={key:0},os={class:"flex justify-end mt-4"},ls={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(U){const P=U;K();const _=c(""),D=c(!1),C=c(!1),b=c(K().props.settings),W=c(Array.from({length:10},(o,e)=>new Date().getFullYear()-e)),z=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],V=c(new Date().getFullYear()),A=c(new Date().getMonth()+1),v=c(1),S=c(10),G=()=>{const o={year:V.value,month:A.value};H.get(route("income.index"),o,{preserveState:!0,replace:!0})};oe([V,A],()=>{G()});const F=$(()=>P.incomes.filter(o=>{var M;const e=new Date(o.date),t=e.getFullYear()===V.value,y=e.getMonth()+1===A.value,I=_.value?o.source.name.toLowerCase().includes(_.value.toLowerCase())||((M=o.sub_source)==null?void 0:M.name.toLowerCase().includes(_.value.toLowerCase()))||o.payment.toLowerCase().includes(_.value.toLowerCase()):!0;return t&&y&&I})),R=$(()=>{const o=(v.value-1)*S.value,e=o+S.value;return F.value.slice(o,e)}),N=$(()=>Math.ceil(F.value.length/S.value)),Q=()=>{v.value<N.value&&v.value++},X=()=>{v.value>1&&v.value--},a=le({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),Z=$(()=>P.subSources.filter(o=>o.source_id===a.source_id)),j=o=>o?new Intl.NumberFormat("id-ID").format(o):"",ee=o=>o?o.replace(/\./g,""):"",B=$({get:()=>j(a.amount),set:o=>{a.amount=ee(o)}});ne(()=>{B.value=j(a.amount)});const J=(o,e=null)=>{C.value=o==="edit",C.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.source_id=e.source_id,a.sub_source_id=e.sub_source_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),D.value=!0},T=()=>{a.reset(),D.value=!1},se=()=>{C.value?a.put(route("income.update",a.id),{onSuccess:()=>T()}):a.post(route("income.store"),{onSuccess:()=>T()})},te=o=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&H.delete(route("income.destroy",o),{onSuccess:()=>{const e=P.incomes.findIndex(t=>t.id===o);e!==-1&&P.incomes.splice(e,1)},onError:()=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return de(()=>{b.value.saving_expense&&console.log(savingSubCategories.value)}),(o,e)=>(n(),L(ue,{title:"Income"},{default:m(()=>[s("div",pe,[o.$page.props.flash.success?(n(),d("div",ce,u(o.$page.props.flash.success),1)):p("",!0),o.$page.props.flash.error?(n(),d("div",ve,u(o.$page.props.flash.error),1)):p("",!0),e[40]||(e[40]=s("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[s("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pemasukan, termasuk kategori pemasukan seperti gaji, bonus, dan lainnya. ")],-1)),s("div",fe,[r(E,{onClick:e[0]||(e[0]=t=>J("create"))},{default:m(()=>e[15]||(e[15]=[i("Tambah Pemasukan")])),_:1}),s("div",be,[s("div",_e,[e[16]||(e[16]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",ye,[f(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),d(g,null,x(W.value,t=>(n(),d("option",{key:t,value:t},u(t),9,ge))),128))],512),[[k,V.value]])]),s("div",xe,[f(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>A.value=t),class:"block w-full border rounded-md p-2"},[(n(),d(g,null,x(z,(t,y)=>s("option",{key:y,value:y+1},u(t),9,ke)),64))],512),[[k,A.value]])])]),s("div",we,[r(Y,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[17]||(e[17]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",he,[s("table",Ce,[s("thead",Ve,[s("tr",null,[e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[24]||(e[24]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),b.value.btn_edit||b.value.btn_delete?(n(),d("th",Ae,"Aksi")):p("",!0)])]),s("tbody",null,[(n(!0),d(g,null,x(R.value,(t,y)=>{var I,M;return n(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Se,u(y+1),1),s("td",Me,u(t.date),1),s("td",$e,u(j(t.amount)),1),s("td",Pe,u(t.source.name),1),s("td",Te,u(((I=t.sub_source)==null?void 0:I.name)||"-"),1),s("td",Ie,u(t.payment),1),s("td",Ue,u(((M=t.account_bank)==null?void 0:M.name)||"-"),1),b.value.btn_edit||b.value.btn_delete?(n(),d("td",De,[b.value.btn_edit?(n(),L(O,{key:0,onClick:ae=>J("edit",t)},{default:m(()=>e[25]||(e[25]=[i("Edit")])),_:2},1032,["onClick"])):p("",!0),b.value.btn_delete?(n(),L(E,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:ae=>te(t.id)},{default:m(()=>e[26]||(e[26]=[i("Hapus")])),_:2},1032,["onClick"])):p("",!0)])):p("",!0)])}),128))])])]),s("div",Fe,[s("div",Ne,[s("span",je,"Menampilkan "+u(R.value.length)+" dari "+u(F.value.length)+" data",1),f(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>S.value=t),class:"border rounded-md p-2 text-sm"},e[27]||(e[27]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[k,S.value]])]),s("div",Be,[s("button",{onClick:X,disabled:v.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,Le),s("span",Ee,"Halaman "+u(v.value)+" dari "+u(N.value),1),s("button",{onClick:Q,disabled:v.value===N.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,Ye)])]),r(ie,{show:D.value,title:C.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:T},{content:m(()=>[s("form",{onSubmit:re(se,["prevent"])},[s("div",Re,[r(w,{for:"date"},{default:m(()=>e[28]||(e[28]=[i(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(Y,{id:"date",type:"date",modelValue:l(a).date,"onUpdate:modelValue":e[5]||(e[5]=t=>l(a).date=t),class:"block w-full"},null,8,["modelValue"]),r(h,{message:l(a).errors.date},null,8,["message"])]),s("div",Je,[r(w,{for:"amount"},{default:m(()=>e[29]||(e[29]=[i(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(Y,{id:"amount",type:"text",modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=t=>B.value=t),onInput:o.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),r(h,{message:l(a).errors.amount},null,8,["message"])]),s("div",Ke,[r(w,{for:"source_id"},{default:m(()=>e[30]||(e[30]=[i(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"source_id","onUpdate:modelValue":e[7]||(e[7]=t=>l(a).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[8]||(e[8]=t=>l(a).sub_source_id=null)},[e[31]||(e[31]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),d(g,null,x(U.sources,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",He,"(Tidak Aktif)"))],8,qe))),128))],544),[[k,l(a).source_id]]),r(h,{message:l(a).errors.source_id},null,8,["message"])]),s("div",Oe,[r(w,{for:"sub_source_id"},{default:m(()=>e[32]||(e[32]=[i(" Keterangan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"sub_source_id","onUpdate:modelValue":e[9]||(e[9]=t=>l(a).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!l(a).source_id},[e[33]||(e[33]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),d(g,null,x(Z.value,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",Ge,"(Tidak Aktif)"))],8,ze))),128))],8,We),[[k,l(a).sub_source_id]]),r(h,{message:l(a).errors.sub_source_id},null,8,["message"])]),s("div",Qe,[r(w,{for:"payment"},{default:m(()=>e[34]||(e[34]=[i(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",Xe,[s("label",Ze,[f(s("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=t=>l(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[11]||(e[11]=t=>l(a).account_id="")},null,544),[[q,l(a).payment]]),e[35]||(e[35]=s("span",null,"Transfer",-1))]),s("label",es,[f(s("input",{type:"radio","onUpdate:modelValue":e[12]||(e[12]=t=>l(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[13]||(e[13]=t=>l(a).account_id=null)},null,544),[[q,l(a).payment]]),e[36]||(e[36]=s("span",null,"Tunai",-1))])]),r(h,{message:l(a).errors.payment},null,8,["message"])]),l(a).payment==="Transfer"?(n(),d("div",ss,[r(w,{for:"account_id"},{default:m(()=>e[37]||(e[37]=[i(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"account_id","onUpdate:modelValue":e[14]||(e[14]=t=>l(a).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[38]||(e[38]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),d(g,null,x(U.accountBanks,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",as,"(Tidak Aktif)"))],8,ts))),128))],512),[[k,l(a).account_id]]),r(h,{message:l(a).errors.account_id},null,8,["message"])])):p("",!0),s("div",os,[r(O,{type:"button",onClick:T},{default:m(()=>e[39]||(e[39]=[i("Batal")])),_:1}),r(E,{class:"ml-3",type:"submit"},{default:m(()=>[i(u(C.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},fs=me(ls,[["__scopeId","data-v-b743e2bd"]]);export{fs as default};

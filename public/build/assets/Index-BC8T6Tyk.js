import{i as H,d as v,j as oe,k,C as ne,l as de,m as re,c as E,o,w as p,a as s,e as d,f as c,b as r,t as u,g as i,p as b,F as w,h,v as C,q as ue,u as n,s as J,W as K}from"./app-xDsUzAyu.js";import{A as ie}from"./AppLayout-Bf1I7wdw.js";import{_ as z}from"./PrimaryButton-DnhLbD4T.js";import{_ as O}from"./SecondaryButton-Dt2gU7nE.js";import{_ as g}from"./InputLabel-Bt1oKNcN.js";import{_ as I}from"./TextInput-BYj_b5ry.js";import{_}from"./InputError-D87L32QM.js";import{_ as me}from"./CustomModal-BnviBr1U.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./NavLink-DL5Lhnio.js";const ce={class:"p-4"},ve={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg"},fe={class:"flex items-center"},be={key:1,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg"},ge={class:"flex items-center"},_e={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ye={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},xe={class:"flex items-center space-x-4 w-full md:w-auto"},ke={class:"flex-1 md:flex-none"},we=["value"],he={class:"flex-1 md:flex-none"},Ce=["value"],Ve={class:"relative w-full md:w-64"},Se={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Ae={class:"min-w-full"},Me={class:"bg-gray-200"},Pe={key:0,class:"px-4 py-2 text-center"},Te={class:"px-4 py-2"},$e={class:"px-4 py-2"},Ue={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Le={class:"px-4 py-2"},Be={class:"px-4 py-2"},De={class:"px-4 py-2"},Ne={class:"px-4 py-2"},je={key:0,class:"px-4 py-2 text-center"},Fe={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},Ee={class:"flex items-center space-x-4"},ze={class:"text-sm text-gray-700"},Ye={class:"flex items-center space-x-4"},Re=["disabled"],qe={class:"text-sm text-gray-700"},He=["disabled"],Je={key:0,class:"mb-4"},Ke={class:"mb-4"},Oe={class:"mb-4"},We=["value","disabled"],Ge={key:0},Qe={class:"mb-4"},Xe=["disabled"],Ze=["value","disabled"],es={key:0},ss={class:"mb-4"},ts={key:1,class:"mb-4 p-3 bg-blue-50 rounded-md"},as={key:2},ls={class:"mb-4"},os={class:"flex space-x-4 mt-2"},ns={key:0,class:"flex items-center"},ds={key:1,class:"flex items-center"},rs={key:0,class:"mb-4"},us=["value","disabled"],is={key:0},ms={key:3,class:"text-red-500"},ps={class:"flex justify-end mt-4"},cs={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(L){const V=L;H();const y=v(""),B=v(!1),S=v(!1),m=v(H().props.settings),W=v(Array.from({length:10},(l,e)=>new Date().getFullYear()-e)),G=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],A=v(new Date().getFullYear()),M=v(new Date().getMonth()+1),f=v(1),P=v(10),Q=()=>{const l={year:A.value,month:M.value};K.get(route("income.index"),l,{preserveState:!0,replace:!0})};oe([A,M],()=>{Q()});const D=k(()=>V.incomes.filter(l=>{var T;const e=new Date(l.date),t=e.getFullYear()===A.value,x=e.getMonth()+1===M.value,U=y.value?l.source.name.toLowerCase().includes(y.value.toLowerCase())||((T=l.sub_source)==null?void 0:T.name.toLowerCase().includes(y.value.toLowerCase()))||l.payment.toLowerCase().includes(y.value.toLowerCase()):!0;return t&&x&&U})),Y=k(()=>{const l=V.sources.find(e=>e.id===a.source_id);return l&&l.name==="Saving (Tabungan)"}),R=k(()=>{const l=(f.value-1)*P.value,e=l+P.value;return D.value.slice(l,e)}),N=k(()=>Math.ceil(D.value.length/P.value)),X=()=>{f.value<N.value&&f.value++},Z=()=>{f.value>1&&f.value--},a=ne({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null,description:null}),ee=k(()=>V.subSources.filter(l=>l.source_id===a.source_id)),j=l=>l?new Intl.NumberFormat("id-ID").format(l):"",se=l=>l?l.replace(/\./g,""):"",F=k({get:()=>j(a.amount),set:l=>{a.amount=se(l)}});de(()=>{F.value=j(a.amount)});const q=(l,e=null)=>{S.value=l==="edit",S.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.source_id=e.source_id,a.sub_source_id=e.sub_source_id,a.payment=e.payment,a.account_id=e.account_id,a.description=e.description):a.reset(),B.value=!0},$=()=>{a.reset(),B.value=!1},te=()=>{Y.value&&(a.payment="Transfer"),S.value?a.put(route("income.update",a.id),{onSuccess:()=>$()}):a.post(route("income.store"),{onSuccess:()=>$()})},ae=l=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&K.delete(route("income.destroy",l),{onSuccess:()=>{const e=V.incomes.findIndex(t=>t.id===l);e!==-1&&V.incomes.splice(e,1)},onError:()=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return re(()=>{m.value.saving_expense&&console.log(savingSubCategories.value)}),(l,e)=>(o(),E(ie,{title:"Income"},{default:p(()=>[s("div",ce,[l.$page.props.flash.success?(o(),d("div",ve,[s("div",fe,[e[16]||(e[16]=s("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),s("p",null,u(l.$page.props.flash.success),1)])])):c("",!0),l.$page.props.flash.error?(o(),d("div",be,[s("div",ge,[e[17]||(e[17]=s("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),s("p",null,u(l.$page.props.flash.error),1)])])):c("",!0),e[46]||(e[46]=s("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[s("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pemasukan, termasuk kategori pemasukan seperti gaji, bonus, dan lainnya. ")],-1)),s("div",_e,[r(z,{onClick:e[0]||(e[0]=t=>q("create"))},{default:p(()=>e[18]||(e[18]=[i("Tambah Pemasukan")])),_:1}),s("div",ye,[s("div",xe,[e[19]||(e[19]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",ke,[b(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>A.value=t),class:"block w-full border rounded-md p-2"},[(o(!0),d(w,null,h(W.value,t=>(o(),d("option",{key:t,value:t},u(t),9,we))),128))],512),[[C,A.value]])]),s("div",he,[b(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>M.value=t),class:"block w-full border rounded-md p-2"},[(o(),d(w,null,h(G,(t,x)=>s("option",{key:x,value:x+1},u(t),9,Ce)),64))],512),[[C,M.value]])])]),s("div",Ve,[r(I,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[20]||(e[20]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",Se,[s("table",Ae,[s("thead",Me,[s("tr",null,[e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[24]||(e[24]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[25]||(e[25]=s("th",{class:"px-4 py-2 text-left"},"Poin",-1)),e[26]||(e[26]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[27]||(e[27]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[28]||(e[28]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),m.value.btn_edit||m.value.btn_delete?(o(),d("th",Pe,"Aksi")):c("",!0)])]),s("tbody",null,[(o(!0),d(w,null,h(R.value,(t,x)=>{var U,T;return o(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Te,u(x+1),1),s("td",$e,u(t.date),1),s("td",Ue,u(j(t.amount)),1),s("td",Ie,u(t.source.name),1),s("td",Le,u(((U=t.sub_source)==null?void 0:U.name)||"-"),1),s("td",Be,u(t.description||"-"),1),s("td",De,u(t.payment),1),s("td",Ne,u(((T=t.account_bank)==null?void 0:T.name)||"Tunai"),1),m.value.btn_edit||m.value.btn_delete?(o(),d("td",je,[m.value.btn_edit?(o(),E(O,{key:0,onClick:le=>q("edit",t)},{default:p(()=>e[29]||(e[29]=[i("Edit")])),_:2},1032,["onClick"])):c("",!0),m.value.btn_delete?(o(),E(z,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:le=>ae(t.id)},{default:p(()=>e[30]||(e[30]=[i("Hapus")])),_:2},1032,["onClick"])):c("",!0)])):c("",!0)])}),128))])])]),s("div",Fe,[s("div",Ee,[s("span",ze,"Menampilkan "+u(R.value.length)+" dari "+u(D.value.length)+" data",1),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>P.value=t),class:"border rounded-md p-2 text-sm"},e[31]||(e[31]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[C,P.value]])]),s("div",Ye,[s("button",{onClick:Z,disabled:f.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,Re),s("span",qe,"Halaman "+u(f.value)+" dari "+u(N.value),1),s("button",{onClick:X,disabled:f.value===N.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,He)])]),r(me,{show:B.value,title:S.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:$},{content:p(()=>[s("form",{onSubmit:ue(te,["prevent"])},[m.value.date_in?(o(),d("div",Je,[r(g,{for:"date"},{default:p(()=>e[32]||(e[32]=[i(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(I,{id:"date",type:"date",modelValue:n(a).date,"onUpdate:modelValue":e[5]||(e[5]=t=>n(a).date=t),class:"block w-full",required:""},null,8,["modelValue"]),r(_,{message:n(a).errors.date},null,8,["message"])])):c("",!0),s("div",Ke,[r(g,{for:"amount"},{default:p(()=>e[33]||(e[33]=[i(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(I,{id:"amount",type:"text",modelValue:F.value,"onUpdate:modelValue":e[6]||(e[6]=t=>F.value=t),onInput:l.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),r(_,{message:n(a).errors.amount},null,8,["message"])]),s("div",Oe,[r(g,{for:"source_id"},{default:p(()=>e[34]||(e[34]=[i(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"source_id","onUpdate:modelValue":e[7]||(e[7]=t=>n(a).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[8]||(e[8]=t=>n(a).sub_source_id=null)},[e[35]||(e[35]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(o(!0),d(w,null,h(L.sources,t=>(o(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?c("",!0):(o(),d("span",Ge,"(Tidak Aktif)"))],8,We))),128))],544),[[C,n(a).source_id]]),r(_,{message:n(a).errors.source_id},null,8,["message"])]),s("div",Qe,[r(g,{for:"sub_source_id"},{default:p(()=>e[36]||(e[36]=[i(" Poin "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"sub_source_id","onUpdate:modelValue":e[9]||(e[9]=t=>n(a).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!n(a).source_id},[e[37]||(e[37]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(o(!0),d(w,null,h(ee.value,t=>(o(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?c("",!0):(o(),d("span",es,"(Tidak Aktif)"))],8,Ze))),128))],8,Xe),[[C,n(a).sub_source_id]]),r(_,{message:n(a).errors.sub_source_id},null,8,["message"])]),s("div",ss,[r(g,{for:"description"},{default:p(()=>e[38]||(e[38]=[i(" Keterangan ")])),_:1}),r(I,{id:"description",type:"text",modelValue:n(a).description,"onUpdate:modelValue":e[10]||(e[10]=t=>n(a).description=t),class:"block w-full"},null,8,["modelValue"]),r(_,{message:n(a).errors.description},null,8,["message"])]),Y.value?(o(),d("div",ts,e[39]||(e[39]=[s("p",{class:"text-sm text-blue-800"},[s("i",{class:"fas fa-info-circle mr-1"}),i(" Nabung secara langsung: uang akan langsung tercatat di Account Bank sesuai pengaturan. ")],-1)]))):(o(),d("div",as,[s("div",ls,[r(g,{for:"payment"},{default:p(()=>e[40]||(e[40]=[i(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",os,[m.value.bank?(o(),d("label",ns,[b(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>n(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[12]||(e[12]=t=>n(a).account_id="")},null,544),[[J,n(a).payment]]),e[41]||(e[41]=s("span",null,"Transfer",-1))])):c("",!0),m.value.cash?(o(),d("label",ds,[b(s("input",{type:"radio","onUpdate:modelValue":e[13]||(e[13]=t=>n(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[14]||(e[14]=t=>n(a).account_id=null)},null,544),[[J,n(a).payment]]),e[42]||(e[42]=s("span",null,"Tunai",-1))])):c("",!0)]),r(_,{message:n(a).errors.payment},null,8,["message"])]),n(a).payment==="Transfer"?(o(),d("div",rs,[r(g,{for:"account_id"},{default:p(()=>e[43]||(e[43]=[i(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"account_id","onUpdate:modelValue":e[15]||(e[15]=t=>n(a).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[44]||(e[44]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(o(!0),d(w,null,h(L.accountBanks,t=>(o(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?c("",!0):(o(),d("span",is,"(Tidak Aktif)"))],8,us))),128))],512),[[C,n(a).account_id]]),r(_,{message:n(a).errors.account_id},null,8,["message"])])):c("",!0)])),!m.value.bank&&!m.value.cash?(o(),d("span",ms,"Untuk melanjutkan Transaksi Harap Pilih salah satu Pembayaran di Setting")):c("",!0),s("div",ps,[r(O,{type:"button",onClick:$},{default:p(()=>e[45]||(e[45]=[i("Batal")])),_:1}),r(z,{disabled:!m.value.bank&&!m.value.cash,class:"ml-3",type:"submit"},{default:p(()=>[i(u(S.value?"Update":"Simpan"),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["show","title"])])]),_:1}))}},Cs=pe(cs,[["__scopeId","data-v-5d035cd4"]]);export{Cs as default};

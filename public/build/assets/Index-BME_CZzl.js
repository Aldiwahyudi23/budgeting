import{B as de,d as _,i as H,j as A,C as U,c as j,o as u,w as l,a as t,e as f,f as h,b as o,t as c,g as d,F as K,h as Q,u as i,P as re,q as W,p as Y,y as ue,v as me,W as pe}from"./app-DGnEmlNd.js";import{A as ce}from"./AppLayout-_irn6LmE.js";import{_ as P}from"./CustomModal-CX3Y0ott.js";import{_ as v}from"./PrimaryButton-83wIPzwK.js";import{_ as S}from"./SecondaryButton-DmKw0fI0.js";import{_ as k}from"./InputLabel-BROOhc7p.js";import{_ as b}from"./TextInput-C9LZCotX.js";import{_ as g}from"./InputError-CmhsqWuJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"p-4"},ve={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},ke={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},be={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ge={class:"relative"},xe={class:"mt-4 overflow-x-auto"},_e={class:"min-w-full border bg-white rounded-lg shadow-md"},we={class:"px-4 py-2"},ye={class:"px-4 py-2"},he={class:"px-4 py-2"},Ve={class:"px-4 py-2 text-center"},Ce={key:0,class:"px-2 py-1 text-green-700 bg-green-200 rounded-full text-sm"},Be={key:1,class:"px-2 py-1 text-red-700 bg-red-200 rounded-full text-sm"},Ae={class:"px-4 py-2 text-center"},Se={class:"mt-6 bg-white p-4 rounded-lg shadow-md"},Me={class:"flex items-center justify-between"},Te={class:"flex items-center"},$e={class:"ml-3"},Ie={class:"text-xl font-bold text-purple-600"},Ne={class:"mb-4"},De={class:"mb-4"},Fe={class:"mb-4"},Ue={class:"flex items-center mb-4"},je={class:"flex justify-end mt-4"},We={class:"mb-4"},Pe={class:"text-lg font-semibold"},Re={class:"mb-4"},Ee={class:"mb-4"},Le={class:"flex justify-end mt-4"},Oe={class:"mb-4"},ze=["value","disabled"],qe={key:0},He={class:"mb-4"},Ke={class:"mb-4"},Qe={class:"flex justify-end mt-4"},at={__name:"Index",props:{accountBanks:Array,cashBalance:Number},setup(R){const m=de([...R.accountBanks]),M=_(!1),y=_(!1),T=_(""),$=_(!1),I=_(!1),V=_(null),E=_(H().props.settings),G=A(()=>m.filter(s=>s.name.toLowerCase().includes(T.value.toLowerCase()))),J={id:"",name:"",description:"",amount:"",is_active:!1,user_id:H().props.auth.user.id},a=U({...J}),w=s=>!s&&s!==0?"":new Intl.NumberFormat("id-ID").format(s),N=s=>s?String(s).replace(/\./g,""):"",L=A({get:()=>w(a.amount),set:s=>a.amount=N(s)}),X=s=>{const e=String(s.target.value).replace(/\./g,"");a.amount=e},O=(s,e=null)=>{y.value=s==="edit",y.value&&e?(a.id=e.id,a.name=e.name,a.description=e.description,a.amount=e.amount||"",a.is_active=!!e.is_active):a.reset(),M.value=!0},C=()=>{a.reset(),M.value=!1},Z=()=>{y.value?a.put(route("account-bank.update",a.id),{onSuccess:()=>{const s=m.findIndex(e=>e.id===a.id);s!==-1&&(m[s]={...a.data()}),C()}}):a.post(route("account-bank.store"),{onSuccess:s=>{m.unshift(s.props.accountBanks[0]),C()}})},ee=s=>{confirm("Apakah Anda yakin ingin menghapus rekening bank ini?")&&a.delete(route("account-bank.destroy",s),{onSuccess:()=>{const e=m.findIndex(n=>n.id===s);e!==-1&&m.splice(e,1)}})},p=U({amount:"",note:"",bank_id:null}),z=A({get:()=>w(p.amount),set:s=>p.amount=N(s)}),te=s=>{const e=String(s.target.value).replace(/\./g,"");p.amount=e},se=s=>{V.value=s,p.bank_id=s.id,$.value=!0},D=()=>{p.reset(),$.value=!1},oe=()=>{p.post(route("account-bank.withdraw"),{onSuccess:()=>{D();const s=m.findIndex(e=>e.id===V.value.id);s!==-1&&(m[s].amount-=parseFloat(p.amount))}})},r=U({amount:"",note:"",bank_id:null}),q=A({get:()=>w(r.amount),set:s=>r.amount=N(s)}),ne=s=>{const e=String(s.target.value).replace(/\./g,"");r.amount=e},ae=()=>{I.value=!0},F=()=>{r.reset(),I.value=!1},le=()=>{r.post(route("account-bank.deposit"),{onSuccess:()=>{F();const s=m.findIndex(e=>e.id===r.bank_id);s!==-1&&(m[s].amount+=parseFloat(r.amount))}})},ie=s=>{pe.visit(route("account-bank.mutation",s))};return(s,e)=>(u(),j(ce,{title:"Account Bank"},{default:l(()=>[t("div",fe,[s.$page.props.flash.success?(u(),f("div",ve,c(s.$page.props.flash.success),1)):h("",!0),s.$page.props.flash.error?(u(),f("div",ke,c(s.$page.props.flash.error),1)):h("",!0),t("div",be,[o(v,{onClick:e[0]||(e[0]=n=>O("create"))},{default:l(()=>e[11]||(e[11]=[d("Tambah Rekening Bank")])),_:1}),t("div",ge,[o(b,{modelValue:T.value,"onUpdate:modelValue":e[1]||(e[1]=n=>T.value=n),placeholder:"Cari Rekening Bank...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[12]||(e[12]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),t("div",xe,[t("table",_e,[e[17]||(e[17]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"No"),t("th",{class:"px-4 py-2 text-left"},"Bank"),t("th",{class:"px-4 py-2 text-left"},"Nominal"),t("th",{class:"px-4 py-2 text-center"},"Status"),t("th",{class:"px-4 py-2 text-center"},"Aksi")])],-1)),t("tbody",null,[(u(!0),f(K,null,Q(G.value,(n,B)=>(u(),f("tr",{key:n.id,class:"border-b hover:bg-gray-100"},[t("td",we,c(B+1),1),t("td",ye,c(n.name),1),t("td",he,c(w(n.amount)),1),t("td",Ve,[n.is_active?(u(),f("span",Ce,"Aktif")):(u(),f("span",Be,"Tidak Aktif"))]),t("td",Ae,[E.value.btn_edit?(u(),j(S,{key:0,onClick:x=>O("edit",n)},{default:l(()=>e[13]||(e[13]=[d("Edit")])),_:2},1032,["onClick"])):h("",!0),o(v,{class:"ml-2 bg-blue-600 hover:bg-blue-700",onClick:x=>ie(n.id)},{default:l(()=>e[14]||(e[14]=[d("Mutasi")])),_:2},1032,["onClick"]),o(v,{class:"ml-2 bg-green-600 hover:bg-green-700",onClick:x=>se(n)},{default:l(()=>e[15]||(e[15]=[d("Tarik Tunai")])),_:2},1032,["onClick"]),E.value.btn_delete?(u(),j(v,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:x=>ee(n.id)},{default:l(()=>e[16]||(e[16]=[d("Hapus")])),_:2},1032,["onClick"])):h("",!0)])]))),128))])])]),t("div",Se,[t("div",Me,[t("div",Te,[e[20]||(e[20]=t("div",{class:"bg-purple-100 p-2 rounded-full"},[t("svg",{class:"w-5 h-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",$e,[e[19]||(e[19]=t("h2",{class:"text-base font-semibold"},"Saldo Cash",-1)),t("p",Ie,c(w(R.cashBalance)),1),o(i(re),{href:s.route("debits.index"),class:"text-xs text-gray-500 hover:text-purple-600"},{default:l(()=>e[18]||(e[18]=[d("Klik untuk melihat detail mutasi")])),_:1},8,["href"])])]),o(v,{class:"bg-green-600 hover:bg-green-700",onClick:ae},{default:l(()=>e[21]||(e[21]=[d("Setor Tunai")])),_:1})])]),o(P,{show:M.value,title:y.value?"Edit Rekening Bank":"Tambah Rekening Bank",onClose:C},{content:l(()=>[t("form",{onSubmit:W(Z,["prevent"])},[t("div",Ne,[o(k,{for:"name"},{default:l(()=>e[22]||(e[22]=[d(" Nama Rekening Bank "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(b,{id:"name",modelValue:i(a).name,"onUpdate:modelValue":e[2]||(e[2]=n=>i(a).name=n),class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(a).errors.name},null,8,["message"])]),t("div",De,[o(k,{for:"description",value:"Deskripsi"}),o(b,{id:"description",modelValue:i(a).description,"onUpdate:modelValue":e[3]||(e[3]=n=>i(a).description=n),class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(a).errors.description},null,8,["message"])]),t("div",Fe,[o(k,{for:"amount",value:"Nominal"}),o(b,{id:"amount",type:"text",modelValue:L.value,"onUpdate:modelValue":e[4]||(e[4]=n=>L.value=n),onInput:X,class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(a).errors.amount},null,8,["message"])]),t("div",Ue,[Y(t("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":e[5]||(e[5]=n=>i(a).is_active=n),class:"mr-2"},null,512),[[ue,i(a).is_active]]),e[23]||(e[23]=t("label",{for:"is_active"},"Aktif",-1))]),t("div",je,[o(S,{type:"button",onClick:C},{default:l(()=>e[24]||(e[24]=[d("Batal")])),_:1}),o(v,{class:"ml-3",type:"submit"},{default:l(()=>[d(c(y.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"]),o(P,{show:$.value,title:"Tarik Tunai ",onClose:D},{content:l(()=>{var n,B;return[t("form",{onSubmit:W(oe,["prevent"])},[t("div",We,[t("h2",Pe,c((n=V.value)==null?void 0:n.name)+" "+c(w((B=V.value)==null?void 0:B.amount)),1)]),t("div",Re,[o(k,{for:"withdrawAmount"},{default:l(()=>e[25]||(e[25]=[d(" Nominal Yang Ditarik "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(b,{id:"withdrawAmount",type:"text",modelValue:z.value,"onUpdate:modelValue":e[6]||(e[6]=x=>z.value=x),onInput:te,class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(p).errors.amount},null,8,["message"])]),t("div",Ee,[o(k,{for:"note",value:"Catatan"}),o(b,{id:"note",modelValue:i(p).note,"onUpdate:modelValue":e[7]||(e[7]=x=>i(p).note=x),class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(p).errors.note},null,8,["message"])]),t("div",Le,[o(S,{type:"button",onClick:D},{default:l(()=>e[26]||(e[26]=[d("Batal")])),_:1}),o(v,{class:"ml-3",type:"submit"},{default:l(()=>e[27]||(e[27]=[d("Tarik/Pindah ke Cash")])),_:1})])],32)]}),_:1},8,["show"]),o(P,{show:I.value,title:"Setor Tunai",onClose:F},{content:l(()=>[t("form",{onSubmit:W(le,["prevent"])},[t("div",Oe,[o(k,{for:"bank_id"},{default:l(()=>e[28]||(e[28]=[d(" Pilih Bank Tujuan "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),Y(t("select",{id:"bank_id","onUpdate:modelValue":e[8]||(e[8]=n=>i(r).bank_id=n),class:"block w-full border rounded-md p-2"},[e[29]||(e[29]=t("option",{disabled:"",value:""},"Pilih Bank",-1)),(u(!0),f(K,null,Q(m,n=>(u(),f("option",{key:n.id,value:n.id,disabled:!n.is_active},[d(c(n.name)+" ",1),n.is_active?h("",!0):(u(),f("span",qe,"(Tidak Aktif)"))],8,ze))),128))],512),[[me,i(r).bank_id]]),o(g,{message:i(r).errors.bank_id},null,8,["message"])]),t("div",He,[o(k,{for:"depositAmount"},{default:l(()=>e[30]||(e[30]=[d(" Nominal Setor Tunai "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(b,{id:"depositAmount",type:"text",modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=n=>q.value=n),onInput:ne,class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(r).errors.amount},null,8,["message"])]),t("div",Ke,[o(k,{for:"note",value:"Catatan"}),o(b,{id:"note",modelValue:i(r).note,"onUpdate:modelValue":e[10]||(e[10]=n=>i(r).note=n),class:"block w-full"},null,8,["modelValue"]),o(g,{message:i(r).errors.note},null,8,["message"])]),t("div",Qe,[o(S,{type:"button",onClick:F},{default:l(()=>e[31]||(e[31]=[d("Batal")])),_:1}),o(v,{class:"ml-3",type:"submit"},{default:l(()=>e[32]||(e[32]=[d("Setor/Pindah ke Bank")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{at as default};

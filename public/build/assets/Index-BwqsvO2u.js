import{i as D,d as c,j as N,C as Q,k as q,c as F,o as l,w as m,a as t,e as n,f as u,b as d,t as i,g as p,l as _,F as g,h as f,u as o,v as S,m as X,p as R,W as Z}from"./app-DAhUBfNg.js";import{A as ee}from"./AppLayout-B9YO4Fio.js";import{_ as P}from"./PrimaryButton-CH66qtZZ.js";import{_ as I}from"./SecondaryButton-BmdcTKXT.js";import{_ as b}from"./InputLabel-CXVA5cC8.js";import{_ as B}from"./TextInput-Dfffom07.js";import{_ as y}from"./InputError-DNhYr1Wq.js";import{_ as se}from"./CustomModal-CiEaeTYu.js";import{h as te}from"./sweetalert-DYYedk_g.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"p-4"},oe={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},le={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},ne={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},re={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},de={class:"flex items-center space-x-4 w-full md:w-auto"},ie={class:"flex-1 md:flex-none"},ue=["value"],pe={class:"flex-1 md:flex-none"},ce=["value"],me={class:"relative w-full md:w-64"},_e={class:"mt-4 overflow-x-auto"},ge={class:"min-w-full border bg-white rounded-lg shadow-md"},fe={class:"px-4 py-2"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ke={class:"px-4 py-2"},xe={class:"px-4 py-2"},he={class:"px-4 py-2"},we={class:"px-4 py-2 text-center"},Se={class:"mb-4"},Ve={class:"mb-4"},Ce={class:"mb-4"},$e=["value","disabled"],Ae={key:0},Me={class:"mb-4"},Te=["disabled"],Ue=["value","disabled"],De={key:0},Fe={class:"mb-4"},Pe={class:"flex space-x-4 mt-2"},Be={class:"flex items-center"},Le={class:"flex items-center"},Ee={key:0,class:"mb-4"},Ke={disabled:"",value:""},Ne={key:0},Re={label:"Rekening"},Ie=["value","disabled"],Je={key:0},je={key:0,label:"Sub Kategori (Saving)"},Ye=["value","disabled"],Oe={key:0},We={class:"flex justify-end mt-4"},as={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array},setup(A){const L=D();console.log(L.props.flash),te(L);const V=A,k=c(""),M=c(!1),x=c(!1),h=c(D().props.settings),E=c(D().props.savingSubCategories),J=Array.from({length:6},(r,e)=>2025+e),j=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],T=c(new Date().getFullYear()),U=c(new Date().getMonth()+1),Y=N(()=>V.expenses.filter(r=>{var w;const e=new Date(r.date),s=e.getFullYear()===T.value,v=e.getMonth()+1===U.value,$=r.category.name.toLowerCase().includes(k.value.toLowerCase())||((w=r.sub_category)==null?void 0:w.name.toLowerCase().includes(k.value.toLowerCase()))||r.payment.toLowerCase().includes(k.value.toLowerCase());return s&&v&&$})),O=N(()=>V.subCategories.filter(r=>r.category_id===a.category_id)),W=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r),a=Q({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),K=(r,e=null)=>{x.value=r==="edit",x.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),M.value=!0},C=()=>{a.reset(),M.value=!1},z=()=>{x.value?a.put(route("expense.update",a.id),{onSuccess:()=>C()}):a.post(route("expense.store"),{onSuccess:()=>C()})},G=r=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&Z.delete(route("expense.destroy",r),{onSuccess:()=>{const e=V.expenses.findIndex(s=>s.id===r);e!==-1&&V.expenses.splice(e,1)},onError:e=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return q(()=>{h.value.saving_expense&&console.log(E.value)}),(r,e)=>(l(),F(ee,{title:"Expenses"},{default:m(()=>[t("div",ae,[r.$page.props.flash.success?(l(),n("div",oe,i(r.$page.props.flash.success),1)):u("",!0),r.$page.props.flash.error?(l(),n("div",le,i(r.$page.props.flash.error),1)):u("",!0),t("div",ne,[d(P,{onClick:e[0]||(e[0]=s=>K("create"))},{default:m(()=>e[14]||(e[14]=[p("Tambah Pengeluaran")])),_:1}),t("div",re,[t("div",de,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",ie,[_(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>T.value=s),class:"block w-full border rounded-md p-2"},[(l(!0),n(g,null,f(o(J),s=>(l(),n("option",{key:s,value:s},i(s),9,ue))),128))],512),[[S,T.value]])]),t("div",pe,[_(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"block w-full border rounded-md p-2"},[(l(),n(g,null,f(j,(s,v)=>t("option",{key:v,value:v+1},i(s),9,ce)),64))],512),[[S,U.value]])])]),t("div",me,[d(B,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),placeholder:"Cari Pemasukan...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",_e,[t("table",ge,[e[19]||(e[19]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"No"),t("th",{class:"px-4 py-2 text-left"},"Tanggal"),t("th",{class:"px-4 py-2 text-left"},"Jumlah"),t("th",{class:"px-4 py-2 text-left"},"Kategori"),t("th",{class:"px-4 py-2 text-left"},"Sub Kategori"),t("th",{class:"px-4 py-2 text-left"},"Pembayaran"),t("th",{class:"px-4 py-2 text-left"},"Rekening"),t("th",{class:"px-4 py-2 text-center"},"Aksi")])],-1)),t("tbody",null,[(l(!0),n(g,null,f(Y.value,(s,v)=>{var $,w;return l(),n("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",fe,i(v+1),1),t("td",ve,i(s.date),1),t("td",be,i(W(s.amount)),1),t("td",ye,i(s.category.name),1),t("td",ke,i((($=s.sub_category)==null?void 0:$.name)||"-"),1),t("td",xe,i(s.payment),1),t("td",he,i(((w=s.account_bank)==null?void 0:w.name)||"-"),1),t("td",we,[h.value.btn_edit?(l(),F(I,{key:0,onClick:H=>K("edit",s)},{default:m(()=>e[17]||(e[17]=[p("Edit")])),_:2},1032,["onClick"])):u("",!0),h.value.btn_delete?(l(),F(P,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:H=>G(s.id)},{default:m(()=>e[18]||(e[18]=[p("Hapus")])),_:2},1032,["onClick"])):u("",!0)])])}),128))])])]),d(se,{show:M.value,title:x.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:C},{content:m(()=>[t("form",{onSubmit:X(z,["prevent"])},[t("div",Se,[d(b,{for:"date",value:"Tanggal"}),d(B,{id:"date",type:"date",modelValue:o(a).date,"onUpdate:modelValue":e[4]||(e[4]=s=>o(a).date=s),class:"block w-full"},null,8,["modelValue"]),d(y,{message:o(a).errors.date},null,8,["message"])]),t("div",Ve,[d(b,{for:"amount",value:"Jumlah"}),d(B,{id:"amount",type:"number",modelValue:o(a).amount,"onUpdate:modelValue":e[5]||(e[5]=s=>o(a).amount=s),class:"block w-full"},null,8,["modelValue"]),d(y,{message:o(a).errors.amount},null,8,["message"])]),t("div",Ce,[d(b,{for:"category_id",value:"Kategori"}),_(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>o(a).category_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>o(a).sub_kategori_id=null)},[e[20]||(e[20]=t("option",{disabled:"",value:""},"Pilih Kategori",-1)),(l(!0),n(g,null,f(A.categories,s=>(l(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Ae,"(Tidak Aktif)"))],8,$e))),128))],544),[[S,o(a).category_id]]),d(y,{message:o(a).errors.category_id},null,8,["message"])]),t("div",Me,[d(b,{for:"sub_kategori_id",value:"Sub Kategori"}),_(t("select",{id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=s=>o(a).sub_kategori_id=s),class:"block w-full border rounded-md p-2",disabled:!o(a).category_id},[e[21]||(e[21]=t("option",{disabled:"",value:""},"Pilih Sub Kategori",-1)),(l(!0),n(g,null,f(O.value,s=>(l(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",De,"(Tidak Aktif)"))],8,Ue))),128))],8,Te),[[S,o(a).sub_kategori_id]]),d(y,{message:o(a).errors.sub_kategori_id},null,8,["message"])]),t("div",Fe,[d(b,{for:"payment",value:"Pembayaran"}),t("div",Pe,[t("label",Be,[_(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>o(a).payment=s),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=s=>o(a).account_id="")},null,544),[[R,o(a).payment]]),e[22]||(e[22]=t("span",null,"Transfer",-1))]),t("label",Le,[_(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>o(a).payment=s),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=s=>o(a).account_id=null)},null,544),[[R,o(a).payment]]),e[23]||(e[23]=t("span",null,"Tunai",-1))])]),d(y,{message:o(a).errors.payment},null,8,["message"])]),o(a).payment==="Transfer"?(l(),n("div",Ee,[d(b,{for:"account_id",value:"Sumber Rekening "}),_(t("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=s=>o(a).account_id=s),class:"block w-full border rounded-md p-2"},[t("option",Ke,[e[24]||(e[24]=p(" Pilih Rekening ")),h.value.saving_expense?(l(),n("span",Ne," / Dari Saving (Tabungan)")):u("",!0)]),t("optgroup",Re,[(l(!0),n(g,null,f(A.accountBanks,s=>(l(),n("option",{key:s.id,value:`account_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Je,"(Tidak Aktif)"))],8,Ie))),128))]),h.value.saving_expense?(l(),n("optgroup",je,[(l(!0),n(g,null,f(E.value,s=>(l(),n("option",{key:s.id,value:`subcategory_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(l(),n("span",Oe,"(Tidak Aktif)"))],8,Ye))),128))])):u("",!0)],512),[[S,o(a).account_id]]),d(y,{message:o(a).errors.account_id},null,8,["message"])])):u("",!0),t("div",We,[d(I,{type:"button",onClick:C},{default:m(()=>e[25]||(e[25]=[p("Batal")])),_:1}),d(P,{class:"ml-3",type:"submit"},{default:m(()=>[p(i(x.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{as as default};

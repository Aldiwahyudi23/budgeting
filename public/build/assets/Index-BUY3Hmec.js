import{i as J,d as c,j as oe,k as P,C as le,l as ne,m as de,c as E,o as n,w as m,a as s,e as r,f as p,b as d,t as u,g as i,p as b,F as k,h as w,v as h,q as re,u as l,s as K,W as H}from"./app-BAijexpd.js";import{A as ue}from"./AppLayout-DlFxLZi-.js";import{_ as Y}from"./PrimaryButton-DOrKTp0i.js";import{_ as O}from"./SecondaryButton-DkTZSIKd.js";import{_}from"./InputLabel-Bgs03EzX.js";import{_ as U}from"./TextInput-CaApGyw9.js";import{_ as y}from"./InputError-m3pCSlzm.js";import{_ as ie}from"./CustomModal-BjGm5vFm.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const pe={class:"p-4"},ce={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},fe={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},ve={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},be={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},_e={class:"flex items-center space-x-4 w-full md:w-auto"},ye={class:"flex-1 md:flex-none"},ge=["value"],xe={class:"flex-1 md:flex-none"},ke=["value"],we={class:"relative w-full md:w-64"},he={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Ce={class:"min-w-full"},Ve={class:"bg-gray-200"},Ae={key:0,class:"px-4 py-2 text-center"},Se={class:"px-4 py-2"},Me={class:"px-4 py-2"},Pe={class:"px-4 py-2"},$e={class:"px-4 py-2"},Te={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Ue={class:"px-4 py-2"},De={class:"px-4 py-2"},Fe={key:0,class:"px-4 py-2 text-center"},Ne={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},je={class:"flex items-center space-x-4"},Be={class:"text-sm text-gray-700"},Le={class:"flex items-center space-x-4"},Ee=["disabled"],Ye={class:"text-sm text-gray-700"},Re=["disabled"],qe={key:0,class:"mb-4"},Je={class:"mb-4"},Ke={class:"mb-4"},He=["value","disabled"],Oe={key:0},We={class:"mb-4"},ze=["disabled"],Ge=["value","disabled"],Qe={key:0},Xe={class:"mb-4"},Ze={class:"mb-4"},es={class:"flex space-x-4 mt-2"},ss={class:"flex items-center"},ts={class:"flex items-center"},as={key:1,class:"mb-4"},os=["value","disabled"],ls={key:0},ns={class:"flex justify-end mt-4"},ds={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(D){const $=D;J();const g=c(""),F=c(!1),C=c(!1),f=c(J().props.settings),W=c(Array.from({length:10},(o,e)=>new Date().getFullYear()-e)),z=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],V=c(new Date().getFullYear()),A=c(new Date().getMonth()+1),v=c(1),S=c(10),G=()=>{const o={year:V.value,month:A.value};H.get(route("income.index"),o,{preserveState:!0,replace:!0})};oe([V,A],()=>{G()});const N=P(()=>$.incomes.filter(o=>{var M;const e=new Date(o.date),t=e.getFullYear()===V.value,x=e.getMonth()+1===A.value,I=g.value?o.source.name.toLowerCase().includes(g.value.toLowerCase())||((M=o.sub_source)==null?void 0:M.name.toLowerCase().includes(g.value.toLowerCase()))||o.payment.toLowerCase().includes(g.value.toLowerCase()):!0;return t&&x&&I})),R=P(()=>{const o=(v.value-1)*S.value,e=o+S.value;return N.value.slice(o,e)}),j=P(()=>Math.ceil(N.value.length/S.value)),Q=()=>{v.value<j.value&&v.value++},X=()=>{v.value>1&&v.value--},a=le({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null,description:null}),Z=P(()=>$.subSources.filter(o=>o.source_id===a.source_id)),B=o=>o?new Intl.NumberFormat("id-ID").format(o):"",ee=o=>o?o.replace(/\./g,""):"",L=P({get:()=>B(a.amount),set:o=>{a.amount=ee(o)}});ne(()=>{L.value=B(a.amount)});const q=(o,e=null)=>{C.value=o==="edit",C.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.source_id=e.source_id,a.sub_source_id=e.sub_source_id,a.payment=e.payment,a.account_id=e.account_id,a.description=e.description):a.reset(),F.value=!0},T=()=>{a.reset(),F.value=!1},se=()=>{C.value?a.put(route("income.update",a.id),{onSuccess:()=>T()}):a.post(route("income.store"),{onSuccess:()=>T()})},te=o=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&H.delete(route("income.destroy",o),{onSuccess:()=>{const e=$.incomes.findIndex(t=>t.id===o);e!==-1&&$.incomes.splice(e,1)},onError:()=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return de(()=>{f.value.saving_expense&&console.log(savingSubCategories.value)}),(o,e)=>(n(),E(ue,{title:"Income"},{default:m(()=>[s("div",pe,[o.$page.props.flash.success?(n(),r("div",ce,u(o.$page.props.flash.success),1)):p("",!0),o.$page.props.flash.error?(n(),r("div",fe,u(o.$page.props.flash.error),1)):p("",!0),e[43]||(e[43]=s("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[s("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pemasukan, termasuk kategori pemasukan seperti gaji, bonus, dan lainnya. ")],-1)),s("div",ve,[d(Y,{onClick:e[0]||(e[0]=t=>q("create"))},{default:m(()=>e[16]||(e[16]=[i("Tambah Pemasukan")])),_:1}),s("div",be,[s("div",_e,[e[17]||(e[17]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",ye,[b(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>V.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),r(k,null,w(W.value,t=>(n(),r("option",{key:t,value:t},u(t),9,ge))),128))],512),[[h,V.value]])]),s("div",xe,[b(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>A.value=t),class:"block w-full border rounded-md p-2"},[(n(),r(k,null,w(z,(t,x)=>s("option",{key:x,value:x+1},u(t),9,ke)),64))],512),[[h,A.value]])])]),s("div",we,[d(U,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=t=>g.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[18]||(e[18]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",he,[s("table",Ce,[s("thead",Ve,[s("tr",null,[e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Poin",-1)),e[24]||(e[24]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[25]||(e[25]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[26]||(e[26]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(n(),r("th",Ae,"Aksi")):p("",!0)])]),s("tbody",null,[(n(!0),r(k,null,w(R.value,(t,x)=>{var I,M;return n(),r("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Se,u(x+1),1),s("td",Me,u(t.date),1),s("td",Pe,u(B(t.amount)),1),s("td",$e,u(t.source.name),1),s("td",Te,u(((I=t.sub_source)==null?void 0:I.name)||"-"),1),s("td",Ie,u(t.description||"-"),1),s("td",Ue,u(t.payment),1),s("td",De,u(((M=t.account_bank)==null?void 0:M.name)||"-"),1),f.value.btn_edit||f.value.btn_delete?(n(),r("td",Fe,[f.value.btn_edit?(n(),E(O,{key:0,onClick:ae=>q("edit",t)},{default:m(()=>e[27]||(e[27]=[i("Edit")])),_:2},1032,["onClick"])):p("",!0),f.value.btn_delete?(n(),E(Y,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:ae=>te(t.id)},{default:m(()=>e[28]||(e[28]=[i("Hapus")])),_:2},1032,["onClick"])):p("",!0)])):p("",!0)])}),128))])])]),s("div",Ne,[s("div",je,[s("span",Be,"Menampilkan "+u(R.value.length)+" dari "+u(N.value.length)+" data",1),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>S.value=t),class:"border rounded-md p-2 text-sm"},e[29]||(e[29]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[h,S.value]])]),s("div",Le,[s("button",{onClick:X,disabled:v.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,Ee),s("span",Ye,"Halaman "+u(v.value)+" dari "+u(j.value),1),s("button",{onClick:Q,disabled:v.value===j.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,Re)])]),d(ie,{show:F.value,title:C.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:T},{content:m(()=>[s("form",{onSubmit:re(se,["prevent"])},[f.value.date_in?(n(),r("div",qe,[d(_,{for:"date"},{default:m(()=>e[30]||(e[30]=[i(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),d(U,{id:"date",type:"date",modelValue:l(a).date,"onUpdate:modelValue":e[5]||(e[5]=t=>l(a).date=t),class:"block w-full",required:""},null,8,["modelValue"]),d(y,{message:l(a).errors.date},null,8,["message"])])):p("",!0),s("div",Je,[d(_,{for:"amount"},{default:m(()=>e[31]||(e[31]=[i(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),d(U,{id:"amount",type:"text",modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=t=>L.value=t),onInput:o.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),d(y,{message:l(a).errors.amount},null,8,["message"])]),s("div",Ke,[d(_,{for:"source_id"},{default:m(()=>e[32]||(e[32]=[i(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"source_id","onUpdate:modelValue":e[7]||(e[7]=t=>l(a).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[8]||(e[8]=t=>l(a).sub_source_id=null)},[e[33]||(e[33]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),r(k,null,w(D.sources,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",Oe,"(Tidak Aktif)"))],8,He))),128))],544),[[h,l(a).source_id]]),d(y,{message:l(a).errors.source_id},null,8,["message"])]),s("div",We,[d(_,{for:"sub_source_id"},{default:m(()=>e[34]||(e[34]=[i(" Poin "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"sub_source_id","onUpdate:modelValue":e[9]||(e[9]=t=>l(a).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!l(a).source_id},[e[35]||(e[35]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),r(k,null,w(Z.value,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",Qe,"(Tidak Aktif)"))],8,Ge))),128))],8,ze),[[h,l(a).sub_source_id]]),d(y,{message:l(a).errors.sub_source_id},null,8,["message"])]),s("div",Xe,[d(_,{for:"description"},{default:m(()=>e[36]||(e[36]=[i(" Keterangan ")])),_:1}),d(U,{id:"description",type:"text",modelValue:l(a).description,"onUpdate:modelValue":e[10]||(e[10]=t=>l(a).description=t),class:"block w-full"},null,8,["modelValue"]),d(y,{message:l(a).errors.description},null,8,["message"])]),s("div",Ze,[d(_,{for:"payment"},{default:m(()=>e[37]||(e[37]=[i(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",es,[s("label",ss,[b(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>l(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[12]||(e[12]=t=>l(a).account_id="")},null,544),[[K,l(a).payment]]),e[38]||(e[38]=s("span",null,"Transfer",-1))]),s("label",ts,[b(s("input",{type:"radio","onUpdate:modelValue":e[13]||(e[13]=t=>l(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[14]||(e[14]=t=>l(a).account_id=null)},null,544),[[K,l(a).payment]]),e[39]||(e[39]=s("span",null,"Tunai",-1))])]),d(y,{message:l(a).errors.payment},null,8,["message"])]),l(a).payment==="Transfer"?(n(),r("div",as,[d(_,{for:"account_id"},{default:m(()=>e[40]||(e[40]=[i(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"account_id","onUpdate:modelValue":e[15]||(e[15]=t=>l(a).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[41]||(e[41]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),r(k,null,w(D.accountBanks,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",ls,"(Tidak Aktif)"))],8,os))),128))],512),[[h,l(a).account_id]]),d(y,{message:l(a).errors.account_id},null,8,["message"])])):p("",!0),s("div",ns,[d(O,{type:"button",onClick:T},{default:m(()=>e[42]||(e[42]=[i("Batal")])),_:1}),d(Y,{class:"ml-3",type:"submit"},{default:m(()=>[i(u(C.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},_s=me(ds,[["__scopeId","data-v-88c8be69"]]);export{_s as default};

import{S as ee,i as N,d as m,k as w,C as E,c as S,o as d,w as c,a as s,e as g,f as x,b as r,t as i,F as I,h as P,n as se,g as b,p as T,v as te,q as oe,u as p,x as ae,W as j}from"./app-vuRWwY5w.js";import{A as re}from"./AppLayout-DUe8Ce2M.js";import{_ as le}from"./CustomModal-CiNfRiBA.js";import{_ as K}from"./PrimaryButton-dymgl6nc.js";import{_ as U}from"./SecondaryButton-1tg3i5VR.js";import{_ as V}from"./InputLabel-DyQWX4TA.js";import{_ as M}from"./TextInput-D_o0FTQ3.js";import{_ as $}from"./InputError-BHlYV7Y1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function O(a,v,l){ee.fire({icon:a,title:v,text:l,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}function ne(a){var v,l;console.log(a),console.log(a==null?void 0:a.props),console.log((v=a==null?void 0:a.props)==null?void 0:v.flash),(l=a==null?void 0:a.props)!=null&&l.flash&&(a.props.flash.error&&O("error","Error",a.props.flash.error),a.props.flash.success&&O("success","Success",a.props.flash.success))}const de={class:"p-4"},ie={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},ue={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},ce={class:"mb-2"},pe={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},fe={class:"text-gray-700 font-medium"},me={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ge={class:"relative"},ve={class:"mt-4 overflow-x-auto"},be={class:"min-w-full border bg-white rounded-lg shadow-md"},ye={class:"bg-gray-200"},_e={key:0,class:"px-4 py-2 text-center"},xe={class:"px-4 py-2"},he={class:"px-4 py-2"},we={class:"px-4 py-2"},ke={class:"px-4 py-2"},Ce={class:"px-4 py-2 text-green-600"},Se={class:"px-4 py-2 text-red-600"},Ve={class:"px-4 py-2"},Me={key:0,class:"px-4 py-2 text-center"},$e={class:"flex justify-between items-center mt-4"},Ae={class:"flex items-center space-x-2"},Be={class:"flex space-x-2"},De=["disabled"],Fe=["disabled"],Le={class:"mb-4"},Ne={class:"mb-4"},Ee={class:"mb-4"},Ie={class:"flex items-center"},Pe={class:"flex justify-end mt-4"},Qe={__name:"IndexOrii",props:{savings:Array,categories:Array,subCategories:Array},setup(a){const v=N();console.log(v.props.flash),ne(v);const l=a,y=m(N().props.settings),h=m(""),q=m(!1),A=m(!1),f=m(1),_=m(10);m("");const B=w(()=>l.savings.filter(o=>{var e;return o.category.name.toLowerCase().includes(h.value.toLowerCase())||((e=o.sub_category)==null?void 0:e.name.toLowerCase().includes(h.value.toLowerCase()))||o.note.toLowerCase().includes(h.value.toLowerCase())})),z=()=>{const o=l.categories.find(e=>e.name==="Saving");return o?o.id:null};w(()=>l.subCategories.filter(o=>o.category_id===u.category_id));const W=w(()=>{const o=(f.value-1)*_.value,e=o+_.value;return B.value.slice(o,e)}),D=w(()=>Math.ceil(B.value.length/_.value)),G=()=>{f.value<D.value&&f.value++},H=()=>{f.value>1&&f.value--},Q=w(()=>{const o={};return l.savings.forEach(e=>{var t;(!o[e.sub_category_id]||new Date(e.date)>new Date(o[e.sub_category_id].date))&&(o[e.sub_category_id]={id:e.sub_category_id,name:((t=e.sub_category)==null?void 0:t.name)||"Tanpa Sub Kategori",balance:e.balance,date:e.date})}),Object.values(o)}),k=o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o||0),u=E({...{id:"",date:"",amount:0,note:"",category_id:"",sub_category_id:null}}),R=(o,e=null)=>{A.value=o==="edit",A.value&&e?(u.id=e.id,u.date=e.date,u.amount=e.amount,u.note=e.note,u.category_id=e.category_id,u.sub_category_id=e.sub_category_id):(u.reset(),u.category_id=z()),q.value=!0},J=o=>{confirm("Apakah Anda yakin ingin menghapus tabungan ini?")&&j.delete(route("savings.destroy",o),{onSuccess:()=>{const e=l.savings.findIndex(t=>t.id===o);e!==-1&&l.savings.splice(e,1)}})},F=m(!1),n=E({name:"",description:"",is_active:!0,category_id:""}),C=()=>{n.reset(),F.value=!1},X=()=>{n.post(route("sub-category.store"),{onSuccess:()=>{C(),j.reload()},onError:o=>{console.error("Gagal menyimpan sub kategori:",o)}})};return(o,e)=>(d(),S(re,{title:"Saving (Tabungan)"},{default:c(()=>[s("div",de,[o.$page.props.flash.success?(d(),g("div",ie,i(o.$page.props.flash.success),1)):x("",!0),o.$page.props.flash.error?(d(),g("div",ue,i(o.$page.props.flash.error),1)):x("",!0),s("div",ce,[s("div",pe,[(d(!0),g(I,null,P(Q.value,t=>(d(),g("div",{key:t.id,class:"bg-white p-4 rounded-lg shadow-md"},[s("h3",fe,i(t.name),1),s("p",{class:se(["text-2xl font-bold",t.balance<0?"text-red-600":"text-green-600"])},i(k(t.balance)),3)]))),128))])]),s("div",me,[s("div",ge,[r(M,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),placeholder:"Cari Tabungan...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[5]||(e[5]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),s("div",ve,[s("table",be,[s("thead",ye,[s("tr",null,[e[6]||(e[6]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[7]||(e[7]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[8]||(e[8]=s("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[9]||(e[9]=s("th",{class:"px-4 py-2 text-left"},"Catatan",-1)),e[10]||(e[10]=s("th",{class:"px-4 py-2 text-left"},"Masuk",-1)),e[11]||(e[11]=s("th",{class:"px-4 py-2 text-left"},"Keluar",-1)),e[12]||(e[12]=s("th",{class:"px-4 py-2 text-left"},"Saldo",-1)),y.value.btn_edit||y.value.btn_delete?(d(),g("th",_e,"Aksi")):x("",!0)])]),s("tbody",null,[(d(!0),g(I,null,P(W.value,(t,Y)=>{var L;return d(),g("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",xe,i((f.value-1)*_.value+Y+1),1),s("td",he,i(t.date),1),s("td",we,i(((L=t.sub_category)==null?void 0:L.name)||"-"),1),s("td",ke,i(t.note||"-"),1),s("td",Ce,i(t.amount>0?k(t.amount):"-"),1),s("td",Se,i(t.amount<0?k(Math.abs(t.amount)):"-"),1),s("td",Ve,i(k(t.balance)),1),y.value.btn_edit||y.value.btn_delete?(d(),g("td",Me,[y.value.btn_edit?(d(),S(U,{key:0,onClick:Z=>R("edit",t)},{default:c(()=>e[13]||(e[13]=[b("Edit")])),_:2},1032,["onClick"])):x("",!0),y.value.btn_delete?(d(),S(K,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:Z=>J(t.id)},{default:c(()=>e[14]||(e[14]=[b("Hapus")])),_:2},1032,["onClick"])):x("",!0)])):x("",!0)])}),128))])])]),s("div",$e,[s("div",Ae,[T(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>_.value=t),class:"border rounded-md p-1 text-sm"},e[15]||(e[15]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[te,_.value]])]),s("div",Be,[s("button",{onClick:H,disabled:f.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," back ",8,De),s("button",{onClick:G,disabled:f.value===D.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," next ",8,Fe)])]),r(le,{show:F.value,title:"Tambah Sub Kategori",onClose:C},{content:c(()=>[s("form",{onSubmit:oe(X,["prevent"])},[s("div",Le,[r(V,{for:"name"},{default:c(()=>e[16]||(e[16]=[b(" Nama Sub Kategori "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(M,{id:"name",modelValue:p(n).name,"onUpdate:modelValue":e[2]||(e[2]=t=>p(n).name=t),class:"block w-full",required:""},null,8,["modelValue"]),r($,{message:p(n).errors.name},null,8,["message"])]),s("div",Ne,[r(V,{for:"description"},{default:c(()=>e[17]||(e[17]=[b(" Deskripsi ")])),_:1}),r(M,{id:"description",modelValue:p(n).description,"onUpdate:modelValue":e[3]||(e[3]=t=>p(n).description=t),class:"block w-full"},null,8,["modelValue"]),r($,{message:p(n).errors.description},null,8,["message"])]),s("div",Ee,[r(V,{for:"is_active"},{default:c(()=>e[18]||(e[18]=[b(" Status ")])),_:1}),s("div",Ie,[T(s("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":e[4]||(e[4]=t=>p(n).is_active=t),class:"mr-2"},null,512),[[ae,p(n).is_active]]),e[19]||(e[19]=s("label",{for:"is_active"},"Aktif",-1))]),r($,{message:p(n).errors.is_active},null,8,["message"])]),s("div",Pe,[r(U,{type:"button",onClick:C},{default:c(()=>e[20]||(e[20]=[b("Batal")])),_:1}),r(K,{class:"ml-3",type:"submit"},{default:c(()=>e[21]||(e[21]=[b("Simpan")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{Qe as default};

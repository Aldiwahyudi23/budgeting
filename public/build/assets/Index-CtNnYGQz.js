import{i as z,d as v,j as W,k as f,C as me,l as ce,m as ge,c as B,o,w as c,a as t,e as n,f as u,b as r,t as i,g as p,p as b,F as y,h as x,v as V,q as ve,u as d,s as G,W as Q}from"./app-DleQbrcg.js";import{A as fe}from"./AppLayout-DXH1zN3w.js";import{_ as R}from"./PrimaryButton-Dryx_lj1.js";import{_ as X}from"./SecondaryButton-CPJRFxO1.js";import{_ as k}from"./InputLabel-CMjlhJYP.js";import{_ as $}from"./TextInput-D3gskPPg.js";import{_ as w}from"./InputError-BReUkTQ7.js";import{_ as _e}from"./CustomModal-DRsnJelY.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"p-4"},xe={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg"},ke={class:"flex items-center"},we={key:1,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg"},he={class:"flex items-center"},Ce={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},Ve={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},Se={class:"flex items-center space-x-4 w-full md:w-auto"},Ae={class:"flex-1 md:flex-none"},Me=["value"],Pe={class:"flex-1 md:flex-none"},Te=["value"],$e={class:"relative w-full md:w-64"},Le={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Ue={class:"min-w-full"},Be={class:"bg-gray-200"},De={key:0,class:"px-4 py-2 text-center"},Ie={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Fe={class:"px-4 py-2"},Ne={class:"px-4 py-2"},je={class:"px-4 py-2"},Ke={class:"px-4 py-2"},ze={class:"px-4 py-2"},Re={class:"px-4 py-2"},Ye={key:0,class:"px-4 py-2 text-center"},He={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},qe={class:"flex items-center space-x-4"},Je={class:"text-sm text-gray-700"},Oe={class:"flex items-center space-x-4"},We=["disabled"],Ge={class:"text-sm text-gray-700"},Qe=["disabled"],Xe={key:0,class:"mb-4"},Ze={class:"mb-4"},et=["value","disabled"],tt={key:0},st={class:"mb-4"},at=["disabled"],lt=["value","disabled"],ot={key:0},nt={class:"mb-4"},dt={class:"mb-4"},rt={class:"mb-4"},it={class:"flex space-x-4 mt-2"},ut={key:0,class:"flex items-center"},pt={key:1,class:"flex items-center"},mt={key:1,class:"mb-4"},ct={label:"Rekening"},gt=["value","disabled"],vt={key:0},ft={key:0,label:"Saving (Tabungan)"},_t=["value","disabled"],bt={key:0},yt={key:2,class:"text-red-500"},xt={class:"flex justify-end mt-4"},kt={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array,bills:Array,debts:Array},setup(D){const g=D;z();const h=v(""),I=v(!1),S=v(!1),m=v(z().props.settings),Y=v(z().props.savingSubCategories),Z=v(Array.from({length:10},(l,e)=>new Date().getFullYear()-e)),ee=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],A=v(new Date().getFullYear()),M=v(new Date().getMonth()+1),_=v(1),P=v(10),te=()=>{const l={year:A.value,month:M.value};Q.get(route("expense.index"),l,{preserveState:!0,replace:!0})};W([A,M],()=>{te()});const E=f(()=>g.expenses.filter(l=>{var T;const e=new Date(l.date),s=e.getFullYear()===A.value,C=e.getMonth()+1===M.value,U=h.value?l.category.name.toLowerCase().includes(h.value.toLowerCase())||((T=l.sub_category)==null?void 0:T.name.toLowerCase().includes(h.value.toLowerCase()))||l.payment.toLowerCase().includes(h.value.toLowerCase()):!0;return s&&C&&U})),H=f(()=>{const l=(_.value-1)*P.value,e=l+P.value;return E.value.slice(l,e)}),F=f(()=>Math.ceil(E.value.length/P.value)),se=()=>{_.value<F.value&&_.value++},ae=()=>{_.value>1&&_.value--},a=me({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,description:null,payment:"",account_id:null}),le=f(()=>g.subCategories.filter(l=>l.category_id===a.category_id)),N=l=>l?new Intl.NumberFormat("id-ID").format(l):"",oe=l=>l?l.replace(/\./g,""):"",j=f({get:()=>N(a.amount),set:l=>{a.amount=oe(l)}});ce(()=>{j.value=N(a.amount)});const q=f(()=>{const l=g.categories.find(e=>e.id===a.category_id);return l&&l.name==="Saving (Tabungan)"}),ne=f(()=>{const l=g.categories.find(e=>e.id===a.category_id);return l&&l.name==="Bills (Tagihan)"}),de=f(()=>{const l=g.categories.find(e=>e.id===a.category_id);return l&&l.name==="Debt (Hutang)"}),K=f(()=>{const l=g.categories.find(e=>e.id===a.category_id);return l&&l.name==="Loan (Pinjaman)"}),J=()=>{if(ne.value&&a.sub_kategori_id){const l=g.bills.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Bill:",l),a.amount=l?l.amount:""}if(de.value&&a.sub_kategori_id){const l=g.debts.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Debt:",l),a.amount=l?l.amount:""}},re=()=>{K.value&&(a.sub_kategori_id=null)};W(()=>a.sub_kategori_id,l=>{l&&J()});const O=(l,e=null)=>{S.value=l==="edit",S.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.description=e.description,a.payment=e.payment,a.account_id=e.account_id):a.reset(),I.value=!0},L=()=>{a.reset(),I.value=!1},ie=()=>{K.value&&(a.sub_kategori_id=a.sub_kategori_name),S.value?a.put(route("expense.update",a.id),{onSuccess:()=>L()}):a.post(route("expense.store"),{onSuccess:()=>L()})},ue=l=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&Q.delete(route("expense.destroy",l),{onSuccess:()=>{const e=g.expenses.findIndex(s=>s.id===l);e!==-1&&g.expenses.splice(e,1)},onError:()=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return ge(()=>{m.value.saving_expense&&console.log(Y.value)}),(l,e)=>(o(),B(fe,{title:"Expenses"},{default:c(()=>[t("div",ye,[l.$page.props.flash.success?(o(),n("div",xe,[t("div",ke,[e[16]||(e[16]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),t("p",null,i(l.$page.props.flash.success),1)])])):u("",!0),l.$page.props.flash.error?(o(),n("div",we,[t("div",he,[e[17]||(e[17]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",null,i(l.$page.props.flash.error),1)])])):u("",!0),e[45]||(e[45]=t("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[t("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pengeluaran, termasuk kategori pengeluaran seperti tagihan, hutang, dan tabungan. ")],-1)),t("div",Ce,[r(R,{onClick:e[0]||(e[0]=s=>O("create"))},{default:c(()=>e[18]||(e[18]=[p("Tambah Pengeluaran")])),_:1}),t("div",Ve,[t("div",Se,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",Ae,[b(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>A.value=s),class:"block w-full border rounded-md p-2"},[(o(!0),n(y,null,x(Z.value,s=>(o(),n("option",{key:s,value:s},i(s),9,Me))),128))],512),[[V,A.value]])]),t("div",Pe,[b(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>M.value=s),class:"block w-full border rounded-md p-2"},[(o(),n(y,null,x(ee,(s,C)=>t("option",{key:C,value:C+1},i(s),9,Te)),64))],512),[[V,M.value]])])]),t("div",$e,[r($,{modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=s=>h.value=s),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[20]||(e[20]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",Le,[t("table",Ue,[t("thead",Be,[t("tr",null,[e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[24]||(e[24]=t("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[25]||(e[25]=t("th",{class:"px-4 py-2 text-left"},"Poin",-1)),e[26]||(e[26]=t("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[27]||(e[27]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[28]||(e[28]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),m.value.btn_edit||m.value.btn_delete?(o(),n("th",De,"Aksi")):u("",!0)])]),t("tbody",null,[(o(!0),n(y,null,x(H.value,(s,C)=>{var U,T;return o(),n("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",Ie,i(C+1),1),t("td",Ee,i(s.date),1),t("td",Fe,i(N(s.amount)),1),t("td",Ne,i(s.category.name),1),t("td",je,i(((U=s.sub_category)==null?void 0:U.name)||"-"),1),t("td",Ke,i(s.description||"-"),1),t("td",ze,i(s.payment),1),t("td",Re,i(((T=s.account_bank)==null?void 0:T.name)||"Tunai"),1),m.value.btn_edit||m.value.btn_delete?(o(),n("td",Ye,[m.value.btn_edit?(o(),B(X,{key:0,onClick:pe=>O("edit",s)},{default:c(()=>e[29]||(e[29]=[p("Edit")])),_:2},1032,["onClick"])):u("",!0),m.value.btn_delete?(o(),B(R,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:pe=>ue(s.id)},{default:c(()=>e[30]||(e[30]=[p("Hapus")])),_:2},1032,["onClick"])):u("",!0)])):u("",!0)])}),128))])])]),t("div",He,[t("div",qe,[t("span",Je,"Menampilkan "+i(H.value.length)+" dari "+i(E.value.length)+" data",1),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s),class:"border rounded-md p-2 text-sm"},e[31]||(e[31]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),512),[[V,P.value]])]),t("div",Oe,[t("button",{onClick:ae,disabled:_.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,We),t("span",Ge,"Halaman "+i(_.value)+" dari "+i(F.value),1),t("button",{onClick:se,disabled:_.value===F.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,Qe)])]),r(_e,{show:I.value,title:S.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:L},{content:c(()=>[t("form",{onSubmit:ve(ie,["prevent"])},[m.value.date_ex?(o(),n("div",Xe,[r(k,{for:"date"},{default:c(()=>e[32]||(e[32]=[p(" Tanggal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r($,{id:"date",type:"date",modelValue:d(a).date,"onUpdate:modelValue":e[5]||(e[5]=s=>d(a).date=s),class:"block w-full",required:""},null,8,["modelValue"]),r(w,{message:d(a).errors.date},null,8,["message"])])):u("",!0),t("div",Ze,[r(k,{for:"category_id"},{default:c(()=>e[33]||(e[33]=[p(" Kategori "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>d(a).category_id=s),class:"block w-full border rounded-md p-2",onChange:re},[e[34]||(e[34]=t("option",{disabled:"",value:""},"Pilih Kategori",-1)),(o(!0),n(y,null,x(D.categories,s=>(o(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(o(),n("span",tt,"(Tidak Aktif)"))],8,et))),128))],544),[[V,d(a).category_id]]),r(w,{message:d(a).errors.category_id},null,8,["message"])]),t("div",st,[r(k,{for:"sub_kategori_id"},{default:c(()=>e[35]||(e[35]=[p(" Point "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),K.value?(o(),B($,{key:0,id:"sub_kategori_id",type:"text",modelValue:d(a).sub_kategori_name,"onUpdate:modelValue":e[7]||(e[7]=s=>d(a).sub_kategori_name=s),class:"block w-full"},null,8,["modelValue"])):b((o(),n("select",{key:1,id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=s=>d(a).sub_kategori_id=s),class:"block w-full border rounded-md p-2",disabled:!d(a).category_id,onChange:J},[e[36]||(e[36]=t("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(o(!0),n(y,null,x(le.value,s=>(o(),n("option",{key:s.id,value:s.id,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(o(),n("span",ot,"(Tidak Aktif)"))],8,lt))),128))],40,at)),[[V,d(a).sub_kategori_id]]),r(w,{message:d(a).errors.sub_kategori_id},null,8,["message"])]),t("div",nt,[r(k,{for:"description"},{default:c(()=>e[37]||(e[37]=[p(" Keterangan ")])),_:1}),r($,{id:"description",type:"text",modelValue:d(a).description,"onUpdate:modelValue":e[9]||(e[9]=s=>d(a).description=s),class:"block w-full"},null,8,["modelValue"]),r(w,{message:d(a).errors.description},null,8,["message"])]),t("div",dt,[r(k,{for:"amount"},{default:c(()=>e[38]||(e[38]=[p(" Nominal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r($,{id:"amount",type:"text",modelValue:j.value,"onUpdate:modelValue":e[10]||(e[10]=s=>j.value=s),onInput:l.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),r(w,{message:d(a).errors.amount},null,8,["message"])]),t("div",rt,[r(k,{for:"payment"},{default:c(()=>e[39]||(e[39]=[p(" Pembayaran "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),t("div",it,[m.value.bank?(o(),n("label",ut,[b(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>d(a).payment=s),value:"Transfer",class:"mr-2",onChange:e[12]||(e[12]=s=>d(a).account_id="")},null,544),[[G,d(a).payment]]),e[40]||(e[40]=t("span",null,"Transfer",-1))])):u("",!0),!q.value||m.value.cash?(o(),n("label",pt,[b(t("input",{type:"radio","onUpdate:modelValue":e[13]||(e[13]=s=>d(a).payment=s),value:"Tunai",class:"mr-2",onChange:e[14]||(e[14]=s=>d(a).account_id=null)},null,544),[[G,d(a).payment]]),e[41]||(e[41]=t("span",null,"Tunai",-1))])):u("",!0)]),r(w,{message:d(a).errors.payment},null,8,["message"])]),d(a).payment==="Transfer"?(o(),n("div",mt,[r(k,{for:"account_id"},{default:c(()=>e[42]||(e[42]=[p(" Sumber Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(t("select",{id:"account_id","onUpdate:modelValue":e[15]||(e[15]=s=>d(a).account_id=s),class:"block w-full border rounded-md p-2",required:""},[e[43]||(e[43]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),t("optgroup",ct,[(o(!0),n(y,null,x(D.accountBanks,s=>(o(),n("option",{key:s.id,value:`account_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(o(),n("span",vt,"(Tidak Aktif)"))],8,gt))),128))]),!q.value&&m.value.saving_expense?(o(),n("optgroup",ft,[(o(!0),n(y,null,x(Y.value,s=>(o(),n("option",{key:s.id,value:`subcategory_${s.id}`,disabled:!s.is_active},[p(i(s.name)+" ",1),s.is_active?u("",!0):(o(),n("span",bt,"(Tidak Aktif)"))],8,_t))),128))])):u("",!0)],512),[[V,d(a).account_id]]),r(w,{message:d(a).errors.account_id},null,8,["message"])])):u("",!0),!m.value.bank&&!m.value.cash?(o(),n("span",yt,"Untuk melanjutkan Transaksi Harap Pilih salah satu Pembayaran di Setting")):u("",!0),t("div",xt,[r(X,{type:"button",onClick:L},{default:c(()=>e[44]||(e[44]=[p("Batal")])),_:1}),r(R,{disabled:!m.value.bank&&!m.value.cash,class:"ml-3",type:"submit"},{default:c(()=>[p(i(S.value?"Update":"Simpan"),1)]),_:1},8,["disabled"])])],32)]),_:1},8,["show","title"])])]),_:1}))}},$t=be(kt,[["__scopeId","data-v-49408992"]]);export{$t as default};

import{d as $,k as w,C as B,c as D,o as d,w as l,a as e,b as n,e as m,g as r,F as I,h as U,t as u,n as E,q as N,u as i,p as F,v as K,W as M}from"./app-DtA5733D.js";import{A as J}from"./AppLayout-03gcdPRa.js";import{_ as R}from"./CustomModal-D1a3s5M1.js";import{_ as V}from"./PrimaryButton-O6V9uCDG.js";import{_ as T}from"./SecondaryButton-CrGhkVUd.js";import{_ as f}from"./InputLabel-D7zUsoe5.js";import{_ as g}from"./TextInput-C0sWp2z-.js";import{_ as c}from"./InputError-Bac3FOop.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"p-4"},W={class:"container mx-auto p-2"},q={key:0,class:"text-center bg-white p-6 rounded-lg shadow-md"},z={key:1},G={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},H={class:"flex items-center justify-between"},Q={class:"text-lg font-semibold"},X={class:"text-sm text-gray-500"},Y={class:"text-xl font-bold text-purple-600"},Z={class:"text-sm text-gray-500"},tt={class:"text-sm text-gray-500"},et={class:"mt-4 flex justify-between items-center"},st=["href"],at={key:1,class:"text-center bg-white p-2 rounded-lg shadow-md"},ot={class:"mb-4"},nt={class:"mb-4"},lt={class:"mb-4"},it={class:"mb-4"},rt={class:"mb-4"},dt={class:"flex justify-end mt-4"},yt={__name:"Pembayaran",props:{loans:Array,categories:Array,user:Object},setup(x){const _=x,b=$(!1),C=w(()=>_.categories.some(o=>o.name.trim().toLowerCase()==="loan (pinjaman)"&&o.user_id===_.user.id)),s=B({id:null,name:"",amount:"",paid_amount:"",status:"active",note:""}),p=o=>o?new Intl.NumberFormat("id-ID").format(o):"",j=o=>o?o.replace(/\./g,""):"",v=w({get:()=>p(s.amount),set:o=>{s.amount=j(o)}}),y=w({get:()=>p(s.paid_amount),set:o=>{s.paid_amount=j(o)}}),h=(o,t=null)=>{t&&(s.id=t.id,s.name=t.name,s.amount=t.amount,s.paid_amount=t.paid_amount,s.status=t.status,s.note=t.note),b.value=!0},k=()=>{s.reset(),b.value=!1},A=()=>{s.put(route("loans.update",s.id),{onSuccess:()=>k()})},L=o=>{v.value=o.target.value},P=o=>{y.value=o.target.value},S=()=>{M.post(route("category.store"),{name:"Loan (Pinjaman)",is_active:!0,user_id:_.user.id},{onSuccess:()=>{window.location.reload()},onError:o=>{console.error("Gagal menyimpan kategori:",o)}})};return(o,t)=>(d(),D(J,{title:"Kelola Pinjaman"},{default:l(()=>[e("div",O,[e("div",W,[t[9]||(t[9]=e("div",{class:"flex flex-col sm:flex-row justify-between items-start sm:items-center bg-white p-4 rounded-lg shadow-md mb-2"},[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Kelola Pinjaman"),e("p",{class:"text-sm text-gray-600 mt-1"}," Halaman ini digunakan untuk mengelola data pinjaman. ")])],-1)),C.value?(d(),m("div",z,[x.loans.length>0?(d(),m("div",G,[(d(!0),m(I,null,U(x.loans,a=>(d(),m("div",{key:a.id,class:"bg-white p-6 rounded-lg shadow-md"},[e("div",H,[e("h2",Q,u(a.name),1),e("span",{class:E(["px-2 py-1 text-xs font-semibold rounded-lg",a.status==="active"?"bg-green-100 text-green-600":a.status==="paid"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"])},u(a.status==="active"?"Aktif":a.status==="paid"?"Lunas":"Terlambat"),3)]),e("p",X,u(a.note||"-"),1),e("p",Y,"Rp "+u(p(a.amount)),1),e("p",Z,"Jumlah Dibayar: Rp "+u(p(a.paid_amount)),1),e("p",tt,"Sisa: Rp "+u(p(a.amount-a.paid_amount)),1),e("div",et,[n(V,{onClick:mt=>h("edit",a)},{default:l(()=>t[7]||(t[7]=[r("Edit")])),_:2},1032,["onClick"]),e("a",{href:o.route("loan.detail",{id:a.id}),class:"text-sm text-blue-500 hover:text-blue-700 underline"}," Lihat Detail ",8,st)])]))),128))])):(d(),m("div",at,t[8]||(t[8]=[e("p",{class:"text-gray-500 text-sm"},"Belum ada data pinjaman yang tercatat.",-1)])))])):(d(),m("div",q,[t[6]||(t[6]=e("p",{class:"text-gray-500 text-sm mb-4"},' Kategori "Loan (Pinjaman)" belum diaktifkan. Silakan aktifkan terlebih dahulu. ',-1)),n(V,{onClick:S},{default:l(()=>t[5]||(t[5]=[r("Aktifkan Kategori Loan")])),_:1})]))]),n(R,{show:b.value,title:"Edit Pinjaman",onClose:k},{content:l(()=>[e("form",{onSubmit:N(A,["prevent"])},[e("div",ot,[n(f,{for:"name"},{default:l(()=>t[10]||(t[10]=[r(" Nama Pinjaman "),e("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),n(g,{id:"name",modelValue:i(s).name,"onUpdate:modelValue":t[0]||(t[0]=a=>i(s).name=a),class:"block w-full"},null,8,["modelValue"]),n(c,{message:i(s).errors.name},null,8,["message"])]),e("div",nt,[n(f,{for:"amount"},{default:l(()=>t[11]||(t[11]=[r(" Jumlah Pinjaman "),e("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),n(g,{id:"amount",type:"text",modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a),onInput:L,class:"block w-full"},null,8,["modelValue"]),n(c,{message:i(s).errors.amount},null,8,["message"])]),e("div",lt,[n(f,{for:"paid_amount"},{default:l(()=>t[12]||(t[12]=[r(" Jumlah Dibayar "),e("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),n(g,{id:"paid_amount",type:"text",modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=a=>y.value=a),onInput:P,class:"block w-full"},null,8,["modelValue"]),n(c,{message:i(s).errors.paid_amount},null,8,["message"])]),e("div",it,[n(f,{for:"status"},{default:l(()=>t[13]||(t[13]=[r(" Status "),e("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),F(e("select",{id:"status","onUpdate:modelValue":t[3]||(t[3]=a=>i(s).status=a),class:"block w-full border rounded-md p-2"},t[14]||(t[14]=[e("option",{value:"active"},"Aktif",-1),e("option",{value:"paid"},"Lunas",-1),e("option",{value:"overdue"},"Terlambat",-1)]),512),[[K,i(s).status]]),n(c,{message:i(s).errors.status},null,8,["message"])]),e("div",rt,[n(f,{for:"note"},{default:l(()=>t[15]||(t[15]=[r(" Catatan ")])),_:1}),n(g,{id:"note",modelValue:i(s).note,"onUpdate:modelValue":t[4]||(t[4]=a=>i(s).note=a),class:"block w-full"},null,8,["modelValue"]),n(c,{message:i(s).errors.note},null,8,["message"])]),e("div",dt,[n(T,{type:"button",onClick:k},{default:l(()=>t[16]||(t[16]=[r("Batal")])),_:1}),n(V,{class:"ml-3",type:"submit"},{default:l(()=>t[17]||(t[17]=[r("Update")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{yt as default};

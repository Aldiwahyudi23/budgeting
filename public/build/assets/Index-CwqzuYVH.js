import{d as v,i as q,j as N,C as z,k as G,c as D,o as a,w as p,a as t,b as n,g as i,m as c,e as d,F as b,h as y,u as l,t as u,v as C,f as m,p as H,q as E,W as Q}from"./app-Wyj5FL83.js";import{A as X}from"./AppLayout-D6vfLCj3.js";import{_ as B}from"./PrimaryButton-Dkhr-xqu.js";import{_ as I}from"./SecondaryButton-Dqvv33b_.js";import{_ as k}from"./InputLabel-CUQtM5n5.js";import{_ as F}from"./TextInput-dGIrg0mI.js";import{_ as g}from"./InputError-CM8CVs0m.js";import{_ as Z}from"./CustomModal-mrV4PSEZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ee={class:"p-4"},se={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},te={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},oe={class:"flex items-center space-x-4 w-full md:w-auto"},le={class:"flex-1 md:flex-none"},ae=["value"],ne={class:"flex-1 md:flex-none"},de=["value"],re={class:"relative w-full md:w-64"},ue={class:"mt-4 overflow-x-auto"},ie={class:"min-w-full border bg-white rounded-lg shadow-md"},me={class:"bg-gray-200"},pe={key:0,class:"px-4 py-2 text-center"},ce={class:"px-4 py-2"},fe={class:"px-4 py-2"},_e={class:"px-4 py-2"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ke={class:"px-4 py-2"},ge={key:0,class:"px-4 py-2 text-center"},xe={class:"mb-4"},we={class:"mb-4"},he={class:"mb-4"},Ce=["value","disabled"],Ve={key:0},Ae={class:"mb-4"},Se=["disabled"],Te=["value","disabled"],Me={key:0},$e={class:"mb-4"},Ue={class:"flex space-x-4 mt-2"},De={class:"flex items-center"},Be={class:"flex items-center"},Fe={key:0,class:"mb-4"},Le=["value","disabled"],Pe={key:0},Ne={class:"flex justify-end mt-4"},qe={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(T){const V=T,f=v(q().props.settings),x=v(""),M=v(!1),w=v(!1),j=Array.from({length:6},(r,e)=>2025+e),J=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],$=v(new Date().getFullYear()),U=v(new Date().getMonth()+1),R=N(()=>V.incomes.filter(r=>{var h;const e=new Date(r.date),s=e.getFullYear()===$.value,_=e.getMonth()+1===U.value,S=r.source.name.toLowerCase().includes(x.value.toLowerCase())||((h=r.sub_source)==null?void 0:h.name.toLowerCase().includes(x.value.toLowerCase()))||r.payment.toLowerCase().includes(x.value.toLowerCase());return s&&_&&S})),o=z({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),Y=N(()=>V.subSources.filter(r=>r.source_id===o.source_id)),L=r=>r?new Intl.NumberFormat("id-ID").format(r.replace(/\D/g,"")):"";G(()=>{o.amount=L(String(o.amount))});const P=(r,e=null)=>{w.value=r==="edit",w.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),M.value=!0},A=()=>{o.reset(),M.value=!1},K=()=>{w.value?o.put(route("income.update",o.id),{onSuccess:()=>A()}):o.post(route("income.store"),{onSuccess:()=>A()})},O=r=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&Q.delete(route("income.destroy",r),{onSuccess:()=>{const e=V.incomes.findIndex(s=>s.id===r);e!==-1&&V.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(r,e)=>(a(),D(X,{title:"Income"},{default:p(()=>[t("div",ee,[t("div",se,[n(B,{onClick:e[0]||(e[0]=s=>P("create"))},{default:p(()=>e[14]||(e[14]=[i("Tambah Pemasukan")])),_:1}),t("div",te,[t("div",oe,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",le,[c(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>$.value=s),class:"block w-full border rounded-md p-2"},[(a(!0),d(b,null,y(l(j),s=>(a(),d("option",{key:s,value:s},u(s),9,ae))),128))],512),[[C,$.value]])]),t("div",ne,[c(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"block w-full border rounded-md p-2"},[(a(),d(b,null,y(J,(s,_)=>t("option",{key:_,value:_+1},u(s),9,de)),64))],512),[[C,U.value]])])]),t("div",re,[n(F,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=s=>x.value=s),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",ue,[t("table",ie,[t("thead",me,[t("tr",null,[e[17]||(e[17]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(a(),d("th",pe,"Aksi")):m("",!0)])]),t("tbody",null,[(a(!0),d(b,null,y(R.value,(s,_)=>{var S,h;return a(),d("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",ce,u(_+1),1),t("td",fe,u(s.date),1),t("td",_e,u(L(s.amount)),1),t("td",ve,u(s.source.name),1),t("td",be,u(((S=s.sub_source)==null?void 0:S.name)||"-"),1),t("td",ye,u(s.payment),1),t("td",ke,u(((h=s.account_bank)==null?void 0:h.name)||"-"),1),f.value.btn_edit||f.value.btn_delete?(a(),d("td",ge,[f.value.btn_edit?(a(),D(I,{key:0,onClick:W=>P("edit",s)},{default:p(()=>e[24]||(e[24]=[i("Edit")])),_:2},1032,["onClick"])):m("",!0),f.value.btn_delete?(a(),D(B,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:W=>O(s.id)},{default:p(()=>e[25]||(e[25]=[i("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),n(Z,{show:M.value,title:w.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:A},{content:p(()=>[t("form",{onSubmit:H(K,["prevent"])},[t("div",xe,[n(k,{for:"date",value:"Tanggal"}),n(F,{id:"date",type:"date",modelValue:l(o).date,"onUpdate:modelValue":e[4]||(e[4]=s=>l(o).date=s),class:"block w-full"},null,8,["modelValue"]),n(g,{message:l(o).errors.date},null,8,["message"])]),t("div",we,[n(k,{for:"amount",value:"Jumlah"}),n(F,{id:"amount",type:"number",modelValue:l(o).amount,"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).amount=s),class:"block w-full"},null,8,["modelValue"]),n(g,{message:l(o).errors.amount},null,8,["message"])]),t("div",he,[n(k,{for:"source_id",value:"Sumber"}),c(t("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=s=>l(o).source_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>l(o).sub_source_id=null)},[e[26]||(e[26]=t("option",{disabled:"",value:""},"Pilih Sumber",-1)),(a(!0),d(b,null,y(T.sources,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Ve,"(Tidak Aktif)"))],8,Ce))),128))],544),[[C,l(o).source_id]]),n(g,{message:l(o).errors.source_id},null,8,["message"])]),t("div",Ae,[n(k,{for:"sub_source_id",value:"Keterangan"}),c(t("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=s=>l(o).sub_source_id=s),class:"block w-full border rounded-md p-2",disabled:!l(o).source_id},[e[27]||(e[27]=t("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(a(!0),d(b,null,y(Y.value,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Me,"(Tidak Aktif)"))],8,Te))),128))],8,Se),[[C,l(o).sub_source_id]]),n(g,{message:l(o).errors.sub_source_id},null,8,["message"])]),t("div",$e,[n(k,{for:"payment",value:"Pembayaran"}),t("div",Ue,[t("label",De,[c(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>l(o).payment=s),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=s=>l(o).account_id="")},null,544),[[E,l(o).payment]]),e[28]||(e[28]=t("span",null,"Transfer",-1))]),t("label",Be,[c(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>l(o).payment=s),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=s=>l(o).account_id=null)},null,544),[[E,l(o).payment]]),e[29]||(e[29]=t("span",null,"Tunai",-1))])]),n(g,{message:l(o).errors.payment},null,8,["message"])]),l(o).payment==="Transfer"?(a(),d("div",Fe,[n(k,{for:"account_id",value:"Rekening Tujuan"}),c(t("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=s=>l(o).account_id=s),class:"block w-full border rounded-md p-2"},[e[30]||(e[30]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),(a(!0),d(b,null,y(T.accountBanks,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Pe,"(Tidak Aktif)"))],8,Le))),128))],512),[[C,l(o).account_id]]),n(g,{message:l(o).errors.account_id},null,8,["message"])])):m("",!0),t("div",Ne,[n(I,{type:"button",onClick:A},{default:p(()=>e[31]||(e[31]=[i("Batal")])),_:1}),n(B,{class:"ml-3",type:"submit"},{default:p(()=>[i(u(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{qe as default};

import{i as R,d as g,j as z,k as v,C as me,l as ce,m as ge,c as U,o as n,w as p,a as t,e as l,f as m,b as i,t as d,g as u,p as b,F as y,h as x,v as h,q as ve,u as r,s as G,W as Q}from"./app-B0a9Ua3q.js";import{A as _e}from"./AppLayout-DO1G94J6.js";import{_ as Y}from"./PrimaryButton-BDUwTsML.js";import{_ as X}from"./SecondaryButton-B-3XEnmc.js";import{_ as C}from"./InputLabel-Bq4RI5BU.js";import{_ as B}from"./TextInput-C013chdO.js";import{_ as V}from"./InputError-CnEDZPog.js";import{_ as fe}from"./CustomModal-CAwGa_Zu.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"p-4"},xe={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},ke={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},we={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},he={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},Ce={class:"flex items-center space-x-4 w-full md:w-auto"},Ve={class:"flex-1 md:flex-none"},Se=["value"],Ae={class:"flex-1 md:flex-none"},Te=["value"],$e={class:"relative w-full md:w-64"},Me={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Pe={class:"min-w-full"},De={class:"bg-gray-200"},Ue={key:0,class:"px-4 py-2 text-center"},Be={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Le={class:"px-4 py-2"},Ee={class:"px-4 py-2"},Fe={class:"px-4 py-2"},Ne={class:"px-4 py-2"},je={class:"px-4 py-2"},Ke={key:0,class:"px-4 py-2 text-center"},Re={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},Ye={class:"flex items-center space-x-4"},He={class:"text-sm text-gray-700"},Je={class:"flex items-center space-x-4"},qe=["disabled"],Oe={class:"text-sm text-gray-700"},We=["disabled"],ze={class:"mb-4"},Ge={class:"mb-4"},Qe=["value","disabled"],Xe={key:0},Ze={class:"mb-4"},et=["disabled"],tt=["value","disabled"],st={key:0},at={class:"mb-4"},ot={class:"mb-4"},nt={class:"flex space-x-4 mt-2"},lt={class:"flex items-center"},rt={key:0,class:"flex items-center"},dt={key:0,class:"mb-4"},it={label:"Rekening"},ut=["value","disabled"],pt={key:0},mt={key:0,label:"Saving (Tabungan)"},ct=["value","disabled"],gt={key:0},vt={class:"flex justify-end mt-4"},_t={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array,bills:Array,debts:Array},setup(I){const c=I;R();const k=g(""),L=g(!1),S=g(!1),_=g(R().props.settings),H=g(R().props.savingSubCategories),Z=g(Array.from({length:10},(o,e)=>new Date().getFullYear()-e)),ee=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],A=g(new Date().getFullYear()),T=g(new Date().getMonth()+1),f=g(1),$=g(10),te=()=>{const o={year:A.value,month:T.value};Q.get(route("expense.index"),o,{preserveState:!0,replace:!0})};z([A,T],()=>{te()});const E=v(()=>c.expenses.filter(o=>{var M;const e=new Date(o.date),s=e.getFullYear()===A.value,w=e.getMonth()+1===T.value,D=k.value?o.category.name.toLowerCase().includes(k.value.toLowerCase())||((M=o.sub_category)==null?void 0:M.name.toLowerCase().includes(k.value.toLowerCase()))||o.payment.toLowerCase().includes(k.value.toLowerCase()):!0;return s&&w&&D})),J=v(()=>{const o=(f.value-1)*$.value,e=o+$.value;return E.value.slice(o,e)}),F=v(()=>Math.ceil(E.value.length/$.value)),se=()=>{f.value<F.value&&f.value++},ae=()=>{f.value>1&&f.value--},a=me({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),oe=v(()=>c.subCategories.filter(o=>o.category_id===a.category_id)),N=o=>o?new Intl.NumberFormat("id-ID").format(o):"",ne=o=>o?o.replace(/\./g,""):"",j=v({get:()=>N(a.amount),set:o=>{a.amount=ne(o)}});ce(()=>{j.value=N(a.amount)});const q=v(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Saving (Tabungan)"}),le=v(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Bills (Tagihan)"}),re=v(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Debt (Hutang)"}),K=v(()=>{const o=c.categories.find(e=>e.id===a.category_id);return o&&o.name==="Loan (Pinjaman)"}),O=()=>{if(le.value&&a.sub_kategori_id){const o=c.bills.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Bill:",o),a.amount=o?o.amount:""}if(re.value&&a.sub_kategori_id){const o=c.debts.find(e=>e.sub_category_id===a.sub_kategori_id);console.log("Selected Debt:",o),a.amount=o?o.amount:""}},de=()=>{K.value&&(a.sub_kategori_id=null)};z(()=>a.sub_kategori_id,o=>{o&&O()});const W=(o,e=null)=>{S.value=o==="edit",S.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),L.value=!0},P=()=>{a.reset(),L.value=!1},ie=()=>{K.value&&(a.sub_kategori_id=a.sub_kategori_name),S.value?a.put(route("expense.update",a.id),{onSuccess:()=>P()}):a.post(route("expense.store"),{onSuccess:()=>P()})},ue=o=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&Q.delete(route("expense.destroy",o),{onSuccess:()=>{const e=c.expenses.findIndex(s=>s.id===o);e!==-1&&c.expenses.splice(e,1)},onError:()=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return ge(()=>{_.value.saving_expense&&console.log(H.value)}),(o,e)=>(n(),U(_e,{title:"Expenses"},{default:p(()=>[t("div",ye,[o.$page.props.flash.success?(n(),l("div",xe,d(o.$page.props.flash.success),1)):m("",!0),o.$page.props.flash.error?(n(),l("div",ke,d(o.$page.props.flash.error),1)):m("",!0),e[40]||(e[40]=t("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[t("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pengeluaran, termasuk kategori pengeluaran seperti tagihan, hutang, dan tabungan. ")],-1)),t("div",we,[i(Y,{onClick:e[0]||(e[0]=s=>W("create"))},{default:p(()=>e[15]||(e[15]=[u("Tambah Pengeluaran")])),_:1}),t("div",he,[t("div",Ce,[e[16]||(e[16]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",Ve,[b(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>A.value=s),class:"block w-full border rounded-md p-2"},[(n(!0),l(y,null,x(Z.value,s=>(n(),l("option",{key:s,value:s},d(s),9,Se))),128))],512),[[h,A.value]])]),t("div",Ae,[b(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>T.value=s),class:"block w-full border rounded-md p-2"},[(n(),l(y,null,x(ee,(s,w)=>t("option",{key:w,value:w+1},d(s),9,Te)),64))],512),[[h,T.value]])])]),t("div",$e,[i(B,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[17]||(e[17]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",Me,[t("table",Pe,[t("thead",De,[t("tr",null,[e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[24]||(e[24]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),_.value.btn_edit||_.value.btn_delete?(n(),l("th",Ue,"Aksi")):m("",!0)])]),t("tbody",null,[(n(!0),l(y,null,x(J.value,(s,w)=>{var D,M;return n(),l("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",Be,d(w+1),1),t("td",Ie,d(s.date),1),t("td",Le,d(N(s.amount)),1),t("td",Ee,d(s.category.name),1),t("td",Fe,d(((D=s.sub_category)==null?void 0:D.name)||"-"),1),t("td",Ne,d(s.payment),1),t("td",je,d(((M=s.account_bank)==null?void 0:M.name)||"-"),1),_.value.btn_edit||_.value.btn_delete?(n(),l("td",Ke,[_.value.btn_edit?(n(),U(X,{key:0,onClick:pe=>W("edit",s)},{default:p(()=>e[25]||(e[25]=[u("Edit")])),_:2},1032,["onClick"])):m("",!0),_.value.btn_delete?(n(),U(Y,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:pe=>ue(s.id)},{default:p(()=>e[26]||(e[26]=[u("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),t("div",Re,[t("div",Ye,[t("span",He,"Menampilkan "+d(J.value.length)+" dari "+d(E.value.length)+" data",1),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>$.value=s),class:"border rounded-md p-2 text-sm"},e[27]||(e[27]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),512),[[h,$.value]])]),t("div",Je,[t("button",{onClick:ae,disabled:f.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,qe),t("span",Oe,"Halaman "+d(f.value)+" dari "+d(F.value),1),t("button",{onClick:se,disabled:f.value===F.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,We)])]),i(fe,{show:L.value,title:S.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:P},{content:p(()=>[t("form",{onSubmit:ve(ie,["prevent"])},[t("div",ze,[i(C,{for:"date"},{default:p(()=>e[28]||(e[28]=[u(" Tanggal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(B,{id:"date",type:"date",modelValue:r(a).date,"onUpdate:modelValue":e[5]||(e[5]=s=>r(a).date=s),class:"block w-full"},null,8,["modelValue"]),i(V,{message:r(a).errors.date},null,8,["message"])]),t("div",Ge,[i(C,{for:"category_id"},{default:p(()=>e[29]||(e[29]=[u(" Kategori "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>r(a).category_id=s),class:"block w-full border rounded-md p-2",onChange:de},[e[30]||(e[30]=t("option",{disabled:"",value:""},"Pilih Kategori",-1)),(n(!0),l(y,null,x(I.categories,s=>(n(),l("option",{key:s.id,value:s.id,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",Xe,"(Tidak Aktif)"))],8,Qe))),128))],544),[[h,r(a).category_id]]),i(V,{message:r(a).errors.category_id},null,8,["message"])]),t("div",Ze,[i(C,{for:"sub_kategori_id"},{default:p(()=>e[31]||(e[31]=[u(" Keterangan "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),K.value?(n(),U(B,{key:0,id:"sub_kategori_id",type:"text",modelValue:r(a).sub_kategori_name,"onUpdate:modelValue":e[7]||(e[7]=s=>r(a).sub_kategori_name=s),class:"block w-full"},null,8,["modelValue"])):b((n(),l("select",{key:1,id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=s=>r(a).sub_kategori_id=s),class:"block w-full border rounded-md p-2",disabled:!r(a).category_id,onChange:O},[e[32]||(e[32]=t("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),l(y,null,x(oe.value,s=>(n(),l("option",{key:s.id,value:s.id,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",st,"(Tidak Aktif)"))],8,tt))),128))],40,et)),[[h,r(a).sub_kategori_id]]),i(V,{message:r(a).errors.sub_kategori_id},null,8,["message"])]),t("div",at,[i(C,{for:"amount"},{default:p(()=>e[33]||(e[33]=[u(" Nominal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(B,{id:"amount",type:"text",modelValue:j.value,"onUpdate:modelValue":e[9]||(e[9]=s=>j.value=s),onInput:o.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),i(V,{message:r(a).errors.amount},null,8,["message"])]),t("div",ot,[i(C,{for:"payment"},{default:p(()=>e[34]||(e[34]=[u(" Pembayaran "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),t("div",nt,[t("label",lt,[b(t("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=s=>r(a).payment=s),value:"Transfer",class:"mr-2",onChange:e[11]||(e[11]=s=>r(a).account_id="")},null,544),[[G,r(a).payment]]),e[35]||(e[35]=t("span",null,"Transfer",-1))]),q.value?m("",!0):(n(),l("label",rt,[b(t("input",{type:"radio","onUpdate:modelValue":e[12]||(e[12]=s=>r(a).payment=s),value:"Tunai",class:"mr-2",onChange:e[13]||(e[13]=s=>r(a).account_id=null)},null,544),[[G,r(a).payment]]),e[36]||(e[36]=t("span",null,"Tunai",-1))]))]),i(V,{message:r(a).errors.payment},null,8,["message"])]),r(a).payment==="Transfer"?(n(),l("div",dt,[i(C,{for:"account_id"},{default:p(()=>e[37]||(e[37]=[u(" Sumber Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(t("select",{id:"account_id","onUpdate:modelValue":e[14]||(e[14]=s=>r(a).account_id=s),class:"block w-full border rounded-md p-2",required:""},[e[38]||(e[38]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),t("optgroup",it,[(n(!0),l(y,null,x(I.accountBanks,s=>(n(),l("option",{key:s.id,value:`account_${s.id}`,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",pt,"(Tidak Aktif)"))],8,ut))),128))]),!q.value&&_.value.saving_expense?(n(),l("optgroup",mt,[(n(!0),l(y,null,x(H.value,s=>(n(),l("option",{key:s.id,value:`subcategory_${s.id}`,disabled:!s.is_active},[u(d(s.name)+" ",1),s.is_active?m("",!0):(n(),l("span",gt,"(Tidak Aktif)"))],8,ct))),128))])):m("",!0)],512),[[h,r(a).account_id]]),i(V,{message:r(a).errors.account_id},null,8,["message"])])):m("",!0),t("div",vt,[i(X,{type:"button",onClick:P},{default:p(()=>e[39]||(e[39]=[u("Batal")])),_:1}),i(Y,{class:"ml-3",type:"submit"},{default:p(()=>[u(d(S.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},St=be(_t,[["__scopeId","data-v-cd2edf1f"]]);export{St as default};

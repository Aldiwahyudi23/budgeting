import{E as _e,d as _,i as se,k as V,C as $,c as H,o as m,w as d,a as t,e as c,f as S,b as o,t as v,g as i,F as T,h as F,u as l,P as Ve,q as N,p as D,v as K,y as he,W as Ce}from"./app-CxSnI49r.js";import{A as Ae}from"./AppLayout-DC6qsIqF.js";import{_ as j}from"./CustomModal-DYkmDggW.js";import{_ as y}from"./PrimaryButton-D7UxiV5k.js";import{_ as h}from"./SecondaryButton-CG2pnUvN.js";import{_ as b}from"./InputLabel-DoM7Stot.js";import{_ as x}from"./TextInput-CeMwzNia.js";import{_ as k}from"./InputError-DsGhxeJI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ue={class:"p-4"},Be={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg"},Se={class:"flex items-center"},Te={key:1,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg"},Me={class:"flex items-center"},Ie={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},$e={class:"relative"},Fe={class:"mt-4 overflow-x-auto"},Ne={class:"min-w-full border bg-white rounded-lg shadow-md"},De={class:"bg-gray-300"},je={colspan:"5",class:"px-4 py-2 font-bold"},Pe={class:"px-4 py-2"},Le={class:"px-4 py-2"},Ee={class:"px-4 py-2"},We={class:"px-4 py-2 text-center"},Re={key:0,class:"px-2 py-1 text-green-700 bg-green-200 rounded-full text-sm"},ze={key:1,class:"px-2 py-1 text-red-700 bg-red-200 rounded-full text-sm"},Oe={class:"px-2 py-2 flex justify-end gap-2 sm:justify-start"},qe={class:"mt-6 bg-white p-4 rounded-lg shadow-md"},He={class:"flex items-center justify-between"},Ke={class:"flex items-center"},Qe={class:"ml-3"},Ye={class:"text-xl font-bold text-purple-600"},Ge={class:"mb-4"},Je={class:"mb-4"},Xe={class:"mb-4"},Ze={class:"mb-4"},et={class:"flex items-center mb-4"},tt={class:"flex justify-end mt-4"},st={class:"mb-4"},ot={class:"text-lg font-semibold"},nt={class:"mb-4"},lt={class:"mb-4"},at={class:"flex justify-end mt-4"},dt={class:"mb-4"},it=["value","disabled"],ut={key:0},rt={class:"mb-4"},mt={class:"mb-4"},pt={class:"flex justify-end mt-4"},ft={class:"mb-4"},ct={class:"mb-4"},vt={class:"mb-4"},bt={class:"mb-4"},kt=["value","disabled"],gt={class:"flex justify-end mt-4"},St={__name:"Index",props:{accountBanks:Array,cashBalance:Number},setup(Q){const r=_e([...Q.accountBanks]),P=_(!1),C=_(!1),L=_(""),E=_(!1),W=_(!1),R=_(!1),A=_(null),Y=_(se().props.settings);V(()=>r.filter(s=>s.name.toLowerCase().includes(L.value.toLowerCase())));const oe=V(()=>r.reduce((s,e)=>(s[e.type]||(s[e.type]=[]),s[e.type].push(e),s),{})),ne={bank:"🏦 Bank","e-wallet":"📱 E-Wallet","e-money":"💳 E-Money"},le={id:"",type:"",name:"",description:"",amount:"",is_active:!1,user_id:se().props.auth.user.id},a=$({...le}),w=s=>!s&&s!==0?"":new Intl.NumberFormat("id-ID").format(s),U=s=>s?String(s).replace(/\./g,""):"",G=V({get:()=>w(a.amount),set:s=>a.amount=U(s)}),ae=s=>{const e=String(s.target.value).replace(/\./g,"");a.amount=e},J=(s,e=null)=>{C.value=s==="edit",C.value&&e?(a.id=e.id,a.type=e.type,a.name=e.name,a.description=e.description,a.amount=e.amount||"",a.is_active=!!e.is_active):a.reset(),P.value=!0},M=()=>{a.reset(),P.value=!1},de=()=>{C.value?a.put(route("account-bank.update",a.id),{onSuccess:()=>{const s=r.findIndex(e=>e.id===a.id);s!==-1&&(r[s]={...a.data()}),M()}}):a.post(route("account-bank.store"),{onSuccess:s=>{r.unshift(s.props.accountBanks[0]),M()}})},ie=s=>{confirm("Apakah Anda yakin ingin menghapus rekening bank ini?")&&a.delete(route("account-bank.destroy",s),{onSuccess:()=>{const e=r.findIndex(n=>n.id===s);e!==-1&&r.splice(e,1)}})},g=$({amount:"",note:"",bank_id:null}),X=V({get:()=>w(g.amount),set:s=>g.amount=U(s)}),ue=s=>{const e=String(s.target.value).replace(/\./g,"");g.amount=e},re=s=>{A.value=s,g.bank_id=s.id,E.value=!0},z=()=>{g.reset(),E.value=!1},me=()=>{g.post(route("account-bank.withdraw"),{onSuccess:()=>{z();const s=r.findIndex(e=>e.id===A.value.id);s!==-1&&(r[s].amount-=parseFloat(g.amount))}})},p=$({amount:"",note:"",bank_id:null}),Z=V({get:()=>w(p.amount),set:s=>p.amount=U(s)}),pe=s=>{const e=String(s.target.value).replace(/\./g,"");p.amount=e},fe=()=>{W.value=!0},O=()=>{p.reset(),W.value=!1},ce=()=>{p.post(route("account-bank.deposit"),{onSuccess:()=>{O();const s=r.findIndex(e=>e.id===p.bank_id);s!==-1&&(r[s].amount+=parseFloat(p.amount))}})},ve=s=>{Ce.visit(route("account-bank.mutation",s))},u=$({amount:"",admin:"",note:"",bank_ex:null,bank_in:null}),ee=V({get:()=>w(u.amount),set:s=>u.amount=U(s)}),be=s=>{const e=String(s.target.value).replace(/\./g,"");u.amount=e},te=V({get:()=>w(u.admin),set:s=>u.admin=U(s)}),ke=s=>{const e=String(s.target.value).replace(/\./g,"");u.admin=e},ge=V(()=>r.filter(s=>s.type==="bank"||s.type==="e-wallet")),xe=s=>{A.value=s,u.bank_in=s.id,R.value=!0},q=()=>{u.reset(),R.value=!1},ye=()=>{u.post(route("account-bank.topUp"),{onSuccess:()=>{q();const s=r.findIndex(n=>n.id===u.bank_ex);s!==-1&&(r[s].amount-=parseFloat(u.amount));const e=r.findIndex(n=>n.id===u.bank_in);e!==-1&&(r[e].amount+=parseFloat(u.amount))}})};return(s,e)=>(m(),H(Ae,{title:"Account Bank"},{default:d(()=>[t("div",Ue,[s.$page.props.flash.success?(m(),c("div",Be,[t("div",Se,[e[16]||(e[16]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),t("p",null,v(s.$page.props.flash.success),1)])])):S("",!0),s.$page.props.flash.error?(m(),c("div",Te,[t("div",Me,[e[17]||(e[17]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",null,v(s.$page.props.flash.error),1)])])):S("",!0),t("div",Ie,[o(y,{onClick:e[0]||(e[0]=n=>J("create"))},{default:d(()=>e[18]||(e[18]=[i("Tambah Rekening Bank")])),_:1}),t("div",$e,[o(x,{modelValue:L.value,"onUpdate:modelValue":e[1]||(e[1]=n=>L.value=n),placeholder:"Cari Rekening Bank...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[19]||(e[19]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),t("div",Fe,[t("table",Ne,[e[24]||(e[24]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"No"),t("th",{class:"px-4 py-2 text-left"},"Nama"),t("th",{class:"px-4 py-2 text-left"},"Nominal"),t("th",{class:"px-4 py-2 text-center"},"Status"),t("th",{class:"px-4 py-2 text-center"},"Aksi")])],-1)),t("tbody",null,[(m(!0),c(T,null,F(oe.value,(n,B)=>(m(),c(T,{key:B},[t("tr",De,[t("td",je,v(ne[B]),1)]),(m(!0),c(T,null,F(n,(f,we)=>(m(),c("tr",{key:f.id,class:"border-b hover:bg-gray-100"},[t("td",Pe,v(we+1),1),t("td",Le,v(f.name),1),t("td",Ee,v(w(f.amount)),1),t("td",We,[f.is_active?(m(),c("span",Re,"Aktif")):(m(),c("span",ze,"Tidak Aktif"))]),t("td",Oe,[Y.value.btn_edit?(m(),H(h,{key:0,onClick:I=>J("edit",f)},{default:d(()=>e[20]||(e[20]=[i("Edit")])),_:2},1032,["onClick"])):S("",!0),o(h,{class:"bg-yellow-400 hover:bg-yellow-500",onClick:I=>xe(f)},{default:d(()=>[i(v(f.type==="bank"?"Deposit":"Top Up"),1)]),_:2},1032,["onClick"]),o(y,{class:"bg-blue-600 hover:bg-blue-700",onClick:I=>ve(f.id)},{default:d(()=>e[21]||(e[21]=[i("Mutasi")])),_:2},1032,["onClick"]),o(y,{class:"bg-green-600 hover:bg-green-700",onClick:I=>re(f)},{default:d(()=>e[22]||(e[22]=[i("Tarik Tunai")])),_:2},1032,["onClick"]),Y.value.btn_delete?(m(),H(y,{key:1,class:"bg-red-600 hover:bg-red-700",onClick:I=>ie(f.id)},{default:d(()=>e[23]||(e[23]=[i("Hapus")])),_:2},1032,["onClick"])):S("",!0)])]))),128))],64))),128))])])]),t("div",qe,[t("div",He,[t("div",Ke,[e[27]||(e[27]=t("div",{class:"bg-purple-100 p-2 rounded-full"},[t("svg",{class:"w-5 h-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Qe,[e[26]||(e[26]=t("h2",{class:"text-base font-semibold"},"Saldo Cash",-1)),t("p",Ye,v(w(Q.cashBalance)),1),o(l(Ve),{href:s.route("debits.index"),class:"text-xs text-gray-500 hover:text-purple-600"},{default:d(()=>e[25]||(e[25]=[i("Klik untuk melihat detail mutasi")])),_:1},8,["href"])])]),o(y,{class:"bg-green-600 hover:bg-green-700",onClick:fe},{default:d(()=>e[28]||(e[28]=[i("Setor Tunai")])),_:1})])]),o(j,{show:P.value,title:C.value?"Edit Rekening":"Tambah Rekening",onClose:M},{content:d(()=>[t("form",{onSubmit:N(de,["prevent"])},[t("div",Ge,[o(b,{for:"type"},{default:d(()=>e[29]||(e[29]=[i(" Tipe Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),D(t("select",{id:"type","onUpdate:modelValue":e[2]||(e[2]=n=>l(a).type=n),class:"block w-full border-gray-300 rounded-md shadow-sm"},e[30]||(e[30]=[t("option",{value:""},"-- Pilih Tipe --",-1),t("option",{value:"bank"},"Bank",-1),t("option",{value:"e-wallet"},"E-Wallet",-1),t("option",{value:"e-money"},"E-Money",-1)]),512),[[K,l(a).type]]),o(k,{message:l(a).errors.type},null,8,["message"])]),t("div",Je,[o(b,{for:"name"},{default:d(()=>e[31]||(e[31]=[i(" Nama Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"name",modelValue:l(a).name,"onUpdate:modelValue":e[3]||(e[3]=n=>l(a).name=n),class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(a).errors.name},null,8,["message"])]),t("div",Xe,[o(b,{for:"description",value:"Deskripsi"}),o(x,{id:"description",modelValue:l(a).description,"onUpdate:modelValue":e[4]||(e[4]=n=>l(a).description=n),class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(a).errors.description},null,8,["message"])]),t("div",Ze,[o(b,{for:"amount",value:"Nominal"}),o(x,{id:"amount",type:"text",modelValue:G.value,"onUpdate:modelValue":e[5]||(e[5]=n=>G.value=n),onInput:ae,class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(a).errors.amount},null,8,["message"])]),t("div",et,[D(t("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":e[6]||(e[6]=n=>l(a).is_active=n),class:"mr-2"},null,512),[[he,l(a).is_active]]),e[32]||(e[32]=t("label",{for:"is_active"},"Aktif",-1))]),t("div",tt,[o(h,{type:"button",onClick:M},{default:d(()=>e[33]||(e[33]=[i("Batal")])),_:1}),o(y,{class:"ml-3",type:"submit"},{default:d(()=>[i(v(C.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"]),o(j,{show:E.value,title:"Tarik Tunai ",onClose:z},{content:d(()=>{var n,B;return[t("form",{onSubmit:N(me,["prevent"])},[t("div",st,[t("h2",ot,v((n=A.value)==null?void 0:n.name)+" "+v(w((B=A.value)==null?void 0:B.amount)),1)]),t("div",nt,[o(b,{for:"withdrawAmount"},{default:d(()=>e[34]||(e[34]=[i(" Nominal Yang Ditarik "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"withdrawAmount",type:"text",modelValue:X.value,"onUpdate:modelValue":e[7]||(e[7]=f=>X.value=f),onInput:ue,class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(g).errors.amount},null,8,["message"])]),t("div",lt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:l(g).note,"onUpdate:modelValue":e[8]||(e[8]=f=>l(g).note=f),class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(g).errors.note},null,8,["message"])]),t("div",at,[o(h,{type:"button",onClick:z},{default:d(()=>e[35]||(e[35]=[i("Batal")])),_:1}),o(y,{class:"ml-3",type:"submit"},{default:d(()=>e[36]||(e[36]=[i("Tarik/Pindah ke Cash")])),_:1})])],32)]}),_:1},8,["show"]),o(j,{show:W.value,title:"Setor Tunai",onClose:O},{content:d(()=>[t("form",{onSubmit:N(ce,["prevent"])},[t("div",dt,[o(b,{for:"bank_id"},{default:d(()=>e[37]||(e[37]=[i(" Pilih Bank Tujuan "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),D(t("select",{id:"bank_id","onUpdate:modelValue":e[9]||(e[9]=n=>l(p).bank_id=n),class:"block w-full border rounded-md p-2"},[e[38]||(e[38]=t("option",{disabled:"",value:""},"Pilih Bank",-1)),(m(!0),c(T,null,F(r,n=>(m(),c("option",{key:n.id,value:n.id,disabled:!n.is_active},[i(v(n.name)+" ",1),n.is_active?S("",!0):(m(),c("span",ut,"(Tidak Aktif)"))],8,it))),128))],512),[[K,l(p).bank_id]]),o(k,{message:l(p).errors.bank_id},null,8,["message"])]),t("div",rt,[o(b,{for:"depositAmount"},{default:d(()=>e[39]||(e[39]=[i(" Nominal Setor Tunai "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"depositAmount",type:"text",modelValue:Z.value,"onUpdate:modelValue":e[10]||(e[10]=n=>Z.value=n),onInput:pe,class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(p).errors.amount},null,8,["message"])]),t("div",mt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:l(p).note,"onUpdate:modelValue":e[11]||(e[11]=n=>l(p).note=n),class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(p).errors.note},null,8,["message"])]),t("div",pt,[o(h,{type:"button",onClick:O},{default:d(()=>e[40]||(e[40]=[i("Batal")])),_:1}),o(y,{class:"ml-3",type:"submit"},{default:d(()=>e[41]||(e[41]=[i("Setor/Pindah ke Bank")])),_:1})])],32)]),_:1},8,["show"]),o(j,{show:R.value,title:"Top UP",onClose:q},{content:d(()=>[t("form",{onSubmit:N(ye,["prevent"])},[t("div",ft,[o(b,{for:"topUpAmount"},{default:d(()=>e[42]||(e[42]=[i(" Nominal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"topUpAmount",type:"text",modelValue:ee.value,"onUpdate:modelValue":e[12]||(e[12]=n=>ee.value=n),onInput:be,class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(u).errors.amount},null,8,["message"])]),t("div",ct,[o(b,{for:"admin"},{default:d(()=>e[43]||(e[43]=[i(" Admin ")])),_:1}),o(x,{id:"admin",type:"text",modelValue:te.value,"onUpdate:modelValue":e[13]||(e[13]=n=>te.value=n),onInput:ke,class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(u).errors.admin},null,8,["message"])]),t("div",vt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:l(u).note,"onUpdate:modelValue":e[14]||(e[14]=n=>l(u).note=n),class:"block w-full"},null,8,["modelValue"]),o(k,{message:l(u).errors.note},null,8,["message"])]),t("div",bt,[o(b,{for:"bank_ex"},{default:d(()=>e[44]||(e[44]=[i(" Pilih Rekening Sumber "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),D(t("select",{id:"bank_ex","onUpdate:modelValue":e[15]||(e[15]=n=>l(u).bank_ex=n),class:"block w-full border rounded-md p-2"},[e[45]||(e[45]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),(m(!0),c(T,null,F(ge.value,n=>(m(),c("option",{key:n.id,value:n.id,disabled:n.id===l(u).bank_in},v(n.name),9,kt))),128))],512),[[K,l(u).bank_ex]]),o(k,{message:l(u).errors.bank_ex},null,8,["message"])]),t("div",gt,[o(h,{type:"button",onClick:q},{default:d(()=>e[46]||(e[46]=[i("Batal")])),_:1}),o(y,{class:"ml-3",type:"submit"},{default:d(()=>e[47]||(e[47]=[i("Setor/Pindah ke Bank")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{St as default};

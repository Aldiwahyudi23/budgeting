import{d as v,i as H,j as D,C as Q,k as X,c as F,o as n,w as i,a as s,b as d,g as u,p as c,e as r,F as b,h as y,u as l,t as m,v as V,f as p,q as Z,s as E,W as ee}from"./app-DlL2FaVv.js";import{A as te}from"./AppLayout-BVtQ3Tdl.js";import{_ as I}from"./PrimaryButton-B3yNxGFP.js";import{_ as j}from"./SecondaryButton-DPh6o6u4.js";import{_ as x}from"./InputLabel-D6yFg52V.js";import{_ as L}from"./TextInput-BmoaKNwa.js";import{_ as g}from"./InputError-B0XhVs_9.js";import{_ as se}from"./CustomModal-Cybzp7ur.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"p-4"},le={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ae={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},ne={class:"flex items-center space-x-4 w-full md:w-auto"},de={class:"flex-1 md:flex-none"},re=["value"],ue={class:"flex-1 md:flex-none"},ie=["value"],me={class:"relative w-full md:w-64"},pe={class:"mt-4 overflow-x-auto"},ce={class:"min-w-full border bg-white rounded-lg shadow-md"},fe={class:"bg-gray-200"},_e={key:0,class:"px-4 py-2 text-center"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},xe={class:"px-4 py-2"},ge={class:"px-4 py-2"},ke={class:"px-4 py-2"},we={class:"px-4 py-2"},Ce={key:0,class:"px-4 py-2 text-center"},Ve={class:"mb-4"},Ae={class:"mb-4"},Te={class:"mb-4"},Me=["value","disabled"],Se={key:0},he={class:"mb-4"},$e=["disabled"],Ue=["value","disabled"],Ne={key:0},Be={class:"mb-4"},De={class:"flex space-x-4 mt-2"},Fe={class:"flex items-center"},Ie={class:"flex items-center"},Le={key:0,class:"mb-4"},Pe=["value","disabled"],Ee={key:0},je={class:"flex justify-end mt-4"},He={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(S){const A=S,f=v(H().props.settings),k=v(""),h=v(!1),w=v(!1),R=Array.from({length:6},(a,e)=>2025+e),Y=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],$=v(new Date().getFullYear()),U=v(new Date().getMonth()+1),J=D(()=>A.incomes.filter(a=>{var C;const e=new Date(a.date),t=e.getFullYear()===$.value,_=e.getMonth()+1===U.value,M=a.source.name.toLowerCase().includes(k.value.toLowerCase())||((C=a.sub_source)==null?void 0:C.name.toLowerCase().includes(k.value.toLowerCase()))||a.payment.toLowerCase().includes(k.value.toLowerCase());return t&&_&&M})),o=Q({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),K=D(()=>A.subSources.filter(a=>a.source_id===o.source_id)),N=a=>a?new Intl.NumberFormat("id-ID").format(a):"",q=a=>a?a.replace(/\./g,""):"",B=D({get:()=>N(o.amount),set:a=>{o.amount=q(a)}}),O=a=>{const e=a.target.value.replace(/\./g,"");o.amount=e};X(()=>{B.value=N(o.amount)});const P=(a,e=null)=>{w.value=a==="edit",w.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),h.value=!0},T=()=>{o.reset(),h.value=!1},W=()=>{w.value?o.put(route("income.update",o.id),{onSuccess:()=>T()}):o.post(route("income.store"),{onSuccess:()=>T()})},z=a=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&ee.delete(route("income.destroy",a),{onSuccess:()=>{const e=A.incomes.findIndex(t=>t.id===a);e!==-1&&A.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(a,e)=>(n(),F(te,{title:"Income"},{default:i(()=>[s("div",oe,[s("div",le,[d(I,{onClick:e[0]||(e[0]=t=>P("create"))},{default:i(()=>e[14]||(e[14]=[u("Tambah Pemasukan")])),_:1}),s("div",ae,[s("div",ne,[e[15]||(e[15]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",de,[c(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>$.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),r(b,null,y(l(R),t=>(n(),r("option",{key:t,value:t},m(t),9,re))),128))],512),[[V,$.value]])]),s("div",ue,[c(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),class:"block w-full border rounded-md p-2"},[(n(),r(b,null,y(Y,(t,_)=>s("option",{key:_,value:_+1},m(t),9,ie)),64))],512),[[V,U.value]])])]),s("div",me,[d(L,{modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=t=>k.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",pe,[s("table",ce,[s("thead",fe,[s("tr",null,[e[17]||(e[17]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(n(),r("th",_e,"Aksi")):p("",!0)])]),s("tbody",null,[(n(!0),r(b,null,y(J.value,(t,_)=>{var M,C;return n(),r("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",ve,m(_+1),1),s("td",be,m(t.date),1),s("td",ye,m(N(t.amount)),1),s("td",xe,m(t.source.name),1),s("td",ge,m(((M=t.sub_source)==null?void 0:M.name)||"-"),1),s("td",ke,m(t.payment),1),s("td",we,m(((C=t.account_bank)==null?void 0:C.name)||"-"),1),f.value.btn_edit||f.value.btn_delete?(n(),r("td",Ce,[f.value.btn_edit?(n(),F(j,{key:0,onClick:G=>P("edit",t)},{default:i(()=>e[24]||(e[24]=[u("Edit")])),_:2},1032,["onClick"])):p("",!0),f.value.btn_delete?(n(),F(I,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:G=>z(t.id)},{default:i(()=>e[25]||(e[25]=[u("Hapus")])),_:2},1032,["onClick"])):p("",!0)])):p("",!0)])}),128))])])]),d(se,{show:h.value,title:w.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:T},{content:i(()=>[s("form",{onSubmit:Z(W,["prevent"])},[s("div",Ve,[d(x,{for:"date"},{default:i(()=>e[26]||(e[26]=[u(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),d(L,{id:"date",type:"date",modelValue:l(o).date,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).date=t),class:"block w-full"},null,8,["modelValue"]),d(g,{message:l(o).errors.date},null,8,["message"])]),s("div",Ae,[d(x,{for:"amount"},{default:i(()=>e[27]||(e[27]=[u(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),d(L,{id:"amount",type:"text",modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=t=>B.value=t),onInput:O,class:"block w-full"},null,8,["modelValue"]),d(g,{message:l(o).errors.amount},null,8,["message"])]),s("div",Te,[d(x,{for:"source_id"},{default:i(()=>e[28]||(e[28]=[u(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),c(s("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=t=>l(o).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=t=>l(o).sub_source_id=null)},[e[29]||(e[29]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),r(b,null,y(S.sources,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",Se,"(Tidak Aktif)"))],8,Me))),128))],544),[[V,l(o).source_id]]),d(g,{message:l(o).errors.source_id},null,8,["message"])]),s("div",he,[d(x,{for:"sub_source_id"},{default:i(()=>e[30]||(e[30]=[u(" Keterangan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),c(s("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=t=>l(o).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!l(o).source_id},[e[31]||(e[31]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),r(b,null,y(K.value,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",Ne,"(Tidak Aktif)"))],8,Ue))),128))],8,$e),[[V,l(o).sub_source_id]]),d(g,{message:l(o).errors.sub_source_id},null,8,["message"])]),s("div",Be,[d(x,{for:"payment"},{default:i(()=>e[32]||(e[32]=[u(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",De,[s("label",Fe,[c(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>l(o).payment=t),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=t=>l(o).account_id="")},null,544),[[E,l(o).payment]]),e[33]||(e[33]=s("span",null,"Transfer",-1))]),s("label",Ie,[c(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>l(o).payment=t),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=t=>l(o).account_id=null)},null,544),[[E,l(o).payment]]),e[34]||(e[34]=s("span",null,"Tunai",-1))])]),d(g,{message:l(o).errors.payment},null,8,["message"])]),l(o).payment==="Transfer"?(n(),r("div",Le,[d(x,{for:"account_id"},{default:i(()=>e[35]||(e[35]=[u(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),c(s("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=t=>l(o).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[36]||(e[36]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),r(b,null,y(S.accountBanks,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),r("span",Ee,"(Tidak Aktif)"))],8,Pe))),128))],512),[[V,l(o).account_id]]),d(g,{message:l(o).errors.account_id},null,8,["message"])])):p("",!0),s("div",je,[d(j,{type:"button",onClick:T},{default:i(()=>e[37]||(e[37]=[u("Batal")])),_:1}),d(I,{class:"ml-3",type:"submit"},{default:i(()=>[u(m(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{He as default};

import{i as N,d as p,j as _,C as X,c as M,o as r,w as c,a as t,e as u,f as b,b as l,t as d,g as x,F as V,h as S,n as Y,l as A,v as D,m as Z,u as n,W as ee}from"./app-CJTkIsh8.js";import{A as te}from"./AppLayout-BTzH0TsC.js";import{_ as se}from"./CustomModal-C3D9uZAG.js";import{_ as L}from"./PrimaryButton-CSG76sdM.js";import{_ as E}from"./SecondaryButton-BGgm2aAA.js";import{_ as w}from"./InputLabel-Bee8JMEO.js";import{_ as T}from"./TextInput-DGRGyfDU.js";import{_ as k}from"./InputError-CR3DMQms.js";import{h as ae}from"./sweetalert-6sYXArrz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"p-4"},le={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},ne={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},re={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},de={class:"relative"},ue={class:"mb-2"},ie={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},pe={class:"text-gray-700 font-medium"},ce={class:"mt-4 overflow-x-auto"},ge={class:"min-w-full border bg-white rounded-lg shadow-md"},me={class:"bg-gray-200"},ve={key:0,class:"px-4 py-2 text-center"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},fe={class:"px-4 py-2"},_e={class:"px-4 py-2"},xe={class:"px-4 py-2 text-green-600"},we={class:"px-4 py-2 text-red-600"},ke={class:"px-4 py-2"},he={key:0,class:"px-4 py-2 text-center"},Ce={class:"flex justify-between items-center mt-4"},Ve={class:"flex items-center space-x-2"},Se={class:"flex space-x-2"},Te=["disabled"],$e=["disabled"],Me={class:"mb-4"},Ae={class:"mb-4"},De={class:"mb-4"},Le={class:"mb-4"},Ue=["value"],je={class:"mb-4"},Be=["disabled"],Fe=["value"],Pe={class:"flex justify-end mt-4"},Re={__name:"Index",props:{savings:Array,categories:Array,subCategories:Array},setup(U){const j=N();console.log(j.props.flash),ae(j);const g=U,m=p(N().props.settings),y=p(""),$=p(!1),f=p(!1),i=p(1),v=p(10);p("");const B=_(()=>g.savings.filter(o=>{var e;return o.category.name.toLowerCase().includes(y.value.toLowerCase())||((e=o.sub_category)==null?void 0:e.name.toLowerCase().includes(y.value.toLowerCase()))||o.note.toLowerCase().includes(y.value.toLowerCase())})),K=()=>{const o=g.categories.find(e=>e.name==="Saving");return o?o.id:null},q=_(()=>g.subCategories.filter(o=>o.category_id===a.category_id)),z=_(()=>{const o=(i.value-1)*v.value,e=o+v.value;return B.value.slice(o,e)}),F=_(()=>Math.ceil(B.value.length/v.value)),O=()=>{i.value<F.value&&i.value++},W=()=>{i.value>1&&i.value--},H=_(()=>{const o={};return g.savings.forEach(e=>{var s;(!o[e.sub_category_id]||new Date(e.date)>new Date(o[e.sub_category_id].date))&&(o[e.sub_category_id]={id:e.sub_category_id,name:((s=e.sub_category)==null?void 0:s.name)||"Tanpa Sub Kategori",balance:e.balance,date:e.date})}),Object.values(o)}),h=o=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(o||0),a=X({...{id:"",date:"",amount:0,note:"",category_id:"",sub_category_id:null}}),P=(o,e=null)=>{f.value=o==="edit",f.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.note=e.note,a.category_id=e.category_id,a.sub_category_id=e.sub_category_id):(a.reset(),a.category_id=K()),$.value=!0},C=()=>{a.reset(),$.value=!1},J=()=>{f.value?a.put(route("savings.update",a.id),{onSuccess:()=>C()}):a.post(route("savings.store"),{onSuccess:()=>C()})},Q=o=>{confirm("Apakah Anda yakin ingin menghapus tabungan ini?")&&ee.delete(route("savings.destroy",o),{onSuccess:()=>{const e=g.savings.findIndex(s=>s.id===o);e!==-1&&g.savings.splice(e,1)}})};return(o,e)=>(r(),M(te,{title:"Saving"},{default:c(()=>[t("div",oe,[o.$page.props.flash.success?(r(),u("div",le,d(o.$page.props.flash.success),1)):b("",!0),o.$page.props.flash.error?(r(),u("div",ne,d(o.$page.props.flash.error),1)):b("",!0),t("div",re,[l(L,{onClick:e[0]||(e[0]=s=>P("create"))},{default:c(()=>e[9]||(e[9]=[x("Tambah Tabungan")])),_:1}),t("div",de,[l(T,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=s=>y.value=s),placeholder:"Cari Tabungan...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[10]||(e[10]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),t("div",ue,[t("div",ie,[(r(!0),u(V,null,S(H.value,s=>(r(),u("div",{key:s.id,class:"bg-white p-4 rounded-lg shadow-md"},[t("h3",pe,d(s.name),1),t("p",{class:Y(["text-2xl font-bold",s.balance<0?"text-red-600":"text-green-600"])},d(h(s.balance)),3)]))),128))])]),t("div",ce,[t("table",ge,[t("thead",me,[t("tr",null,[e[11]||(e[11]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[12]||(e[12]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[13]||(e[13]=t("th",{class:"px-4 py-2 text-left"},"Sub Kategori",-1)),e[14]||(e[14]=t("th",{class:"px-4 py-2 text-left"},"Catatan",-1)),e[15]||(e[15]=t("th",{class:"px-4 py-2 text-left"},"Masuk",-1)),e[16]||(e[16]=t("th",{class:"px-4 py-2 text-left"},"Keluar",-1)),e[17]||(e[17]=t("th",{class:"px-4 py-2 text-left"},"Saldo",-1)),m.value.btn_edit||m.value.btn_delete?(r(),u("th",ve,"Aksi")):b("",!0)])]),t("tbody",null,[(r(!0),u(V,null,S(z.value,(s,R)=>{var I;return r(),u("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",be,d((i.value-1)*v.value+R+1),1),t("td",ye,d(s.date),1),t("td",fe,d(((I=s.sub_category)==null?void 0:I.name)||"-"),1),t("td",_e,d(s.note||"-"),1),t("td",xe,d(s.amount>0?h(s.amount):"-"),1),t("td",we,d(s.amount<0?h(Math.abs(s.amount)):"-"),1),t("td",ke,d(h(s.balance)),1),m.value.btn_edit||m.value.btn_delete?(r(),u("td",he,[m.value.btn_edit?(r(),M(E,{key:0,onClick:G=>P("edit",s)},{default:c(()=>e[18]||(e[18]=[x("Edit")])),_:2},1032,["onClick"])):b("",!0),m.value.btn_delete?(r(),M(L,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:G=>Q(s.id)},{default:c(()=>e[19]||(e[19]=[x("Hapus")])),_:2},1032,["onClick"])):b("",!0)])):b("",!0)])}),128))])])]),t("div",Ce,[t("div",Ve,[e[21]||(e[21]=t("span",{class:"text-sm text-gray-700"},"Menampilkan",-1)),A(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>v.value=s),class:"border rounded-md p-1 text-sm"},e[20]||(e[20]=[t("option",{value:"10"},"10",-1),t("option",{value:"25"},"25",-1),t("option",{value:"50"},"50",-1),t("option",{value:"100"},"100",-1)]),512),[[D,v.value]]),e[22]||(e[22]=t("span",{class:"text-sm text-gray-700"},"data per halaman",-1))]),t("div",Se,[t("button",{onClick:W,disabled:i.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," Sebelumnya ",8,Te),t("button",{onClick:O,disabled:i.value===F.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," Selanjutnya ",8,$e)])]),l(se,{show:$.value,title:f.value?"Edit Tabungan":"Tambah Tabungan",onClose:C},{content:c(()=>[t("form",{onSubmit:Z(J,["prevent"])},[t("div",Me,[l(w,{for:"date",value:"Tanggal"}),l(T,{id:"date",type:"date",modelValue:n(a).date,"onUpdate:modelValue":e[3]||(e[3]=s=>n(a).date=s),class:"block w-full",required:""},null,8,["modelValue"]),l(k,{message:n(a).errors.date},null,8,["message"])]),t("div",Ae,[l(w,{for:"amount",value:"Jumlah"}),l(T,{id:"amount",type:"number",modelValue:n(a).amount,"onUpdate:modelValue":e[4]||(e[4]=s=>n(a).amount=s),class:"block w-full",required:""},null,8,["modelValue"]),l(k,{message:n(a).errors.amount},null,8,["message"])]),t("div",De,[l(w,{for:"note",value:"Catatan"}),l(T,{id:"note",modelValue:n(a).note,"onUpdate:modelValue":e[5]||(e[5]=s=>n(a).note=s),class:"block w-full"},null,8,["modelValue"]),l(k,{message:n(a).errors.note},null,8,["message"])]),t("div",Le,[l(w,{for:"category_id",value:"Tabungan"}),A(t("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=s=>n(a).category_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>n(a).sub_category_id=null)},[e[23]||(e[23]=t("option",{value:""},"Pilih Tabungan",-1)),(r(!0),u(V,null,S(U.categories,s=>(r(),u("option",{key:s.id,value:s.id},d(s.name),9,Ue))),128))],544),[[D,n(a).category_id]]),l(k,{message:n(a).errors.category_id},null,8,["message"])]),t("div",je,[l(w,{for:"sub_category_id",value:"Data Tabungan"}),A(t("select",{id:"sub_category_id","onUpdate:modelValue":e[8]||(e[8]=s=>n(a).sub_category_id=s),class:"block w-full border rounded-md p-2",disabled:!n(a).category_id},[e[24]||(e[24]=t("option",{value:""},"Pilih Data Tabungan",-1)),(r(!0),u(V,null,S(q.value,s=>(r(),u("option",{key:s.id,value:s.id},d(s.name),9,Fe))),128))],8,Be),[[D,n(a).sub_category_id]]),l(k,{message:n(a).errors.sub_category_id},null,8,["message"])]),t("div",Pe,[l(E,{type:"button",onClick:C},{default:c(()=>e[25]||(e[25]=[x("Batal")])),_:1}),l(L,{class:"ml-3",type:"submit"},{default:c(()=>[x(d(f.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{Re as default};

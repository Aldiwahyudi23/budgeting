import{d as v,i as H,j as F,C as Q,k as X,c as I,o as n,w as p,a as s,b as d,g as i,p as c,e as r,F as b,h as y,u as l,t as u,v as C,f as m,q as Z,s as E,W as ee}from"./app-TmrfSb3x.js";import{A as te}from"./AppLayout-7w71YRRM.js";import{_ as L}from"./PrimaryButton-BYL_k8AT.js";import{_ as j}from"./SecondaryButton-D9UdVSlF.js";import{_ as g}from"./InputLabel-CTPtoiEh.js";import{_ as P}from"./TextInput-mP6luwjN.js";import{_ as k}from"./InputError-C9WnNx8b.js";import{_ as se}from"./CustomModal-BcH10ZXL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"p-4"},le={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ae={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},ne={class:"flex items-center space-x-4 w-full md:w-auto"},de={class:"flex-1 md:flex-none"},re=["value"],ue={class:"flex-1 md:flex-none"},ie=["value"],me={class:"relative w-full md:w-64"},pe={class:"mt-4 overflow-x-auto"},ce={class:"min-w-full border bg-white rounded-lg shadow-md"},fe={class:"bg-gray-200"},_e={key:0,class:"px-4 py-2 text-center"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ge={class:"px-4 py-2"},ke={class:"px-4 py-2"},xe={class:"px-4 py-2"},we={class:"px-4 py-2"},he={key:0,class:"px-4 py-2 text-center"},Ce={class:"mb-4"},Ve={class:"mb-4"},Ae={class:"mb-4"},Te=["value","disabled"],Me={key:0},Se={class:"mb-4"},$e=["disabled"],Ue=["value","disabled"],Be={key:0},De={class:"mb-4"},Fe={class:"flex space-x-4 mt-2"},Ie={class:"flex items-center"},Le={class:"flex items-center"},Pe={key:0,class:"mb-4"},Ne=["value","disabled"],Ee={key:0},je={class:"flex justify-end mt-4"},He={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(M){const V=M,f=v(H().props.settings),x=v(""),S=v(!1),w=v(!1),J=Array.from({length:6},(a,e)=>2025+e),R=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],$=v(new Date().getFullYear()),U=v(new Date().getMonth()+1),Y=F(()=>V.incomes.filter(a=>{var h;const e=new Date(a.date),t=e.getFullYear()===$.value,_=e.getMonth()+1===U.value,T=a.source.name.toLowerCase().includes(x.value.toLowerCase())||((h=a.sub_source)==null?void 0:h.name.toLowerCase().includes(x.value.toLowerCase()))||a.payment.toLowerCase().includes(x.value.toLowerCase());return t&&_&&T})),o=Q({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),K=F(()=>V.subSources.filter(a=>a.source_id===o.source_id)),B=a=>a?new Intl.NumberFormat("id-ID").format(a):"",O=a=>a?a.replace(/\./g,""):"",D=F({get:()=>B(o.amount),set:a=>{o.amount=O(a)}}),W=a=>{const e=a.target.value.replace(/\./g,"");o.amount=e};X(()=>{D.value=B(o.amount)});const N=(a,e=null)=>{w.value=a==="edit",w.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),S.value=!0},A=()=>{o.reset(),S.value=!1},q=()=>{w.value?o.put(route("income.update",o.id),{onSuccess:()=>A()}):o.post(route("income.store"),{onSuccess:()=>A()})},z=a=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&ee.delete(route("income.destroy",a),{onSuccess:()=>{const e=V.incomes.findIndex(t=>t.id===a);e!==-1&&V.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(a,e)=>(n(),I(te,{title:"Income"},{default:p(()=>[s("div",oe,[s("div",le,[d(L,{onClick:e[0]||(e[0]=t=>N("create"))},{default:p(()=>e[14]||(e[14]=[i("Tambah Pemasukan")])),_:1}),s("div",ae,[s("div",ne,[e[15]||(e[15]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",de,[c(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>$.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),r(b,null,y(l(J),t=>(n(),r("option",{key:t,value:t},u(t),9,re))),128))],512),[[C,$.value]])]),s("div",ue,[c(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),class:"block w-full border rounded-md p-2"},[(n(),r(b,null,y(R,(t,_)=>s("option",{key:_,value:_+1},u(t),9,ie)),64))],512),[[C,U.value]])])]),s("div",me,[d(P,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=t=>x.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",pe,[s("table",ce,[s("thead",fe,[s("tr",null,[e[17]||(e[17]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(n(),r("th",_e,"Aksi")):m("",!0)])]),s("tbody",null,[(n(!0),r(b,null,y(Y.value,(t,_)=>{var T,h;return n(),r("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",ve,u(_+1),1),s("td",be,u(t.date),1),s("td",ye,u(B(t.amount)),1),s("td",ge,u(t.source.name),1),s("td",ke,u(((T=t.sub_source)==null?void 0:T.name)||"-"),1),s("td",xe,u(t.payment),1),s("td",we,u(((h=t.account_bank)==null?void 0:h.name)||"-"),1),f.value.btn_edit||f.value.btn_delete?(n(),r("td",he,[f.value.btn_edit?(n(),I(j,{key:0,onClick:G=>N("edit",t)},{default:p(()=>e[24]||(e[24]=[i("Edit")])),_:2},1032,["onClick"])):m("",!0),f.value.btn_delete?(n(),I(L,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:G=>z(t.id)},{default:p(()=>e[25]||(e[25]=[i("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),d(se,{show:S.value,title:w.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:A},{content:p(()=>[s("form",{onSubmit:Z(q,["prevent"])},[s("div",Ce,[d(g,{for:"date",value:"Tanggal"}),d(P,{id:"date",type:"date",modelValue:l(o).date,"onUpdate:modelValue":e[4]||(e[4]=t=>l(o).date=t),class:"block w-full"},null,8,["modelValue"]),d(k,{message:l(o).errors.date},null,8,["message"])]),s("div",Ve,[d(g,{for:"amount",value:"Jumlah"}),d(P,{id:"amount",type:"text",modelValue:D.value,"onUpdate:modelValue":e[5]||(e[5]=t=>D.value=t),onInput:W,class:"block w-full"},null,8,["modelValue"]),d(k,{message:l(o).errors.amount},null,8,["message"])]),s("div",Ae,[d(g,{for:"source_id",value:"Sumber"}),c(s("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=t=>l(o).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=t=>l(o).sub_source_id=null)},[e[26]||(e[26]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),r(b,null,y(M.sources,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?m("",!0):(n(),r("span",Me,"(Tidak Aktif)"))],8,Te))),128))],544),[[C,l(o).source_id]]),d(k,{message:l(o).errors.source_id},null,8,["message"])]),s("div",Se,[d(g,{for:"sub_source_id",value:"Keterangan"}),c(s("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=t=>l(o).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!l(o).source_id},[e[27]||(e[27]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),r(b,null,y(K.value,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?m("",!0):(n(),r("span",Be,"(Tidak Aktif)"))],8,Ue))),128))],8,$e),[[C,l(o).sub_source_id]]),d(k,{message:l(o).errors.sub_source_id},null,8,["message"])]),s("div",De,[d(g,{for:"payment",value:"Pembayaran"}),s("div",Fe,[s("label",Ie,[c(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>l(o).payment=t),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=t=>l(o).account_id="")},null,544),[[E,l(o).payment]]),e[28]||(e[28]=s("span",null,"Transfer",-1))]),s("label",Le,[c(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>l(o).payment=t),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=t=>l(o).account_id=null)},null,544),[[E,l(o).payment]]),e[29]||(e[29]=s("span",null,"Tunai",-1))])]),d(k,{message:l(o).errors.payment},null,8,["message"])]),l(o).payment==="Transfer"?(n(),r("div",Pe,[d(g,{for:"account_id",value:"Rekening Tujuan"}),c(s("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=t=>l(o).account_id=t),class:"block w-full border rounded-md p-2"},[e[30]||(e[30]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),r(b,null,y(M.accountBanks,t=>(n(),r("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?m("",!0):(n(),r("span",Ee,"(Tidak Aktif)"))],8,Ne))),128))],512),[[C,l(o).account_id]]),d(k,{message:l(o).errors.account_id},null,8,["message"])])):m("",!0),s("div",je,[d(j,{type:"button",onClick:A},{default:p(()=>e[31]||(e[31]=[i("Batal")])),_:1}),d(L,{class:"ml-3",type:"submit"},{default:p(()=>[i(u(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{He as default};

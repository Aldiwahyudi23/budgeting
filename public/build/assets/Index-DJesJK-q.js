import{E as _e,d as V,i as se,k as h,C as N,c as C,o as r,w as d,a as t,e as c,f as y,b as o,t as v,g as i,F as I,h as D,u as n,P as Ve,q as j,p as P,v as Q,y as he,W as Ce}from"./app-BoHvguzt.js";import{A as Ae}from"./AppLayout-D2AY-0nl.js";import{_ as L}from"./CustomModal-snZEi-ym.js";import{_ as w}from"./PrimaryButton-CQA-dIIe.js";import{_ as U}from"./SecondaryButton-CzcA5VsT.js";import{_ as b}from"./InputLabel-D1O_WTpN.js";import{_ as x}from"./TextInput-DBrWLdMX.js";import{_ as k}from"./InputError-jqySjvAT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ue={class:"p-4"},Be={key:0,class:"bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-lg"},Se={class:"flex items-center"},Te={key:1,class:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg"},Me={class:"flex items-center"},Ie={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},$e={class:"relative"},Fe={class:"mt-4 overflow-x-auto"},Ne={class:"min-w-full border bg-white rounded-lg shadow-md"},De={class:"bg-gray-300"},je={colspan:"5",class:"px-4 py-2 font-bold"},Pe={class:"px-4 py-2"},Le={class:"px-4 py-2"},Ee={class:"px-4 py-2"},We={class:"px-4 py-2 text-center"},Re={key:0,class:"px-2 py-1 text-green-700 bg-green-200 rounded-full text-sm"},ze={key:1,class:"px-2 py-1 text-red-700 bg-red-200 rounded-full text-sm"},Oe={class:"px-2 py-2 flex justify-end gap-2 sm:justify-start"},qe={class:"mt-6 bg-white p-4 rounded-lg shadow-md"},He={class:"flex items-center justify-between"},Ke={class:"flex items-center"},Qe={class:"ml-3"},Ye={class:"text-xl font-bold text-purple-600"},Ge={class:"mb-4"},Je={class:"mb-4"},Xe={class:"mb-4"},Ze={class:"mb-4"},et={class:"flex items-center mb-4"},tt={class:"flex justify-end mt-4"},st={class:"mb-4"},ot={class:"text-lg font-semibold"},lt={class:"mb-4"},nt={class:"mb-4"},at={class:"flex justify-end mt-4"},dt={class:"mb-4"},it=["value","disabled"],ut={key:0},rt={class:"mb-4"},mt={class:"mb-4"},pt={class:"flex justify-end mt-4"},ft={class:"mb-4"},ct={class:"mb-4"},vt={class:"mb-4"},bt={class:"mb-4"},kt=["value","disabled"],gt={class:"flex justify-end mt-4"},St={__name:"Index",props:{accountBanks:Array,cashBalance:Number},setup(Y){const m=_e([...Y.accountBanks]),E=V(!1),B=V(!1),W=V(""),R=V(!1),z=V(!1),O=V(!1),S=V(null),A=V(se().props.settings);h(()=>m.filter(s=>s.name.toLowerCase().includes(W.value.toLowerCase())));const oe=h(()=>m.reduce((s,e)=>(s[e.type]||(s[e.type]=[]),s[e.type].push(e),s),{})),le={bank:"ðŸ¦ Bank","e-wallet":"ðŸ“± E-Wallet","e-money":"ðŸ’³ E-Money"},ne={id:"",type:"",name:"",description:"",amount:"",is_active:!1,user_id:se().props.auth.user.id},a=N({...ne}),_=s=>!s&&s!==0?"":new Intl.NumberFormat("id-ID").format(s),T=s=>s?String(s).replace(/\./g,""):"",G=h({get:()=>_(a.amount),set:s=>a.amount=T(s)}),ae=s=>{const e=String(s.target.value).replace(/\./g,"");a.amount=e},J=(s,e=null)=>{B.value=s==="edit",B.value&&e?(a.id=e.id,a.type=e.type,a.name=e.name,a.description=e.description,a.amount=e.amount||"",a.is_active=!!e.is_active):a.reset(),E.value=!0},$=()=>{a.reset(),E.value=!1},de=()=>{B.value?a.put(route("account-bank.update",a.id),{onSuccess:()=>{const s=m.findIndex(e=>e.id===a.id);s!==-1&&(m[s]={...a.data()}),$()}}):a.post(route("account-bank.store"),{onSuccess:s=>{m.unshift(s.props.accountBanks[0]),$()}})},ie=s=>{confirm("Apakah Anda yakin ingin menghapus rekening bank ini?")&&a.delete(route("account-bank.destroy",s),{onSuccess:()=>{const e=m.findIndex(l=>l.id===s);e!==-1&&m.splice(e,1)}})},g=N({amount:"",note:"",bank_id:null}),X=h({get:()=>_(g.amount),set:s=>g.amount=T(s)}),ue=s=>{const e=String(s.target.value).replace(/\./g,"");g.amount=e},re=s=>{S.value=s,g.bank_id=s.id,R.value=!0},q=()=>{g.reset(),R.value=!1},me=()=>{g.post(route("account-bank.withdraw"),{onSuccess:()=>{q();const s=m.findIndex(e=>e.id===S.value.id);s!==-1&&(m[s].amount-=parseFloat(g.amount))}})},p=N({amount:"",note:"",bank_id:null}),Z=h({get:()=>_(p.amount),set:s=>p.amount=T(s)}),pe=s=>{const e=String(s.target.value).replace(/\./g,"");p.amount=e},fe=()=>{z.value=!0},H=()=>{p.reset(),z.value=!1},ce=()=>{p.post(route("account-bank.deposit"),{onSuccess:()=>{H();const s=m.findIndex(e=>e.id===p.bank_id);s!==-1&&(m[s].amount+=parseFloat(p.amount))}})},ve=s=>{Ce.visit(route("account-bank.mutation",s))},u=N({amount:"",admin:"",note:"",bank_ex:null,bank_in:null}),ee=h({get:()=>_(u.amount),set:s=>u.amount=T(s)}),be=s=>{const e=String(s.target.value).replace(/\./g,"");u.amount=e},te=h({get:()=>_(u.admin),set:s=>u.admin=T(s)}),ke=s=>{const e=String(s.target.value).replace(/\./g,"");u.admin=e},ge=h(()=>m.filter(s=>s.type==="bank"||s.type==="e-wallet")),xe=s=>{S.value=s,u.bank_in=s.id,O.value=!0},K=()=>{u.reset(),O.value=!1},ye=()=>{u.post(route("account-bank.topUp"),{onSuccess:()=>{K();const s=m.findIndex(l=>l.id===u.bank_ex);s!==-1&&(m[s].amount-=parseFloat(u.amount));const e=m.findIndex(l=>l.id===u.bank_in);e!==-1&&(m[e].amount+=parseFloat(u.amount))}})};return(s,e)=>(r(),C(Ae,{title:"Account Bank"},{default:d(()=>[t("div",Ue,[s.$page.props.flash.success?(r(),c("div",Be,[t("div",Se,[e[16]||(e[16]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1)),t("p",null,v(s.$page.props.flash.success),1)])])):y("",!0),s.$page.props.flash.error?(r(),c("div",Te,[t("div",Me,[e[17]||(e[17]=t("svg",{class:"h-5 w-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("p",null,v(s.$page.props.flash.error),1)])])):y("",!0),t("div",Ie,[A.value.bank?(r(),C(w,{key:0,onClick:e[0]||(e[0]=l=>J("create"))},{default:d(()=>e[18]||(e[18]=[i("Tambah Rekening Bank")])),_:1})):y("",!0),t("div",$e,[o(x,{modelValue:W.value,"onUpdate:modelValue":e[1]||(e[1]=l=>W.value=l),placeholder:"Cari Rekening Bank...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[19]||(e[19]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),t("div",Fe,[t("table",Ne,[e[24]||(e[24]=t("thead",{class:"bg-gray-200"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left"},"No"),t("th",{class:"px-4 py-2 text-left"},"Nama"),t("th",{class:"px-4 py-2 text-left"},"Nominal"),t("th",{class:"px-4 py-2 text-center"},"Status"),t("th",{class:"px-4 py-2 text-center"},"Aksi")])],-1)),t("tbody",null,[(r(!0),c(I,null,D(oe.value,(l,M)=>(r(),c(I,{key:M},[t("tr",De,[t("td",je,v(le[M]),1)]),(r(!0),c(I,null,D(l,(f,we)=>(r(),c("tr",{key:f.id,class:"border-b hover:bg-gray-100"},[t("td",Pe,v(we+1),1),t("td",Le,v(f.name),1),t("td",Ee,v(_(f.amount)),1),t("td",We,[f.is_active?(r(),c("span",Re,"Aktif")):(r(),c("span",ze,"Tidak Aktif"))]),t("td",Oe,[A.value.btn_edit?(r(),C(U,{key:0,onClick:F=>J("edit",f)},{default:d(()=>e[20]||(e[20]=[i("Edit")])),_:2},1032,["onClick"])):y("",!0),A.value.bank?(r(),C(U,{key:1,class:"bg-yellow-400 hover:bg-yellow-500",onClick:F=>xe(f)},{default:d(()=>[i(v(f.type==="bank"?"Deposit":"Top Up"),1)]),_:2},1032,["onClick"])):y("",!0),o(w,{class:"bg-blue-600 hover:bg-blue-700",onClick:F=>ve(f.id)},{default:d(()=>e[21]||(e[21]=[i("Mutasi")])),_:2},1032,["onClick"]),A.value.cash?(r(),C(w,{key:2,class:"bg-green-600 hover:bg-green-700",onClick:F=>re(f)},{default:d(()=>e[22]||(e[22]=[i("Tarik Tunai")])),_:2},1032,["onClick"])):y("",!0),A.value.btn_delete?(r(),C(w,{key:3,class:"bg-red-600 hover:bg-red-700",onClick:F=>ie(f.id)},{default:d(()=>e[23]||(e[23]=[i("Hapus")])),_:2},1032,["onClick"])):y("",!0)])]))),128))],64))),128))])])]),t("div",qe,[t("div",He,[t("div",Ke,[e[27]||(e[27]=t("div",{class:"bg-purple-100 p-2 rounded-full"},[t("svg",{class:"w-5 h-5 text-purple-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),t("div",Qe,[e[26]||(e[26]=t("h2",{class:"text-base font-semibold"},"Saldo Cash",-1)),t("p",Ye,v(_(Y.cashBalance)),1),o(n(Ve),{href:s.route("debits.index"),class:"text-xs text-gray-500 hover:text-purple-600"},{default:d(()=>e[25]||(e[25]=[i("Klik untuk melihat detail mutasi")])),_:1},8,["href"])])]),A.value.bank?(r(),C(w,{key:0,class:"bg-green-600 hover:bg-green-700",onClick:fe},{default:d(()=>e[28]||(e[28]=[i("Setor Tunai")])),_:1})):y("",!0)])]),o(L,{show:E.value,title:B.value?"Edit Rekening":"Tambah Rekening",onClose:$},{content:d(()=>[t("form",{onSubmit:j(de,["prevent"])},[t("div",Ge,[o(b,{for:"type"},{default:d(()=>e[29]||(e[29]=[i(" Tipe Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),P(t("select",{id:"type","onUpdate:modelValue":e[2]||(e[2]=l=>n(a).type=l),class:"block w-full border-gray-300 rounded-md shadow-sm"},e[30]||(e[30]=[t("option",{value:""},"-- Pilih Tipe --",-1),t("option",{value:"bank"},"Bank",-1),t("option",{value:"e-wallet"},"E-Wallet",-1),t("option",{value:"e-money"},"E-Money",-1)]),512),[[Q,n(a).type]]),o(k,{message:n(a).errors.type},null,8,["message"])]),t("div",Je,[o(b,{for:"name"},{default:d(()=>e[31]||(e[31]=[i(" Nama Rekening "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"name",modelValue:n(a).name,"onUpdate:modelValue":e[3]||(e[3]=l=>n(a).name=l),class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(a).errors.name},null,8,["message"])]),t("div",Xe,[o(b,{for:"description",value:"Deskripsi"}),o(x,{id:"description",modelValue:n(a).description,"onUpdate:modelValue":e[4]||(e[4]=l=>n(a).description=l),class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(a).errors.description},null,8,["message"])]),t("div",Ze,[o(b,{for:"amount",value:"Nominal"}),o(x,{id:"amount",type:"text",modelValue:G.value,"onUpdate:modelValue":e[5]||(e[5]=l=>G.value=l),onInput:ae,class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(a).errors.amount},null,8,["message"])]),t("div",et,[P(t("input",{type:"checkbox",id:"is_active","onUpdate:modelValue":e[6]||(e[6]=l=>n(a).is_active=l),class:"mr-2"},null,512),[[he,n(a).is_active]]),e[32]||(e[32]=t("label",{for:"is_active"},"Aktif",-1))]),t("div",tt,[o(U,{type:"button",onClick:$},{default:d(()=>e[33]||(e[33]=[i("Batal")])),_:1}),o(w,{class:"ml-3",type:"submit"},{default:d(()=>[i(v(B.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"]),o(L,{show:R.value,title:"Tarik Tunai ",onClose:q},{content:d(()=>{var l,M;return[t("form",{onSubmit:j(me,["prevent"])},[t("div",st,[t("h2",ot,v((l=S.value)==null?void 0:l.name)+" "+v(_((M=S.value)==null?void 0:M.amount)),1)]),t("div",lt,[o(b,{for:"withdrawAmount"},{default:d(()=>e[34]||(e[34]=[i(" Nominal Yang Ditarik "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"withdrawAmount",type:"text",modelValue:X.value,"onUpdate:modelValue":e[7]||(e[7]=f=>X.value=f),onInput:ue,class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(g).errors.amount},null,8,["message"])]),t("div",nt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:n(g).note,"onUpdate:modelValue":e[8]||(e[8]=f=>n(g).note=f),class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(g).errors.note},null,8,["message"])]),t("div",at,[o(U,{type:"button",onClick:q},{default:d(()=>e[35]||(e[35]=[i("Batal")])),_:1}),o(w,{class:"ml-3",type:"submit"},{default:d(()=>e[36]||(e[36]=[i("Tarik/Pindah ke Cash")])),_:1})])],32)]}),_:1},8,["show"]),o(L,{show:z.value,title:"Setor Tunai",onClose:H},{content:d(()=>[t("form",{onSubmit:j(ce,["prevent"])},[t("div",dt,[o(b,{for:"bank_id"},{default:d(()=>e[37]||(e[37]=[i(" Pilih Bank Tujuan "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),P(t("select",{id:"bank_id","onUpdate:modelValue":e[9]||(e[9]=l=>n(p).bank_id=l),class:"block w-full border rounded-md p-2"},[e[38]||(e[38]=t("option",{disabled:"",value:""},"Pilih Bank",-1)),(r(!0),c(I,null,D(m,l=>(r(),c("option",{key:l.id,value:l.id,disabled:!l.is_active},[i(v(l.name)+" ",1),l.is_active?y("",!0):(r(),c("span",ut,"(Tidak Aktif)"))],8,it))),128))],512),[[Q,n(p).bank_id]]),o(k,{message:n(p).errors.bank_id},null,8,["message"])]),t("div",rt,[o(b,{for:"depositAmount"},{default:d(()=>e[39]||(e[39]=[i(" Nominal Setor Tunai "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"depositAmount",type:"text",modelValue:Z.value,"onUpdate:modelValue":e[10]||(e[10]=l=>Z.value=l),onInput:pe,class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(p).errors.amount},null,8,["message"])]),t("div",mt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:n(p).note,"onUpdate:modelValue":e[11]||(e[11]=l=>n(p).note=l),class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(p).errors.note},null,8,["message"])]),t("div",pt,[o(U,{type:"button",onClick:H},{default:d(()=>e[40]||(e[40]=[i("Batal")])),_:1}),o(w,{class:"ml-3",type:"submit"},{default:d(()=>e[41]||(e[41]=[i("Setor/Pindah ke Bank")])),_:1})])],32)]),_:1},8,["show"]),o(L,{show:O.value,title:"Top UP",onClose:K},{content:d(()=>[t("form",{onSubmit:j(ye,["prevent"])},[t("div",ft,[o(b,{for:"topUpAmount"},{default:d(()=>e[42]||(e[42]=[i(" Nominal "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),o(x,{id:"topUpAmount",type:"text",modelValue:ee.value,"onUpdate:modelValue":e[12]||(e[12]=l=>ee.value=l),onInput:be,class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(u).errors.amount},null,8,["message"])]),t("div",ct,[o(b,{for:"admin"},{default:d(()=>e[43]||(e[43]=[i(" Admin ")])),_:1}),o(x,{id:"admin",type:"text",modelValue:te.value,"onUpdate:modelValue":e[13]||(e[13]=l=>te.value=l),onInput:ke,class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(u).errors.admin},null,8,["message"])]),t("div",vt,[o(b,{for:"note",value:"Catatan"}),o(x,{id:"note",modelValue:n(u).note,"onUpdate:modelValue":e[14]||(e[14]=l=>n(u).note=l),class:"block w-full"},null,8,["modelValue"]),o(k,{message:n(u).errors.note},null,8,["message"])]),t("div",bt,[o(b,{for:"bank_ex"},{default:d(()=>e[44]||(e[44]=[i(" Pilih Rekening Sumber "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),P(t("select",{id:"bank_ex","onUpdate:modelValue":e[15]||(e[15]=l=>n(u).bank_ex=l),class:"block w-full border rounded-md p-2"},[e[45]||(e[45]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),(r(!0),c(I,null,D(ge.value,l=>(r(),c("option",{key:l.id,value:l.id,disabled:l.id===n(u).bank_in},v(l.name),9,kt))),128))],512),[[Q,n(u).bank_ex]]),o(k,{message:n(u).errors.bank_ex},null,8,["message"])]),t("div",gt,[o(U,{type:"button",onClick:K},{default:d(()=>e[46]||(e[46]=[i("Batal")])),_:1}),o(w,{class:"ml-3",type:"submit"},{default:d(()=>e[47]||(e[47]=[i("Setor/Pindah ke Bank")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{St as default};

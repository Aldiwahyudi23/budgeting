import{i as D,d as c,j as I,C as H,k as Q,c as B,o,w as _,a as s,e as n,f as u,b as d,t as i,g as p,l as v,F as f,h as g,u as l,v as V,m as q,p as N,W as X}from"./app-tGCH4RxZ.js";import{A as Z}from"./AppLayout-DCn7IAwp.js";import{_ as F}from"./PrimaryButton-DqsXupKw.js";import{_ as K}from"./SecondaryButton-ffqNPixU.js";import{_ as y}from"./InputLabel-B-zxLUml.js";import{_ as L}from"./TextInput-CdDk0XgE.js";import{_ as k}from"./InputError-B2SuWLf4.js";import{_ as ee}from"./CustomModal-BldydTIJ.js";import{_ as te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={class:"p-4"},ae={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},oe={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},le={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ne={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},re={class:"flex items-center space-x-4 w-full md:w-auto"},de={class:"flex-1 md:flex-none"},ie=["value"],ue={class:"flex-1 md:flex-none"},pe=["value"],me={class:"relative w-full md:w-64"},ce={class:"mt-4 overflow-x-auto"},_e={class:"min-w-full border bg-white rounded-lg shadow-md"},ve={class:"bg-gray-200"},fe={key:0,class:"px-4 py-2 text-center"},ge={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ke={class:"px-4 py-2"},xe={class:"px-4 py-2"},we={class:"px-4 py-2"},he={class:"px-4 py-2"},Ve={key:0,class:"px-4 py-2 text-center"},Ce={class:"mb-4"},$e={class:"mb-4"},Ae={class:"mb-4"},Se=["value","disabled"],Te={key:0},Me={class:"mb-4"},Ue=["disabled"],De=["value","disabled"],Be={key:0},Fe={class:"mb-4"},Le={class:"flex space-x-4 mt-2"},Pe={class:"flex items-center"},Ee={class:"flex items-center"},Ie={key:0,class:"mb-4"},Ne={disabled:"",value:""},Ke={key:0},Re={label:"Rekening"},Je=["value","disabled"],je={key:0},Ye={key:0,label:"Saving (Tabungan)"},Oe=["value","disabled"],We={key:0},ze={class:"flex justify-end mt-4"},Ge={__name:"Index",props:{expenses:Array,categories:Array,subCategories:Array,accountBanks:Array},setup(S){const C=S;D();const x=c(""),T=c(!1),w=c(!1),m=c(D().props.settings),P=c(D().props.savingSubCategories),R=Array.from({length:6},(r,e)=>2025+e),J=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],M=c(new Date().getFullYear()),U=c(new Date().getMonth()+1),j=I(()=>C.expenses.filter(r=>{var h;const e=new Date(r.date),t=e.getFullYear()===M.value,b=e.getMonth()+1===U.value,A=r.category.name.toLowerCase().includes(x.value.toLowerCase())||((h=r.sub_category)==null?void 0:h.name.toLowerCase().includes(x.value.toLowerCase()))||r.payment.toLowerCase().includes(x.value.toLowerCase());return t&&b&&A})),Y=I(()=>C.subCategories.filter(r=>r.category_id===a.category_id)),O=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r),a=H({id:"",date:"",amount:"",category_id:"",sub_kategori_id:null,payment:"",account_id:null}),E=(r,e=null)=>{w.value=r==="edit",w.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.category_id=e.category_id,a.sub_kategori_id=e.sub_kategori_id,a.payment=e.payment,a.account_id=e.account_id):a.reset(),T.value=!0},$=()=>{a.reset(),T.value=!1},W=()=>{w.value?a.put(route("expense.update",a.id),{onSuccess:()=>$()}):a.post(route("expense.store"),{onSuccess:()=>$()})},z=r=>{confirm("Apakah Anda yakin ingin menghapus pengeluaran ini?")&&X.delete(route("expense.destroy",r),{onSuccess:()=>{const e=C.expenses.findIndex(t=>t.id===r);e!==-1&&C.expenses.splice(e,1)},onError:e=>{alert("Gagal menghapus pengeluaran. Silakan coba lagi.")}})};return Q(()=>{m.value.saving_expense&&console.log(P.value)}),(r,e)=>(o(),B(Z,{title:"Expenses"},{default:_(()=>[s("div",se,[r.$page.props.flash.success?(o(),n("div",ae,i(r.$page.props.flash.success),1)):u("",!0),r.$page.props.flash.error?(o(),n("div",oe,i(r.$page.props.flash.error),1)):u("",!0),s("div",le,[d(F,{onClick:e[0]||(e[0]=t=>E("create"))},{default:_(()=>e[14]||(e[14]=[p("Tambah Pengeluaran")])),_:1}),s("div",ne,[s("div",re,[e[15]||(e[15]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",de,[v(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>M.value=t),class:"block w-full border rounded-md p-2"},[(o(!0),n(f,null,g(l(R),t=>(o(),n("option",{key:t,value:t},i(t),9,ie))),128))],512),[[V,M.value]])]),s("div",ue,[v(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>U.value=t),class:"block w-full border rounded-md p-2"},[(o(),n(f,null,g(J,(t,b)=>s("option",{key:b,value:b+1},i(t),9,pe)),64))],512),[[V,U.value]])])]),s("div",me,[d(L,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=t=>x.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",ce,[s("table",_e,[s("thead",ve,[s("tr",null,[e[17]||(e[17]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),m.value.btn_edit||m.value.btn_delete?(o(),n("th",fe,"Aksi")):u("",!0)])]),s("tbody",null,[(o(!0),n(f,null,g(j.value,(t,b)=>{var A,h;return o(),n("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",ge,i(b+1),1),s("td",be,i(t.date),1),s("td",ye,i(O(t.amount)),1),s("td",ke,i(t.category.name),1),s("td",xe,i(((A=t.sub_category)==null?void 0:A.name)||"-"),1),s("td",we,i(t.payment),1),s("td",he,i(((h=t.account_bank)==null?void 0:h.name)||"-"),1),m.value.btn_edit||m.value.btn_delete?(o(),n("td",Ve,[m.value.btn_edit?(o(),B(K,{key:0,onClick:G=>E("edit",t)},{default:_(()=>e[24]||(e[24]=[p("Edit")])),_:2},1032,["onClick"])):u("",!0),m.value.btn_delete?(o(),B(F,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:G=>z(t.id)},{default:_(()=>e[25]||(e[25]=[p("Hapus")])),_:2},1032,["onClick"])):u("",!0)])):u("",!0)])}),128))])])]),d(ee,{show:T.value,title:w.value?"Edit Pengeluaran":"Tambah Pengeluaran",onClose:$},{content:_(()=>[s("form",{onSubmit:q(W,["prevent"])},[s("div",Ce,[d(y,{for:"date",value:"Tanggal"}),d(L,{id:"date",type:"date",modelValue:l(a).date,"onUpdate:modelValue":e[4]||(e[4]=t=>l(a).date=t),class:"block w-full"},null,8,["modelValue"]),d(k,{message:l(a).errors.date},null,8,["message"])]),s("div",$e,[d(y,{for:"amount",value:"Jumlah"}),d(L,{id:"amount",type:"number",modelValue:l(a).amount,"onUpdate:modelValue":e[5]||(e[5]=t=>l(a).amount=t),class:"block w-full"},null,8,["modelValue"]),d(k,{message:l(a).errors.amount},null,8,["message"])]),s("div",Ae,[d(y,{for:"category_id",value:"Kategori"}),v(s("select",{id:"category_id","onUpdate:modelValue":e[6]||(e[6]=t=>l(a).category_id=t),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=t=>l(a).sub_kategori_id=null)},[e[26]||(e[26]=s("option",{disabled:"",value:""},"Pilih Kategori",-1)),(o(!0),n(f,null,g(S.categories,t=>(o(),n("option",{key:t.id,value:t.id,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(o(),n("span",Te,"(Tidak Aktif)"))],8,Se))),128))],544),[[V,l(a).category_id]]),d(k,{message:l(a).errors.category_id},null,8,["message"])]),s("div",Me,[d(y,{for:"sub_kategori_id",value:"Keterangan"}),v(s("select",{id:"sub_kategori_id","onUpdate:modelValue":e[8]||(e[8]=t=>l(a).sub_kategori_id=t),class:"block w-full border rounded-md p-2",disabled:!l(a).category_id},[e[27]||(e[27]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(o(!0),n(f,null,g(Y.value,t=>(o(),n("option",{key:t.id,value:t.id,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(o(),n("span",Be,"(Tidak Aktif)"))],8,De))),128))],8,Ue),[[V,l(a).sub_kategori_id]]),d(k,{message:l(a).errors.sub_kategori_id},null,8,["message"])]),s("div",Fe,[d(y,{for:"payment",value:"Pembayaran"}),s("div",Le,[s("label",Pe,[v(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>l(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=t=>l(a).account_id="")},null,544),[[N,l(a).payment]]),e[28]||(e[28]=s("span",null,"Transfer",-1))]),s("label",Ee,[v(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>l(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=t=>l(a).account_id=null)},null,544),[[N,l(a).payment]]),e[29]||(e[29]=s("span",null,"Tunai",-1))])]),d(k,{message:l(a).errors.payment},null,8,["message"])]),l(a).payment==="Transfer"?(o(),n("div",Ie,[d(y,{for:"account_id",value:"Sumber Rekening "}),v(s("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=t=>l(a).account_id=t),class:"block w-full border rounded-md p-2"},[s("option",Ne,[e[30]||(e[30]=p(" Pilih Rekening ")),m.value.saving_expense?(o(),n("span",Ke," / Dari Saving (Tabungan)")):u("",!0)]),s("optgroup",Re,[(o(!0),n(f,null,g(S.accountBanks,t=>(o(),n("option",{key:t.id,value:`account_${t.id}`,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(o(),n("span",je,"(Tidak Aktif)"))],8,Je))),128))]),m.value.saving_expense?(o(),n("optgroup",Ye,[(o(!0),n(f,null,g(P.value,t=>(o(),n("option",{key:t.id,value:`subcategory_${t.id}`,disabled:!t.is_active},[p(i(t.name)+" ",1),t.is_active?u("",!0):(o(),n("span",We,"(Tidak Aktif)"))],8,Oe))),128))])):u("",!0)],512),[[V,l(a).account_id]]),d(k,{message:l(a).errors.account_id},null,8,["message"])])):u("",!0),s("div",ze,[d(K,{type:"button",onClick:$},{default:_(()=>e[31]||(e[31]=[p("Batal")])),_:1}),d(F,{class:"ml-3",type:"submit"},{default:_(()=>[p(i(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},ot=te(Ge,[["__scopeId","data-v-73e80614"]]);export{ot as default};

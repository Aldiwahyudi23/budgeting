import{S as Y,i as j,d as m,j as h,C as Z,c as B,o as d,w as b,a as s,e as u,f as _,b as n,t as i,F as S,h as T,n as ee,g as $,p as D,v as L,q as se,u as r,W as te}from"./app-DBiucBkR.js";import{A as oe}from"./AppLayout-BI2M7VZQ.js";import{_ as ae}from"./CustomModal-CTDXuHqr.js";import{_ as E}from"./PrimaryButton-BDBZEjPd.js";import{_ as I}from"./SecondaryButton-CMQqJvuj.js";import{_ as w}from"./InputLabel-BkdM2JL6.js";import{_ as A}from"./TextInput-BZo7SZEP.js";import{_ as k}from"./InputError-D4HwAbFQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function N(l,g,c){Y.fire({icon:l,title:g,text:c,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0})}function le(l){var g,c;console.log(l),console.log(l==null?void 0:l.props),console.log((g=l==null?void 0:l.props)==null?void 0:g.flash),(c=l==null?void 0:l.props)!=null&&c.flash&&(l.props.flash.error&&N("error","Error",l.props.flash.error),l.props.flash.success&&N("success","Success",l.props.flash.success))}const ne={class:"p-4"},re={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},de={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},ie={class:"mb-2"},ue={class:"grid grid-cols-1 md:grid-cols-3 gap-2"},ce={class:"text-gray-700 font-medium"},pe={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ge={class:"relative"},me={class:"mt-4 overflow-x-auto"},ve={class:"min-w-full border bg-white rounded-lg shadow-md"},fe={class:"bg-gray-200"},be={key:0,class:"px-4 py-2 text-center"},_e={class:"px-4 py-2"},ye={class:"px-4 py-2"},xe={class:"px-4 py-2"},he={class:"px-4 py-2"},we={class:"px-4 py-2 text-green-600"},ke={class:"px-4 py-2 text-red-600"},Ce={class:"px-4 py-2"},Ve={key:0,class:"px-4 py-2 text-center"},Se={class:"flex justify-between items-center mt-4"},Te={class:"flex items-center space-x-2"},$e={class:"flex space-x-2"},Ae=["disabled"],Me=["disabled"],Be={class:"mb-4"},De={class:"mb-4"},Le={class:"mb-4"},Pe={class:"mb-4"},Ue=["value"],Fe={class:"mb-4"},je=["disabled"],Ee=["value"],Ie={class:"flex justify-end mt-4"},Ge={__name:"Index",props:{savings:Array,categories:Array,subCategories:Array},setup(l){const g=j();console.log(g.props.flash),le(g);const c=l,v=m(j().props.settings),y=m(""),M=m(!1),x=m(!1),p=m(1),f=m(10);m("");const P=h(()=>c.savings.filter(a=>{var e;return a.category.name.toLowerCase().includes(y.value.toLowerCase())||((e=a.sub_category)==null?void 0:e.name.toLowerCase().includes(y.value.toLowerCase()))||a.note.toLowerCase().includes(y.value.toLowerCase())})),q=()=>{const a=c.categories.find(e=>e.name==="Saving");return a?a.id:null},K=h(()=>c.subCategories.filter(a=>a.category_id===o.category_id)),z=h(()=>{const a=(p.value-1)*f.value,e=a+f.value;return P.value.slice(a,e)}),U=h(()=>Math.ceil(P.value.length/f.value)),O=()=>{p.value<U.value&&p.value++},W=()=>{p.value>1&&p.value--},H=h(()=>{const a={};return c.savings.forEach(e=>{var t;(!a[e.sub_category_id]||new Date(e.date)>new Date(a[e.sub_category_id].date))&&(a[e.sub_category_id]={id:e.sub_category_id,name:((t=e.sub_category)==null?void 0:t.name)||"Tanpa Sub Kategori",balance:e.balance,date:e.date})}),Object.values(a)}),C=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(a||0),o=Z({...{id:"",date:"",amount:0,note:"",category_id:"",sub_category_id:null}}),J=(a,e=null)=>{x.value=a==="edit",x.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.note=e.note,o.category_id=e.category_id,o.sub_category_id=e.sub_category_id):(o.reset(),o.category_id=q()),M.value=!0},V=()=>{o.reset(),M.value=!1},Q=()=>{x.value?o.put(route("savings.update",o.id),{onSuccess:()=>V()}):o.post(route("savings.store"),{onSuccess:()=>V()})},R=a=>{confirm("Apakah Anda yakin ingin menghapus tabungan ini?")&&te.delete(route("savings.destroy",a),{onSuccess:()=>{const e=c.savings.findIndex(t=>t.id===a);e!==-1&&c.savings.splice(e,1)}})};return(a,e)=>(d(),B(oe,{title:"Saving (Tabungan)"},{default:b(()=>[s("div",ne,[a.$page.props.flash.success?(d(),u("div",re,i(a.$page.props.flash.success),1)):_("",!0),a.$page.props.flash.error?(d(),u("div",de,i(a.$page.props.flash.error),1)):_("",!0),s("div",ie,[s("div",ue,[(d(!0),u(S,null,T(H.value,t=>(d(),u("div",{key:t.id,class:"bg-white p-4 rounded-lg shadow-md"},[s("h3",ce,i(t.name),1),s("p",{class:ee(["text-2xl font-bold",t.balance<0?"text-red-600":"text-green-600"])},i(C(t.balance)),3)]))),128))])]),s("div",pe,[s("div",ge,[n(A,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),placeholder:"Cari Tabungan...",class:"pl-10 pr-4 py-2 border rounded-md w-64"},null,8,["modelValue"]),e[8]||(e[8]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])]),s("div",me,[s("table",ve,[s("thead",fe,[s("tr",null,[e[9]||(e[9]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[10]||(e[10]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[11]||(e[11]=s("th",{class:"px-4 py-2 text-left"},"Kategori",-1)),e[12]||(e[12]=s("th",{class:"px-4 py-2 text-left"},"Catatan",-1)),e[13]||(e[13]=s("th",{class:"px-4 py-2 text-left"},"Masuk",-1)),e[14]||(e[14]=s("th",{class:"px-4 py-2 text-left"},"Keluar",-1)),e[15]||(e[15]=s("th",{class:"px-4 py-2 text-left"},"Saldo",-1)),v.value.btn_edit||v.value.btn_delete?(d(),u("th",be,"Aksi")):_("",!0)])]),s("tbody",null,[(d(!0),u(S,null,T(z.value,(t,G)=>{var F;return d(),u("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",_e,i((p.value-1)*f.value+G+1),1),s("td",ye,i(t.date),1),s("td",xe,i(((F=t.sub_category)==null?void 0:F.name)||"-"),1),s("td",he,i(t.note||"-"),1),s("td",we,i(t.amount>0?C(t.amount):"-"),1),s("td",ke,i(t.amount<0?C(Math.abs(t.amount)):"-"),1),s("td",Ce,i(C(t.balance)),1),v.value.btn_edit||v.value.btn_delete?(d(),u("td",Ve,[v.value.btn_edit?(d(),B(I,{key:0,onClick:X=>J("edit",t)},{default:b(()=>e[16]||(e[16]=[$("Edit")])),_:2},1032,["onClick"])):_("",!0),v.value.btn_delete?(d(),B(E,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:X=>R(t.id)},{default:b(()=>e[17]||(e[17]=[$("Hapus")])),_:2},1032,["onClick"])):_("",!0)])):_("",!0)])}),128))])])]),s("div",Se,[s("div",Te,[D(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>f.value=t),class:"border rounded-md p-1 text-sm"},e[18]||(e[18]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[L,f.value]])]),s("div",$e,[s("button",{onClick:W,disabled:p.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," back ",8,Ae),s("button",{onClick:O,disabled:p.value===U.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 disabled:opacity-50"}," next ",8,Me)])]),n(ae,{show:M.value,title:x.value?"Edit Tabungan":"Tambah Tabungan",onClose:V},{content:b(()=>[s("form",{onSubmit:se(Q,["prevent"])},[s("div",Be,[n(w,{for:"date",value:"Tanggal"}),n(A,{id:"date",type:"date",modelValue:r(o).date,"onUpdate:modelValue":e[2]||(e[2]=t=>r(o).date=t),class:"block w-full",required:""},null,8,["modelValue"]),n(k,{message:r(o).errors.date},null,8,["message"])]),s("div",De,[n(w,{for:"amount",value:"Jumlah"}),n(A,{id:"amount",type:"number",modelValue:r(o).amount,"onUpdate:modelValue":e[3]||(e[3]=t=>r(o).amount=t),class:"block w-full",required:""},null,8,["modelValue"]),n(k,{message:r(o).errors.amount},null,8,["message"])]),s("div",Le,[n(w,{for:"note",value:"Catatan"}),n(A,{id:"note",modelValue:r(o).note,"onUpdate:modelValue":e[4]||(e[4]=t=>r(o).note=t),class:"block w-full"},null,8,["modelValue"]),n(k,{message:r(o).errors.note},null,8,["message"])]),s("div",Pe,[n(w,{for:"category_id",value:"Tabungan"}),D(s("select",{id:"category_id","onUpdate:modelValue":e[5]||(e[5]=t=>r(o).category_id=t),class:"block w-full border rounded-md p-2",onChange:e[6]||(e[6]=t=>r(o).sub_category_id=null)},[e[19]||(e[19]=s("option",{disabled:"",value:""},"Pilih Tabungan",-1)),(d(!0),u(S,null,T(l.categories,t=>(d(),u("option",{key:t.id,value:t.id},i(t.name),9,Ue))),128))],544),[[L,r(o).category_id]]),n(k,{message:r(o).errors.category_id},null,8,["message"])]),s("div",Fe,[n(w,{for:"sub_category_id",value:"Data Tabungan"}),D(s("select",{id:"sub_category_id","onUpdate:modelValue":e[7]||(e[7]=t=>r(o).sub_category_id=t),class:"block w-full border rounded-md p-2",disabled:!r(o).category_id},[e[20]||(e[20]=s("option",{disabled:"",value:""},"Pilih Data Tabungan",-1)),(d(!0),u(S,null,T(K.value,t=>(d(),u("option",{key:t.id,value:t.id},i(t.name),9,Ee))),128))],8,je),[[L,r(o).sub_category_id]]),n(k,{message:r(o).errors.sub_category_id},null,8,["message"])]),s("div",Ie,[n(I,{type:"button",onClick:V},{default:b(()=>e[21]||(e[21]=[$("Batal")])),_:1}),n(E,{class:"ml-3",type:"submit"},{default:b(()=>[$(i(x.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{Ge as default};

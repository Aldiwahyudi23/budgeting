import{d as v,i as G,j as L,C as H,c as D,o as a,w as p,a as t,b as n,g as i,l as c,e as d,F as b,h as y,u as l,t as u,v as C,f as m,m as Q,p as I,W as q}from"./app-oWTKchla.js";import{A as K}from"./AppLayout-CbMJUpY1.js";import{_ as P}from"./PrimaryButton-7Gl0acy5.js";import{_ as N}from"./SecondaryButton-Bj7vcoJP.js";import{_ as k}from"./InputLabel-DrgYM_36.js";import{_ as B}from"./TextInput-B1XYRZ6I.js";import{_ as x}from"./InputError-CeoONpBZ.js";import{_ as X}from"./CustomModal-BlMbOmD5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"p-4"},ee={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},se={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},te={class:"flex items-center space-x-4 w-full md:w-auto"},oe={class:"flex-1 md:flex-none"},le=["value"],ae={class:"flex-1 md:flex-none"},ne=["value"],de={class:"relative w-full md:w-64"},re={class:"mt-4 overflow-x-auto"},ue={class:"min-w-full border bg-white rounded-lg shadow-md"},ie={class:"bg-gray-200"},me={key:0,class:"px-4 py-2 text-center"},pe={class:"px-4 py-2"},ce={class:"px-4 py-2"},fe={class:"px-4 py-2"},_e={class:"px-4 py-2"},ve={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},ke={key:0,class:"px-4 py-2 text-center"},xe={class:"mb-4"},ge={class:"mb-4"},we={class:"mb-4"},he=["value","disabled"],Ce={key:0},Ve={class:"mb-4"},Se=["disabled"],Ae=["value","disabled"],Te={key:0},Me={class:"mb-4"},$e={class:"flex space-x-4 mt-2"},Ue={class:"flex items-center"},De={class:"flex items-center"},Pe={key:0,class:"mb-4"},Be=["value","disabled"],Fe={key:0},Le={class:"flex justify-end mt-4"},ze={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(T){const V=T,f=v(G().props.settings),g=v(""),M=v(!1),w=v(!1),j=Array.from({length:6},(r,e)=>2025+e),E=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],$=v(new Date().getFullYear()),U=v(new Date().getMonth()+1),J=L(()=>V.incomes.filter(r=>{var h;const e=new Date(r.date),s=e.getFullYear()===$.value,_=e.getMonth()+1===U.value,A=r.source.name.toLowerCase().includes(g.value.toLowerCase())||((h=r.sub_source)==null?void 0:h.name.toLowerCase().includes(g.value.toLowerCase()))||r.payment.toLowerCase().includes(g.value.toLowerCase());return s&&_&&A})),R=L(()=>V.subSources.filter(r=>r.source_id===o.source_id)),Y=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r),o=H({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),F=(r,e=null)=>{w.value=r==="edit",w.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),M.value=!0},S=()=>{o.reset(),M.value=!1},O=()=>{w.value?o.put(route("income.update",o.id),{onSuccess:()=>S()}):o.post(route("income.store"),{onSuccess:()=>S()})},W=r=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&q.delete(route("income.destroy",r),{onSuccess:()=>{const e=V.incomes.findIndex(s=>s.id===r);e!==-1&&V.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(r,e)=>(a(),D(K,{title:"Income"},{default:p(()=>[t("div",Z,[t("div",ee,[n(P,{onClick:e[0]||(e[0]=s=>F("create"))},{default:p(()=>e[14]||(e[14]=[i("Tambah Pemasukan")])),_:1}),t("div",se,[t("div",te,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",oe,[c(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>$.value=s),class:"block w-full border rounded-md p-2"},[(a(!0),d(b,null,y(l(j),s=>(a(),d("option",{key:s,value:s},u(s),9,le))),128))],512),[[C,$.value]])]),t("div",ae,[c(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"block w-full border rounded-md p-2"},[(a(),d(b,null,y(E,(s,_)=>t("option",{key:_,value:_+1},u(s),9,ne)),64))],512),[[C,U.value]])])]),t("div",de,[n(B,{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=s=>g.value=s),placeholder:"Cari Pemasukan...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",re,[t("table",ue,[t("thead",ie,[t("tr",null,[e[17]||(e[17]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"Sub Sumber",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(a(),d("th",me,"Aksi")):m("",!0)])]),t("tbody",null,[(a(!0),d(b,null,y(J.value,(s,_)=>{var A,h;return a(),d("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",pe,u(_+1),1),t("td",ce,u(s.date),1),t("td",fe,u(Y(s.amount)),1),t("td",_e,u(s.source.name),1),t("td",ve,u(((A=s.sub_source)==null?void 0:A.name)||"-"),1),t("td",be,u(s.payment),1),t("td",ye,u(((h=s.account_bank)==null?void 0:h.name)||"-"),1),f.value.btn_edit||f.value.btn_delete?(a(),d("td",ke,[f.value.btn_edit?(a(),D(N,{key:0,onClick:z=>F("edit",s)},{default:p(()=>e[24]||(e[24]=[i("Edit")])),_:2},1032,["onClick"])):m("",!0),f.value.btn_delete?(a(),D(P,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:z=>W(s.id)},{default:p(()=>e[25]||(e[25]=[i("Hapus")])),_:2},1032,["onClick"])):m("",!0)])):m("",!0)])}),128))])])]),n(X,{show:M.value,title:w.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:S},{content:p(()=>[t("form",{onSubmit:Q(O,["prevent"])},[t("div",xe,[n(k,{for:"date",value:"Tanggal"}),n(B,{id:"date",type:"date",modelValue:l(o).date,"onUpdate:modelValue":e[4]||(e[4]=s=>l(o).date=s),class:"block w-full"},null,8,["modelValue"]),n(x,{message:l(o).errors.date},null,8,["message"])]),t("div",ge,[n(k,{for:"amount",value:"Jumlah"}),n(B,{id:"amount",type:"number",modelValue:l(o).amount,"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).amount=s),class:"block w-full"},null,8,["modelValue"]),n(x,{message:l(o).errors.amount},null,8,["message"])]),t("div",we,[n(k,{for:"source_id",value:"Sumber"}),c(t("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=s=>l(o).source_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>l(o).sub_source_id=null)},[e[26]||(e[26]=t("option",{disabled:"",value:""},"Pilih Sumber",-1)),(a(!0),d(b,null,y(T.sources,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Ce,"(Tidak Aktif)"))],8,he))),128))],544),[[C,l(o).source_id]]),n(x,{message:l(o).errors.source_id},null,8,["message"])]),t("div",Ve,[n(k,{for:"sub_source_id",value:"Sub Sumber"}),c(t("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=s=>l(o).sub_source_id=s),class:"block w-full border rounded-md p-2",disabled:!l(o).source_id},[e[27]||(e[27]=t("option",{disabled:"",value:""},"Pilih Sub Sumber",-1)),(a(!0),d(b,null,y(R.value,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Te,"(Tidak Aktif)"))],8,Ae))),128))],8,Se),[[C,l(o).sub_source_id]]),n(x,{message:l(o).errors.sub_source_id},null,8,["message"])]),t("div",Me,[n(k,{for:"payment",value:"Pembayaran"}),t("div",$e,[t("label",Ue,[c(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>l(o).payment=s),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=s=>l(o).account_id="")},null,544),[[I,l(o).payment]]),e[28]||(e[28]=t("span",null,"Transfer",-1))]),t("label",De,[c(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>l(o).payment=s),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=s=>l(o).account_id=null)},null,544),[[I,l(o).payment]]),e[29]||(e[29]=t("span",null,"Tunai",-1))])]),n(x,{message:l(o).errors.payment},null,8,["message"])]),l(o).payment==="Transfer"?(a(),d("div",Pe,[n(k,{for:"account_id",value:"Rekening Tujuan"}),c(t("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=s=>l(o).account_id=s),class:"block w-full border rounded-md p-2"},[e[30]||(e[30]=t("option",{disabled:"",value:""},"Pilih Rekening",-1)),(a(!0),d(b,null,y(T.accountBanks,s=>(a(),d("option",{key:s.id,value:s.id,disabled:!s.is_active},[i(u(s.name)+" ",1),s.is_active?m("",!0):(a(),d("span",Fe,"(Tidak Aktif)"))],8,Be))),128))],512),[[C,l(o).account_id]]),n(x,{message:l(o).errors.account_id},null,8,["message"])])):m("",!0),t("div",Le,[n(N,{type:"button",onClick:S},{default:p(()=>e[31]||(e[31]=[i("Batal")])),_:1}),n(P,{class:"ml-3",type:"submit"},{default:p(()=>[i(u(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{ze as default};

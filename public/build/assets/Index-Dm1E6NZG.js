import{d as f,i as G,j as L,C as H,c as D,o as a,w as i,a as t,b as n,g as w,l as m,e as u,F as v,h as _,u as l,t as d,v as C,f as h,m as Q,p as I,W as q}from"./app-CJTkIsh8.js";import{A as K}from"./AppLayout-BTzH0TsC.js";import{_ as P}from"./PrimaryButton-CSG76sdM.js";import{_ as N}from"./SecondaryButton-BGgm2aAA.js";import{_ as b}from"./InputLabel-Bee8JMEO.js";import{_ as B}from"./TextInput-DGRGyfDU.js";import{_ as y}from"./InputError-CR3DMQms.js";import{_ as X}from"./CustomModal-C3D9uZAG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"p-4"},ee={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},se={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},te={class:"flex items-center space-x-4 w-full md:w-auto"},oe={class:"flex-1 md:flex-none"},le=["value"],ne={class:"flex-1 md:flex-none"},ae=["value"],re={class:"relative w-full md:w-64"},ue={class:"mt-4 overflow-x-auto"},de={class:"min-w-full border bg-white rounded-lg shadow-md"},ie={class:"bg-gray-200"},me={key:0,class:"px-4 py-2 text-center"},pe={class:"px-4 py-2"},ce={class:"px-4 py-2"},fe={class:"px-4 py-2"},ve={class:"px-4 py-2"},_e={class:"px-4 py-2"},be={class:"px-4 py-2"},ye={class:"px-4 py-2"},xe={key:0,class:"px-4 py-2 text-center"},ge={class:"mb-4"},ke={class:"mb-4"},we={class:"mb-4"},Ce=["value"],he={class:"mb-4"},Se=["disabled"],Ve=["value"],Ae={class:"mb-4"},Me={class:"flex space-x-4 mt-2"},$e={class:"flex items-center"},Te={class:"flex items-center"},Ue={key:0,class:"mb-4"},De=["value"],Pe={class:"flex justify-end mt-4"},Ye={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(M){const S=M,p=f(G().props.settings),x=f(""),$=f(!1),g=f(!1),j=Array.from({length:6},(r,e)=>2025+e),E=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],T=f(new Date().getFullYear()),U=f(new Date().getMonth()+1),J=L(()=>S.incomes.filter(r=>{var k;const e=new Date(r.date),s=e.getFullYear()===T.value,c=e.getMonth()+1===U.value,A=r.source.name.toLowerCase().includes(x.value.toLowerCase())||((k=r.sub_source)==null?void 0:k.name.toLowerCase().includes(x.value.toLowerCase()))||r.payment.toLowerCase().includes(x.value.toLowerCase());return s&&c&&A})),R=L(()=>S.subSources.filter(r=>r.source_id===o.source_id)),Y=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(r),o=H({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),F=(r,e=null)=>{g.value=r==="edit",g.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),$.value=!0},V=()=>{o.reset(),$.value=!1},O=()=>{g.value?o.put(route("income.update",o.id),{onSuccess:()=>V()}):o.post(route("income.store"),{onSuccess:()=>V()})},W=r=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&q.delete(route("income.destroy",r),{onSuccess:()=>{const e=S.incomes.findIndex(s=>s.id===r);e!==-1&&S.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(r,e)=>(a(),D(K,{title:"Income"},{default:i(()=>[t("div",Z,[t("div",ee,[n(P,{onClick:e[0]||(e[0]=s=>F("create"))},{default:i(()=>e[14]||(e[14]=[w("Tambah Pemasukan")])),_:1}),t("div",se,[t("div",te,[e[15]||(e[15]=t("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),t("div",oe,[m(t("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=s=>T.value=s),class:"block w-full border rounded-md p-2"},[(a(!0),u(v,null,_(l(j),s=>(a(),u("option",{key:s,value:s},d(s),9,le))),128))],512),[[C,T.value]])]),t("div",ne,[m(t("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=s=>U.value=s),class:"block w-full border rounded-md p-2"},[(a(),u(v,null,_(E,(s,c)=>t("option",{key:c,value:c+1},d(s),9,ae)),64))],512),[[C,U.value]])])]),t("div",re,[n(B,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=s=>x.value=s),placeholder:"Cari Pemasukan...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=t("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),t("div",ue,[t("table",de,[t("thead",ie,[t("tr",null,[e[17]||(e[17]=t("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=t("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=t("th",{class:"px-4 py-2 text-left"},"Jumlah",-1)),e[20]||(e[20]=t("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=t("th",{class:"px-4 py-2 text-left"},"Sub Sumber",-1)),e[22]||(e[22]=t("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=t("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),p.value.btn_edit||p.value.btn_delete?(a(),u("th",me,"Aksi")):h("",!0)])]),t("tbody",null,[(a(!0),u(v,null,_(J.value,(s,c)=>{var A,k;return a(),u("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[t("td",pe,d(c+1),1),t("td",ce,d(s.date),1),t("td",fe,d(Y(s.amount)),1),t("td",ve,d(s.source.name),1),t("td",_e,d(((A=s.sub_source)==null?void 0:A.name)||"-"),1),t("td",be,d(s.payment),1),t("td",ye,d(((k=s.account_bank)==null?void 0:k.name)||"-"),1),p.value.btn_edit||p.value.btn_delete?(a(),u("td",xe,[p.value.btn_edit?(a(),D(N,{key:0,onClick:z=>F("edit",s)},{default:i(()=>e[24]||(e[24]=[w("Edit")])),_:2},1032,["onClick"])):h("",!0),p.value.btn_delete?(a(),D(P,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:z=>W(s.id)},{default:i(()=>e[25]||(e[25]=[w("Hapus")])),_:2},1032,["onClick"])):h("",!0)])):h("",!0)])}),128))])])]),n(X,{show:$.value,title:g.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:V},{content:i(()=>[t("form",{onSubmit:Q(O,["prevent"])},[t("div",ge,[n(b,{for:"date",value:"Tanggal"}),n(B,{id:"date",type:"date",modelValue:l(o).date,"onUpdate:modelValue":e[4]||(e[4]=s=>l(o).date=s),class:"block w-full"},null,8,["modelValue"]),n(y,{message:l(o).errors.date},null,8,["message"])]),t("div",ke,[n(b,{for:"amount",value:"Jumlah"}),n(B,{id:"amount",type:"number",modelValue:l(o).amount,"onUpdate:modelValue":e[5]||(e[5]=s=>l(o).amount=s),class:"block w-full"},null,8,["modelValue"]),n(y,{message:l(o).errors.amount},null,8,["message"])]),t("div",we,[n(b,{for:"source_id",value:"Sumber"}),m(t("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=s=>l(o).source_id=s),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=s=>l(o).sub_source_id=null)},[e[26]||(e[26]=t("option",{value:""},"Pilih Sumber",-1)),(a(!0),u(v,null,_(M.sources,s=>(a(),u("option",{key:s.id,value:s.id},d(s.name),9,Ce))),128))],544),[[C,l(o).source_id]]),n(y,{message:l(o).errors.source_id},null,8,["message"])]),t("div",he,[n(b,{for:"sub_source_id",value:"Sub Sumber"}),m(t("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=s=>l(o).sub_source_id=s),class:"block w-full border rounded-md p-2",disabled:!l(o).source_id},[e[27]||(e[27]=t("option",{value:""},"Pilih Sub Sumber",-1)),(a(!0),u(v,null,_(R.value,s=>(a(),u("option",{key:s.id,value:s.id},d(s.name),9,Ve))),128))],8,Se),[[C,l(o).sub_source_id]]),n(y,{message:l(o).errors.sub_source_id},null,8,["message"])]),t("div",Ae,[n(b,{for:"payment",value:"Pembayaran"}),t("div",Me,[t("label",$e,[m(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>l(o).payment=s),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=s=>l(o).account_id="")},null,544),[[I,l(o).payment]]),e[28]||(e[28]=t("span",null,"Transfer",-1))]),t("label",Te,[m(t("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=s=>l(o).payment=s),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=s=>l(o).account_id=null)},null,544),[[I,l(o).payment]]),e[29]||(e[29]=t("span",null,"Tunai",-1))])]),n(y,{message:l(o).errors.payment},null,8,["message"])]),l(o).payment==="Transfer"?(a(),u("div",Ue,[n(b,{for:"account_id",value:"Rekening Tujuan"}),m(t("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=s=>l(o).account_id=s),class:"block w-full border rounded-md p-2"},[e[30]||(e[30]=t("option",{value:""},"Pilih Rekening",-1)),(a(!0),u(v,null,_(M.accountBanks,s=>(a(),u("option",{key:s.id,value:s.id},d(s.name),9,De))),128))],512),[[C,l(o).account_id]]),n(y,{message:l(o).errors.account_id},null,8,["message"])])):h("",!0),t("div",Pe,[n(N,{type:"button",onClick:V},{default:i(()=>e[31]||(e[31]=[w("Batal")])),_:1}),n(P,{class:"ml-3",type:"submit"},{default:i(()=>[w(d(g.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{Ye as default};

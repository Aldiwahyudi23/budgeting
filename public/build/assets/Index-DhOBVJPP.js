import{d as V,k as c,C as J,c as R,o,w as u,a as t,b as i,e as m,f as A,t as d,F as D,h as S,g as l,n as O,q as W,u as r,p as q,v as z,W as j}from"./app-BAijexpd.js";import{A as G}from"./AppLayout-DlFxLZi-.js";import{_ as Q}from"./CustomModal-BjGm5vFm.js";import{_ as w}from"./PrimaryButton-DOrKTp0i.js";import{_ as X}from"./SecondaryButton-DkTZSIKd.js";import{_ as f}from"./InputLabel-Bgs03EzX.js";import{_ as v}from"./TextInput-CaApGyw9.js";import{_ as b}from"./InputError-m3pCSlzm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"p-4"},Z={class:"container mx-auto p-2"},tt={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center bg-white p-4 rounded-lg shadow-md mb-2"},at={key:0,class:"mt-2 sm:mt-0"},et={key:0,class:"mt-4"},st={class:"bg-white p-4 rounded-lg shadow-md"},nt=["onClick"],lt={class:"text-gray-800"},it={class:"text-purple-600 font-semibold"},ot={key:1,class:"text-center bg-white p-6 rounded-lg shadow-md mt-4"},ut={key:2},rt={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mt-4"},mt={class:"flex items-center justify-between"},dt={class:"text-lg font-semibold"},pt={class:"text-sm text-gray-500"},ct={class:"text-xl font-bold text-purple-600"},gt={class:"text-sm text-gray-500"},ft={class:"mt-4 flex justify-between items-center"},bt=["href"],kt={key:1,class:"text-center bg-white p-2 rounded-lg shadow-md mt-4"},vt={class:"mb-4"},xt={class:"mb-4"},_t={class:"mb-4"},yt={class:"mb-4"},ht={class:"mb-4"},jt={class:"flex justify-end mt-4"},Mt={__name:"Index",props:{loans:Array,categories:Array,user:Object,debts:Array},setup(I){const p=I,x=V(!1),k=V(!1),M=c(()=>p.categories.some(s=>{const a=s.name.trim().toLowerCase(),e="Loan (Pinjaman)".toLowerCase();return a===e&&s.user_id===p.user.id})),P=c(()=>p.loans.filter(s=>s.status==="active")),N=c(()=>p.loans.filter(s=>s.status!=="active")),C=c(()=>p.loans.filter(s=>s.status==="paid")),$=()=>{k.value=!k.value},n=J({id:null,name:"",amount:"",paid_amount:"",status:"active",note:""}),g=s=>s?new Intl.NumberFormat("id-ID").format(s):"",L=s=>s?s.replace(/\./g,""):"",_=c({get:()=>g(n.amount),set:s=>{n.amount=L(s)}}),y=c({get:()=>g(n.paid_amount),set:s=>{n.paid_amount=L(s)}}),B=(s,a=null)=>{a?(n.id=a.id,n.name=a.name,n.amount=a.amount,n.paid_amount=a.paid_amount,n.status=a.status,n.note=a.note):n.reset(),x.value=!0},h=()=>{n.reset(),x.value=!1},K=()=>{n.put(route("loans.update",n.id),{onSuccess:()=>h()})},T=s=>{_.value=s.target.value},H=s=>{y.value=s.target.value},U=()=>{const s={name:"Loan (Pinjaman)",is_active:!0,user_id:p.user.id},a={name:"Loan (Pinjaman)",is_active:!0,user_id:p.user.id};Promise.all([j.post(route("category.store"),s),j.post(route("source.store"),a)]).then(()=>{window.location.reload()}).catch(e=>{console.error("Gagal menyimpan data:",e)})},E=s=>{j.visit(route("history_pembayaran_loan",{id:s}))};return(s,a)=>(o(),R(G,{title:"Kelola Pinjaman"},{default:u(()=>[t("div",Y,[t("div",Z,[t("div",tt,[a[5]||(a[5]=t("div",null,[t("h1",{class:"text-xl font-semibold text-gray-800"},"Kelola Pinjaman"),t("p",{class:"text-sm text-gray-600 mt-1"}," Halaman ini digunakan untuk mengelola data pinjaman. ")],-1)),N.value.length>0?(o(),m("div",at,[t("a",{onClick:$,class:"text-sm text-blue-500 hover:text-blue-700 cursor-pointer"},d(k.value?"Sembunyikan Hutang Selesai":"Lihat Hutang Selesai"),1)])):A("",!0)]),k.value&&C.value.length>0?(o(),m("div",et,[a[6]||(a[6]=t("h2",{class:"text-lg font-semibold mb-4"},"Hutang yang Sudah Dibayar",-1)),t("div",st,[(o(!0),m(D,null,S(C.value,e=>(o(),m("div",{key:e.id,class:"flex justify-between items-center py-2 border-b last:border-b-0 cursor-pointer hover:bg-gray-50",onClick:F=>E(e.id)},[t("span",lt,d(e.name||"Tanpa Kategori"),1),t("span",it,"Rp "+d(g(e.paid_amount)),1)],8,nt))),128))])])):A("",!0),M.value?(o(),m("div",ut,[P.value.length>0?(o(),m("div",rt,[(o(!0),m(D,null,S(P.value,e=>(o(),m("div",{key:e.id,class:"bg-white p-6 rounded-lg shadow-md"},[t("div",mt,[t("h2",dt,d(e.name),1),t("span",{class:O(["px-2 py-1 text-xs font-semibold rounded-lg",e.status==="active"?"bg-green-100 text-green-600":e.status==="paid"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"])},d(e.status==="active"?"Aktif":e.status==="paid"?"Lunas":"Terlambat"),3)]),t("p",pt,d(e.note||"-"),1),t("p",ct,"Rp "+d(g(e.amount)),1),t("p",gt,"Jumlah Dibayar: Rp "+d(g(e.paid_amount)),1),t("div",ft,[i(w,{onClick:F=>B("edit",e)},{default:u(()=>a[9]||(a[9]=[l("Edit")])),_:2},1032,["onClick"]),t("a",{href:s.route("history_pembayaran_loan",{id:e.id}),class:"text-sm text-blue-500 hover:text-blue-700 underline"}," Lihat Detail ",8,bt)])]))),128))])):(o(),m("div",kt,a[10]||(a[10]=[t("p",{class:"text-gray-500 text-sm"},"Belum ada data pinjaman aktif yang tercatat.",-1)])))])):(o(),m("div",ot,[a[8]||(a[8]=t("p",{class:"text-gray-500 text-sm mb-4"},' Kategori "Loan (Pinjaman)" belum diaktifkan. Silakan aktifkan terlebih dahulu. ',-1)),i(w,{onClick:U},{default:u(()=>a[7]||(a[7]=[l("Aktifkan Kategori Loan")])),_:1})])),a[11]||(a[11]=t("div",{class:"mt-4 bg-gray-100 p-2 rounded-lg shadow-md"},[t("h2",{class:"text-lg font-semibold text-gray-800"},"Informasi Mengenai Pinjaman"),t("p",{class:"text-sm text-gray-600 mt-2"}," Halaman ini digunakan untuk mengelola data pinjaman, baik pinjaman aktif maupun yang sudah lunas. Berikut cara menambahkan dan mengelola pinjaman: "),t("ul",{class:"text-sm text-gray-600 mt-2 list-disc list-inside"},[t("li",null,[t("strong",null,"Aktifkan Kategori Pinjaman"),l(": "),t("ul",{class:"list-circle list-inside ml-4"},[t("li",null,'Jika kategori "Loan (Pinjaman)" belum aktif, klik tombol "Aktifkan Kategori Loan" di atas.')])]),t("li",null,[t("strong",null,"Menambahkan Pinjaman"),l(": "),t("ul",{class:"list-circle list-inside ml-4"},[t("li",null,[l("Pinjaman dapat ditambahkan melalui halaman "),t("strong",null,"Transaksi Pengeluaran (Expenses)"),l(".")]),t("li",null,[l("Pilih kategori "),t("strong",null,"Loan (Pinjaman)"),l(".")]),t("li",null,"Masukkan nama peminjam dan nominal pinjaman.")])]),t("li",null,[t("strong",null,"Pembayaran Pinjaman"),l(": "),t("ul",{class:"list-circle list-inside ml-4"},[t("li",null,[l("Pembayaran dilakukan melalui halaman "),t("strong",null,"Transaksi Pemasukan (Income)"),l(".")]),t("li",null,[l("Pilih sumber "),t("strong",null,"Pinjaman"),l(" dan pilih nama peminjam.")]),t("li",null,"Masukkan nominal pembayaran.")])]),t("li",null,[t("strong",null,"Status Pinjaman"),l(": "),t("ul",{class:"list-circle list-inside ml-4"},[t("li",null,[l("Pinjaman dengan status "),t("strong",null,"Aktif"),l(" akan ditampilkan di halaman ini.")]),t("li",null,'Pinjaman yang sudah lunas atau tidak aktif dapat dilihat di bawah dengan mengklik "Lihat Hutang Selesai".')])])]),t("p",{class:"text-sm text-gray-600 mt-2"}," Pastikan untuk selalu memperbarui data pinjaman setelah melakukan transaksi pembayaran agar status pinjaman tetap akurat. ")],-1))]),i(Q,{show:x.value,title:"Edit Pinjaman",onClose:h},{content:u(()=>[t("form",{onSubmit:W(K,["prevent"])},[t("div",vt,[i(f,{for:"name"},{default:u(()=>a[12]||(a[12]=[l(" Nama Pinjaman "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(v,{id:"name",modelValue:r(n).name,"onUpdate:modelValue":a[0]||(a[0]=e=>r(n).name=e),class:"block w-full",disabled:""},null,8,["modelValue"]),i(b,{message:r(n).errors.name},null,8,["message"])]),t("div",xt,[i(f,{for:"amount"},{default:u(()=>a[13]||(a[13]=[l(" Jumlah Pinjaman "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(v,{id:"amount",type:"text",modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=e=>_.value=e),onInput:T,class:"block w-full",disabled:""},null,8,["modelValue"]),i(b,{message:r(n).errors.amount},null,8,["message"])]),t("div",_t,[i(f,{for:"paid_amount"},{default:u(()=>a[14]||(a[14]=[l(" Jumlah Dibayar "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),i(v,{id:"paid_amount",type:"text",modelValue:y.value,"onUpdate:modelValue":a[2]||(a[2]=e=>y.value=e),onInput:H,class:"block w-full",disabled:""},null,8,["modelValue"]),i(b,{message:r(n).errors.paid_amount},null,8,["message"])]),t("div",yt,[i(f,{for:"status"},{default:u(()=>a[15]||(a[15]=[l(" Status "),t("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),q(t("select",{id:"status","onUpdate:modelValue":a[3]||(a[3]=e=>r(n).status=e),class:"block w-full border rounded-md p-2",disabled:""},a[16]||(a[16]=[t("option",{value:"active"},"Aktif",-1),t("option",{value:"paid"},"Lunas",-1),t("option",{value:"overdue"},"Terlambat",-1)]),512),[[z,r(n).status]]),i(b,{message:r(n).errors.status},null,8,["message"])]),t("div",ht,[i(f,{for:"note"},{default:u(()=>a[17]||(a[17]=[l(" Catatan ")])),_:1}),i(v,{id:"note",modelValue:r(n).note,"onUpdate:modelValue":a[4]||(a[4]=e=>r(n).note=e),class:"block w-full"},null,8,["modelValue"]),i(b,{message:r(n).errors.note},null,8,["message"])]),t("div",jt,[i(X,{type:"button",onClick:h},{default:u(()=>a[18]||(a[18]=[l("Batal")])),_:1}),i(w,{class:"ml-3",type:"submit"},{default:u(()=>a[19]||(a[19]=[l("Update")])),_:1})])],32)]),_:1},8,["show"])])]),_:1}))}};export{Mt as default};

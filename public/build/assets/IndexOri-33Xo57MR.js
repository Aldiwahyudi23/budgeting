import{d as c,i as E,j as Z,k as N,C as ee,l as te,c as B,o as n,w as i,a as s,b as r,g as u,p as f,e as d,F as y,h as x,t as m,v as h,f as p,q as se,u as a,s as j,W as Y}from"./app-BxfbunnZ.js";import{A as oe}from"./AppLayout-DpRDBFlr.js";import{_ as I}from"./PrimaryButton-CQkfZ5GO.js";import{_ as R}from"./SecondaryButton-Dsn9ADTW.js";import{_ as g}from"./InputLabel-B-ZwsLUo.js";import{_ as L}from"./TextInput-iVLTWtm3.js";import{_ as k}from"./InputError-D7DrSLhS.js";import{_ as le}from"./CustomModal-BPz3j0z2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ae={class:"p-4"},ne={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},re={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},de={class:"flex items-center space-x-4 w-full md:w-auto"},ue={class:"flex-1 md:flex-none"},ie=["value"],me={class:"flex-1 md:flex-none"},pe=["value"],ce={class:"relative w-full md:w-64"},fe={class:"mt-4 overflow-x-auto"},ve={class:"min-w-full border bg-white rounded-lg shadow-md"},_e={class:"bg-gray-200"},be={key:0,class:"px-4 py-2 text-center"},ye={class:"px-4 py-2"},xe={class:"px-4 py-2"},ge={class:"px-4 py-2"},ke={class:"px-4 py-2"},we={class:"px-4 py-2"},Ce={class:"px-4 py-2"},Ve={class:"px-4 py-2"},Ae={key:0,class:"px-4 py-2 text-center"},he={class:"mb-4"},Se={class:"mb-4"},Te={class:"mb-4"},Me=["value","disabled"],$e={key:0},Ue={class:"mb-4"},De=["disabled"],Fe=["value","disabled"],Ne={key:0},Be={class:"mb-4"},Ie={class:"flex space-x-4 mt-2"},Le={class:"flex items-center"},Pe={class:"flex items-center"},Ee={key:0,class:"mb-4"},je=["value","disabled"],Ye={key:0},Re={class:"flex justify-end mt-4"},Xe={__name:"IndexOri",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup($){const S=$,v=c(E().props.settings),_=c(""),U=c(!1),w=c(!1);E();const J=c(Array.from({length:10},(l,e)=>new Date().getFullYear()-e)),K=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],C=c(new Date().getFullYear()),V=c(new Date().getMonth()+1),O=()=>{const l={year:C.value,month:V.value};Y.get(route("income.index"),l,{preserveState:!0,replace:!0})};Z([C,V],()=>{O()});const q=N(()=>S.incomes.filter(l=>{var A;const e=new Date(l.date),t=e.getFullYear()===C.value,b=e.getMonth()+1===V.value,M=_.value?l.source.name.toLowerCase().includes(_.value.toLowerCase())||((A=l.sub_source)==null?void 0:A.name.toLowerCase().includes(_.value.toLowerCase()))||l.payment.toLowerCase().includes(_.value.toLowerCase()):!0;return t&&b&&M})),o=ee({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null}),W=N(()=>S.subSources.filter(l=>l.source_id===o.source_id)),D=l=>l?new Intl.NumberFormat("id-ID").format(l):"",z=l=>l?l.replace(/\./g,""):"",F=N({get:()=>D(o.amount),set:l=>{o.amount=z(l)}}),G=l=>{const e=l.target.value.replace(/\./g,"");o.amount=e};te(()=>{F.value=D(o.amount)});const P=(l,e=null)=>{w.value=l==="edit",w.value&&e?(o.id=e.id,o.date=e.date,o.amount=e.amount,o.source_id=e.source_id,o.sub_source_id=e.sub_source_id,o.payment=e.payment,o.account_id=e.account_id):o.reset(),U.value=!0},T=()=>{o.reset(),U.value=!1},H=()=>{w.value?o.put(route("income.update",o.id),{onSuccess:()=>T()}):o.post(route("income.store"),{onSuccess:()=>T()})},Q=l=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&Y.delete(route("income.destroy",l),{onSuccess:()=>{const e=S.incomes.findIndex(t=>t.id===l);e!==-1&&S.incomes.splice(e,1)},onError:e=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return(l,e)=>(n(),B(oe,{title:"Income"},{default:i(()=>[s("div",ae,[s("div",ne,[r(I,{onClick:e[0]||(e[0]=t=>P("create"))},{default:i(()=>e[14]||(e[14]=[u("Tambah Pemasukan")])),_:1}),s("div",re,[s("div",de,[e[15]||(e[15]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",ue,[f(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),d(y,null,x(J.value,t=>(n(),d("option",{key:t,value:t},m(t),9,ie))),128))],512),[[h,C.value]])]),s("div",me,[f(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>V.value=t),class:"block w-full border rounded-md p-2"},[(n(),d(y,null,x(K,(t,b)=>s("option",{key:b,value:b+1},m(t),9,pe)),64))],512),[[h,V.value]])])]),s("div",ce,[r(L,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[16]||(e[16]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",fe,[s("table",ve,[s("thead",_e,[s("tr",null,[e[17]||(e[17]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[18]||(e[18]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),v.value.btn_edit||v.value.btn_delete?(n(),d("th",be,"Aksi")):p("",!0)])]),s("tbody",null,[(n(!0),d(y,null,x(q.value,(t,b)=>{var M,A;return n(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",ye,m(b+1),1),s("td",xe,m(t.date),1),s("td",ge,m(D(t.amount)),1),s("td",ke,m(t.source.name),1),s("td",we,m(((M=t.sub_source)==null?void 0:M.name)||"-"),1),s("td",Ce,m(t.payment),1),s("td",Ve,m(((A=t.account_bank)==null?void 0:A.name)||"-"),1),v.value.btn_edit||v.value.btn_delete?(n(),d("td",Ae,[v.value.btn_edit?(n(),B(R,{key:0,onClick:X=>P("edit",t)},{default:i(()=>e[24]||(e[24]=[u("Edit")])),_:2},1032,["onClick"])):p("",!0),v.value.btn_delete?(n(),B(I,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:X=>Q(t.id)},{default:i(()=>e[25]||(e[25]=[u("Hapus")])),_:2},1032,["onClick"])):p("",!0)])):p("",!0)])}),128))])])]),r(le,{show:U.value,title:w.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:T},{content:i(()=>[s("form",{onSubmit:se(H,["prevent"])},[s("div",he,[r(g,{for:"date"},{default:i(()=>e[26]||(e[26]=[u(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(L,{id:"date",type:"date",modelValue:a(o).date,"onUpdate:modelValue":e[4]||(e[4]=t=>a(o).date=t),class:"block w-full"},null,8,["modelValue"]),r(k,{message:a(o).errors.date},null,8,["message"])]),s("div",Se,[r(g,{for:"amount"},{default:i(()=>e[27]||(e[27]=[u(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(L,{id:"amount",type:"text",modelValue:F.value,"onUpdate:modelValue":e[5]||(e[5]=t=>F.value=t),onInput:G,class:"block w-full"},null,8,["modelValue"]),r(k,{message:a(o).errors.amount},null,8,["message"])]),s("div",Te,[r(g,{for:"source_id"},{default:i(()=>e[28]||(e[28]=[u(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"source_id","onUpdate:modelValue":e[6]||(e[6]=t=>a(o).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[7]||(e[7]=t=>a(o).sub_source_id=null)},[e[29]||(e[29]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),d(y,null,x($.sources,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",$e,"(Tidak Aktif)"))],8,Me))),128))],544),[[h,a(o).source_id]]),r(k,{message:a(o).errors.source_id},null,8,["message"])]),s("div",Ue,[r(g,{for:"sub_source_id"},{default:i(()=>e[30]||(e[30]=[u(" Keterangan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"sub_source_id","onUpdate:modelValue":e[8]||(e[8]=t=>a(o).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!a(o).source_id},[e[31]||(e[31]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),d(y,null,x(W.value,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",Ne,"(Tidak Aktif)"))],8,Fe))),128))],8,De),[[h,a(o).sub_source_id]]),r(k,{message:a(o).errors.sub_source_id},null,8,["message"])]),s("div",Be,[r(g,{for:"payment"},{default:i(()=>e[32]||(e[32]=[u(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",Ie,[s("label",Le,[f(s("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=t=>a(o).payment=t),value:"Transfer",class:"mr-2",onChange:e[10]||(e[10]=t=>a(o).account_id="")},null,544),[[j,a(o).payment]]),e[33]||(e[33]=s("span",null,"Transfer",-1))]),s("label",Pe,[f(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>a(o).payment=t),value:"Tunai",class:"mr-2",onChange:e[12]||(e[12]=t=>a(o).account_id=null)},null,544),[[j,a(o).payment]]),e[34]||(e[34]=s("span",null,"Tunai",-1))])]),r(k,{message:a(o).errors.payment},null,8,["message"])]),a(o).payment==="Transfer"?(n(),d("div",Ee,[r(g,{for:"account_id"},{default:i(()=>e[35]||(e[35]=[u(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),f(s("select",{id:"account_id","onUpdate:modelValue":e[13]||(e[13]=t=>a(o).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[36]||(e[36]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),d(y,null,x($.accountBanks,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[u(m(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",Ye,"(Tidak Aktif)"))],8,je))),128))],512),[[h,a(o).account_id]]),r(k,{message:a(o).errors.account_id},null,8,["message"])])):p("",!0),s("div",Re,[r(R,{type:"button",onClick:T},{default:i(()=>e[37]||(e[37]=[u("Batal")])),_:1}),r(I,{class:"ml-3",type:"submit"},{default:i(()=>[u(m(w.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}};export{Xe as default};

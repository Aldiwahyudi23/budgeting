import{i as K,d as c,j as le,k,C as ne,l as de,m as re,c as E,o as n,w as m,a as s,e as d,f as p,b as r,t as u,g as i,p as b,F as w,h,v as C,q as ue,u as l,s as H,W as O}from"./app-B7i476IW.js";import{A as ie}from"./AppLayout-DYxnbsM3.js";import{_ as Y}from"./PrimaryButton-Pht67KKk.js";import{_ as W}from"./SecondaryButton-BVjf0Ddl.js";import{_ as g}from"./InputLabel-DrC7EUNk.js";import{_ as U}from"./TextInput-eH0qOyXf.js";import{_}from"./InputError-BAp61ugy.js";import{_ as me}from"./CustomModal-CDZNf8BD.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"p-4"},fe={key:0,class:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4"},ve={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"},be={class:"flex flex-col md:flex-row justify-between items-center mb-4 space-y-4 md:space-y-0"},ge={class:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 w-full md:w-auto"},_e={class:"flex items-center space-x-4 w-full md:w-auto"},ye={class:"flex-1 md:flex-none"},xe=["value"],ke={class:"flex-1 md:flex-none"},we=["value"],he={class:"relative w-full md:w-64"},Ce={class:"mt-4 overflow-x-auto bg-white rounded-lg shadow-md"},Ve={class:"min-w-full"},Se={class:"bg-gray-200"},Ae={key:0,class:"px-4 py-2 text-center"},Te={class:"px-4 py-2"},Me={class:"px-4 py-2"},Pe={class:"px-4 py-2"},$e={class:"px-4 py-2"},Ie={class:"px-4 py-2"},Ue={class:"px-4 py-2"},De={class:"px-4 py-2"},Ne={class:"px-4 py-2"},Be={key:0,class:"px-4 py-2 text-center"},Fe={class:"flex flex-col md:flex-row justify-between items-center mt-4 space-y-4 md:space-y-0"},je={class:"flex items-center space-x-4"},Le={class:"text-sm text-gray-700"},Ee={class:"flex items-center space-x-4"},Ye=["disabled"],Re={class:"text-sm text-gray-700"},qe=["disabled"],Je={key:0,class:"mb-4"},Ke={class:"mb-4"},He={class:"mb-4"},Oe=["value","disabled"],We={key:0},ze={class:"mb-4"},Ge=["disabled"],Qe=["value","disabled"],Xe={key:0},Ze={class:"mb-4"},es={key:1,class:"mb-4 p-3 bg-blue-50 rounded-md"},ss={key:2},ts={class:"mb-4"},as={class:"flex space-x-4 mt-2"},os={class:"flex items-center"},ls={class:"flex items-center"},ns={key:0,class:"mb-4"},ds=["value","disabled"],rs={key:0},us={class:"flex justify-end mt-4"},is={__name:"Index",props:{incomes:Array,sources:Array,subSources:Array,accountBanks:Array},setup(D){const V=D;K();const y=c(""),N=c(!1),S=c(!1),f=c(K().props.settings),z=c(Array.from({length:10},(o,e)=>new Date().getFullYear()-e)),G=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],A=c(new Date().getFullYear()),T=c(new Date().getMonth()+1),v=c(1),M=c(10),Q=()=>{const o={year:A.value,month:T.value};O.get(route("income.index"),o,{preserveState:!0,replace:!0})};le([A,T],()=>{Q()});const B=k(()=>V.incomes.filter(o=>{var P;const e=new Date(o.date),t=e.getFullYear()===A.value,x=e.getMonth()+1===T.value,I=y.value?o.source.name.toLowerCase().includes(y.value.toLowerCase())||((P=o.sub_source)==null?void 0:P.name.toLowerCase().includes(y.value.toLowerCase()))||o.payment.toLowerCase().includes(y.value.toLowerCase()):!0;return t&&x&&I})),R=k(()=>{const o=V.sources.find(e=>e.id===a.source_id);return o&&o.name==="Saving (Tabungan)"}),q=k(()=>{const o=(v.value-1)*M.value,e=o+M.value;return B.value.slice(o,e)}),F=k(()=>Math.ceil(B.value.length/M.value)),X=()=>{v.value<F.value&&v.value++},Z=()=>{v.value>1&&v.value--},a=ne({id:"",date:"",amount:"",source_id:"",sub_source_id:null,payment:"",account_id:null,description:null}),ee=k(()=>V.subSources.filter(o=>o.source_id===a.source_id)),j=o=>o?new Intl.NumberFormat("id-ID").format(o):"",se=o=>o?o.replace(/\./g,""):"",L=k({get:()=>j(a.amount),set:o=>{a.amount=se(o)}});de(()=>{L.value=j(a.amount)});const J=(o,e=null)=>{S.value=o==="edit",S.value&&e?(a.id=e.id,a.date=e.date,a.amount=e.amount,a.source_id=e.source_id,a.sub_source_id=e.sub_source_id,a.payment=e.payment,a.account_id=e.account_id,a.description=e.description):a.reset(),N.value=!0},$=()=>{a.reset(),N.value=!1},te=()=>{R.value&&(a.payment="Transfer"),S.value?a.put(route("income.update",a.id),{onSuccess:()=>$()}):a.post(route("income.store"),{onSuccess:()=>$()})},ae=o=>{confirm("Apakah Anda yakin ingin menghapus pemasukan ini?")&&O.delete(route("income.destroy",o),{onSuccess:()=>{const e=V.incomes.findIndex(t=>t.id===o);e!==-1&&V.incomes.splice(e,1)},onError:()=>{alert("Gagal menghapus pemasukan. Silakan coba lagi.")}})};return re(()=>{f.value.saving_expense&&console.log(savingSubCategories.value)}),(o,e)=>(n(),E(ie,{title:"Income"},{default:m(()=>[s("div",ce,[o.$page.props.flash.success?(n(),d("div",fe,u(o.$page.props.flash.success),1)):p("",!0),o.$page.props.flash.error?(n(),d("div",ve,u(o.$page.props.flash.error),1)):p("",!0),e[44]||(e[44]=s("div",{class:"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded mb-4"},[s("p",{class:"text-sm"}," Ini adalah halaman untuk melakukan semua transaksi pemasukan, termasuk kategori pemasukan seperti gaji, bonus, dan lainnya. ")],-1)),s("div",be,[r(Y,{onClick:e[0]||(e[0]=t=>J("create"))},{default:m(()=>e[16]||(e[16]=[i("Tambah Pemasukan")])),_:1}),s("div",ge,[s("div",_e,[e[17]||(e[17]=s("span",{class:"text-sm font-medium text-gray-700"},"Filter:",-1)),s("div",ye,[b(s("select",{id:"year","onUpdate:modelValue":e[1]||(e[1]=t=>A.value=t),class:"block w-full border rounded-md p-2"},[(n(!0),d(w,null,h(z.value,t=>(n(),d("option",{key:t,value:t},u(t),9,xe))),128))],512),[[C,A.value]])]),s("div",ke,[b(s("select",{id:"month","onUpdate:modelValue":e[2]||(e[2]=t=>T.value=t),class:"block w-full border rounded-md p-2"},[(n(),d(w,null,h(G,(t,x)=>s("option",{key:x,value:x+1},u(t),9,we)),64))],512),[[C,T.value]])])]),s("div",he,[r(U,{modelValue:y.value,"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),placeholder:"Cari...",class:"pl-10 pr-4 py-2 border rounded-md w-full"},null,8,["modelValue"]),e[18]||(e[18]=s("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-4.35-4.35m0 0A8.5 8.5 0 1010.5 19a8.5 8.5 0 006.15-2.85z"})],-1))])])]),s("div",Ce,[s("table",Ve,[s("thead",Se,[s("tr",null,[e[19]||(e[19]=s("th",{class:"px-4 py-2 text-left"},"No",-1)),e[20]||(e[20]=s("th",{class:"px-4 py-2 text-left"},"Tanggal",-1)),e[21]||(e[21]=s("th",{class:"px-4 py-2 text-left"},"Nominal",-1)),e[22]||(e[22]=s("th",{class:"px-4 py-2 text-left"},"Sumber",-1)),e[23]||(e[23]=s("th",{class:"px-4 py-2 text-left"},"Poin",-1)),e[24]||(e[24]=s("th",{class:"px-4 py-2 text-left"},"Keterangan",-1)),e[25]||(e[25]=s("th",{class:"px-4 py-2 text-left"},"Pembayaran",-1)),e[26]||(e[26]=s("th",{class:"px-4 py-2 text-left"},"Rekening",-1)),f.value.btn_edit||f.value.btn_delete?(n(),d("th",Ae,"Aksi")):p("",!0)])]),s("tbody",null,[(n(!0),d(w,null,h(q.value,(t,x)=>{var I,P;return n(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[s("td",Te,u(x+1),1),s("td",Me,u(t.date),1),s("td",Pe,u(j(t.amount)),1),s("td",$e,u(t.source.name),1),s("td",Ie,u(((I=t.sub_source)==null?void 0:I.name)||"-"),1),s("td",Ue,u(t.description||"-"),1),s("td",De,u(t.payment),1),s("td",Ne,u(((P=t.account_bank)==null?void 0:P.name)||"Tunai"),1),f.value.btn_edit||f.value.btn_delete?(n(),d("td",Be,[f.value.btn_edit?(n(),E(W,{key:0,onClick:oe=>J("edit",t)},{default:m(()=>e[27]||(e[27]=[i("Edit")])),_:2},1032,["onClick"])):p("",!0),f.value.btn_delete?(n(),E(Y,{key:1,class:"ml-2 bg-red-600 hover:bg-red-700",onClick:oe=>ae(t.id)},{default:m(()=>e[28]||(e[28]=[i("Hapus")])),_:2},1032,["onClick"])):p("",!0)])):p("",!0)])}),128))])])]),s("div",Fe,[s("div",je,[s("span",Le,"Menampilkan "+u(q.value.length)+" dari "+u(B.value.length)+" data",1),b(s("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>M.value=t),class:"border rounded-md p-2 text-sm"},e[29]||(e[29]=[s("option",{value:"10"},"10",-1),s("option",{value:"25"},"25",-1),s("option",{value:"50"},"50",-1),s("option",{value:"100"},"100",-1)]),512),[[C,M.value]])]),s("div",Ee,[s("button",{onClick:Z,disabled:v.value===1,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Sebelumnya ",8,Ye),s("span",Re,"Halaman "+u(v.value)+" dari "+u(F.value),1),s("button",{onClick:X,disabled:v.value===F.value,class:"px-4 py-2 bg-gray-200 rounded-md hover:bg-gray-300 text-sm"}," Selanjutnya ",8,qe)])]),r(me,{show:N.value,title:S.value?"Edit Pemasukan":"Tambah Pemasukan",onClose:$},{content:m(()=>[s("form",{onSubmit:ue(te,["prevent"])},[f.value.date_in?(n(),d("div",Je,[r(g,{for:"date"},{default:m(()=>e[30]||(e[30]=[i(" Tanggal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(U,{id:"date",type:"date",modelValue:l(a).date,"onUpdate:modelValue":e[5]||(e[5]=t=>l(a).date=t),class:"block w-full",required:""},null,8,["modelValue"]),r(_,{message:l(a).errors.date},null,8,["message"])])):p("",!0),s("div",Ke,[r(g,{for:"amount"},{default:m(()=>e[31]||(e[31]=[i(" Nominal "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),r(U,{id:"amount",type:"text",modelValue:L.value,"onUpdate:modelValue":e[6]||(e[6]=t=>L.value=t),onInput:o.handleAmountInput,class:"block w-full"},null,8,["modelValue","onInput"]),r(_,{message:l(a).errors.amount},null,8,["message"])]),s("div",He,[r(g,{for:"source_id"},{default:m(()=>e[32]||(e[32]=[i(" Sumber "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"source_id","onUpdate:modelValue":e[7]||(e[7]=t=>l(a).source_id=t),class:"block w-full border rounded-md p-2",onChange:e[8]||(e[8]=t=>l(a).sub_source_id=null)},[e[33]||(e[33]=s("option",{disabled:"",value:""},"Pilih Sumber",-1)),(n(!0),d(w,null,h(D.sources,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",We,"(Tidak Aktif)"))],8,Oe))),128))],544),[[C,l(a).source_id]]),r(_,{message:l(a).errors.source_id},null,8,["message"])]),s("div",ze,[r(g,{for:"sub_source_id"},{default:m(()=>e[34]||(e[34]=[i(" Poin "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"sub_source_id","onUpdate:modelValue":e[9]||(e[9]=t=>l(a).sub_source_id=t),class:"block w-full border rounded-md p-2",disabled:!l(a).source_id},[e[35]||(e[35]=s("option",{disabled:"",value:""},"Pilih Keterangan",-1)),(n(!0),d(w,null,h(ee.value,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",Xe,"(Tidak Aktif)"))],8,Qe))),128))],8,Ge),[[C,l(a).sub_source_id]]),r(_,{message:l(a).errors.sub_source_id},null,8,["message"])]),s("div",Ze,[r(g,{for:"description"},{default:m(()=>e[36]||(e[36]=[i(" Keterangan ")])),_:1}),r(U,{id:"description",type:"text",modelValue:l(a).description,"onUpdate:modelValue":e[10]||(e[10]=t=>l(a).description=t),class:"block w-full"},null,8,["modelValue"]),r(_,{message:l(a).errors.description},null,8,["message"])]),R.value?(n(),d("div",es,e[37]||(e[37]=[s("p",{class:"text-sm text-blue-800"},[s("i",{class:"fas fa-info-circle mr-1"}),i(" Nabung secara langsung: uang akan langsung tercatat di Account Bank sesuai pengaturan. ")],-1)]))):(n(),d("div",ss,[s("div",ts,[r(g,{for:"payment"},{default:m(()=>e[38]||(e[38]=[i(" Pembayaran "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),s("div",as,[s("label",os,[b(s("input",{type:"radio","onUpdate:modelValue":e[11]||(e[11]=t=>l(a).payment=t),value:"Transfer",class:"mr-2",onChange:e[12]||(e[12]=t=>l(a).account_id="")},null,544),[[H,l(a).payment]]),e[39]||(e[39]=s("span",null,"Transfer",-1))]),s("label",ls,[b(s("input",{type:"radio","onUpdate:modelValue":e[13]||(e[13]=t=>l(a).payment=t),value:"Tunai",class:"mr-2",onChange:e[14]||(e[14]=t=>l(a).account_id=null)},null,544),[[H,l(a).payment]]),e[40]||(e[40]=s("span",null,"Tunai",-1))])]),r(_,{message:l(a).errors.payment},null,8,["message"])]),l(a).payment==="Transfer"?(n(),d("div",ns,[r(g,{for:"account_id"},{default:m(()=>e[41]||(e[41]=[i(" Rekening Tujuan "),s("span",{class:"text-red-500 text-sm"},"*",-1)])),_:1}),b(s("select",{id:"account_id","onUpdate:modelValue":e[15]||(e[15]=t=>l(a).account_id=t),class:"block w-full border rounded-md p-2",required:""},[e[42]||(e[42]=s("option",{disabled:"",value:""},"Pilih Rekening",-1)),(n(!0),d(w,null,h(D.accountBanks,t=>(n(),d("option",{key:t.id,value:t.id,disabled:!t.is_active},[i(u(t.name)+" ",1),t.is_active?p("",!0):(n(),d("span",rs,"(Tidak Aktif)"))],8,ds))),128))],512),[[C,l(a).account_id]]),r(_,{message:l(a).errors.account_id},null,8,["message"])])):p("",!0)])),s("div",us,[r(W,{type:"button",onClick:$},{default:m(()=>e[43]||(e[43]=[i("Batal")])),_:1}),r(Y,{class:"ml-3",type:"submit"},{default:m(()=>[i(u(S.value?"Update":"Simpan"),1)]),_:1})])],32)]),_:1},8,["show","title"])])]),_:1}))}},xs=pe(is,[["__scopeId","data-v-729fdb30"]]);export{xs as default};
